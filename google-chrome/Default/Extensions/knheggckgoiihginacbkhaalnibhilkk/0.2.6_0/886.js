"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[886],{32310:(e,t,s)=>{s.d(t,{Z:()=>x});var i=s(67154),o=s.n(i),n=s(98135),r=s.n(n),a=s(59713),l=s.n(a),d=(s(33948),s(67294)),p=s.n(d),c=s(5366),u=s(3779),h=s(46167),m=s(48762),g=s(66832),S=s(95009),v=s(25584),y=s(47966),b=s(83071),f=s(23189),w=s(46951),M=s(35822),Z=s(48209);const P=["system","light","dark"],C=(0,c.vU)({systemLabel:{id:"appearanceSetting.system.label",defaultMessage:"Use system setting"},lightLabel:{id:"appearanceSetting.light.label",defaultMessage:"Light"},darkLabel:{id:"appearanceSetting.dark.label",defaultMessage:"Dark"}});class k extends g.Z{constructor(...e){super(...e),l()(this,"storeTypes",{appearanceStore:Z.Z}),l()(this,"handleChangeAppearance",(e=>{(0,M.rz)(this.environment,e),this.stores.appearanceStore.setState({appearanceSetting:e})}))}componentDidMount(){const e=(0,M.MH)(this.environment);this.stores.appearanceStore.setState({appearanceSetting:e})}renderComponent(){return r()("div",{},void 0,this.renderHeader(),r()("div",{style:this.getSettingsOptionStyle()},void 0,r()(w.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,r()(c._H,{id:"appearanceSettings.description.message",defaultMessage:"Customize how Notion looks on your device."})),this.renderAppearanceButton()))}renderHeader(){const{device:e}=this.environment;return r()(f.Z,{large:!e.isMobile||void 0,divider:e.isMobile?void 0:"full"},void 0,r()(c._H,{id:"appearanceSettings.title",defaultMessage:"Appearance"}))}renderAppearanceButton(){const{device:e}=this.environment;return r()(h.Z,{popupType:e.isMobile?h.Z.PopupType.SlideUp:h.Z.PopupType.Popup,placementToOrigin:h.Z.Placement.Right,renderOrigin:e=>p().createElement(y.Z,o()({},e,{isLarge:!0,style:{marginTop:12,marginBottom:4}}),k.getAppearanceLabel(this.stores.appearanceStore.state.appearanceSetting),u.Z.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor})),render:t=>{let s;s=e.isMobile?{menuType:S.ZP.MenuType.Modal,title:r()(c._H,{defaultMessage:"Appearance",id:"appearanceSettings.modal.title"}),right:r()(c._H,{defaultMessage:"Done",id:"appearanceSettings.modal.done"}),onClickRight:t.close}:{menuType:S.ZP.MenuType.Popup,width:250};const i=P.map((e=>({key:e,action:s=>{this.handleChangeAppearance(e),t.close()},render:(t,s)=>p().createElement(m.Z,o()({},t,{title:k.getAppearanceLabel(e)}))})));return p().createElement(S.ZP,s,r()(v.Z,{type:v.Z.Type.Vertical,sections:[{key:"appearance section",render:e=>p().createElement(b.Z,e),items:i}],initialFocus:void 0}))}})}static getAppearanceLabel(e){switch(e){case"light":return p().createElement(c._H,C.lightLabel);case"dark":return p().createElement(c._H,C.darkLabel);case"system":return p().createElement(c._H,C.systemLabel)}}getSettingsOptionStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto",paddingLeft:e.isMobile?t.state.paddingLeftCSS:0,paddingRight:e.isMobile?t.state.paddingRightCSS:0}}}const x=k},79092:(e,t,s)=>{s.d(t,{Z:()=>c});var i=s(98135),o=s.n(i),n=(s(67294),s(5366)),r=s(66832),a=s(23189),l=s(47714),d=s(46951);class p extends r.Z{renderComponent(){const{device:e}=this.environment;return o()("div",{style:this.getSettingsOptionStyle()},void 0,o()(a.Z,{},void 0,o()(n._H,{id:"calendarSettings.startWeekOnMonday.label",defaultMessage:"Start week on Monday"})),o()("div",{onClick:this.props.onClick,style:{display:"flex",alignItems:"flex-start",marginBottom:12,cursor:"pointer",width:"100%"}},void 0,o()("div",{style:{flex:1}},void 0,o()(d.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"}},void 0,o()(n._H,{id:"calendarSettings.startWeekOnMonday.message",defaultMessage:"This will change how all calendars in your app look."}))),o()("div",{style:{marginTop:5}},void 0,o()(l.Z,{on:1===this.props.startDayOfWeek,isAndroid:e.isAndroid}))))}getSettingsOptionStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto",paddingLeft:e.isMobile?t.state.paddingLeftCSS:0,paddingRight:e.isMobile?t.state.paddingRightCSS:0}}}const c=p},79603:(e,t,s)=>{s.d(t,{mS:()=>_,Ub:()=>E,Pp:()=>R});var i=s(67154),o=s.n(i),n=s(98135),r=s.n(n),a=(s(33948),s(67294)),l=s.n(a),d=s(89940),p=s(97148),c=s(25584),u=s(83071),h=s(46167),m=s(58879),g=s(3779),S=s(64215),v=s(95009),y=s(5366),b=s(48762),f=s(40235),w=s(23189),M=s(46951),Z=s(62727),P=s(47966),C=s(27386),k=s(69972),x=s(68932),T=s(96486),I=s.n(T),B=s(95477);const L="janus";function _(e){return"on"===p.Z.getGroup(e,L)||"local"===B.Z.env}function E(e){const t=(0,m.O7)(),[s,i]=(0,a.useState)(""),[n,C]=(0,a.useState)(void 0),k=(0,d.VK)((()=>p.Z.getExperiments().filter((e=>e.experimentId!==L&&(!s||0===s.length||e.experimentId.includes(s)))).sort(((e,t)=>e.experimentId>t.experimentId?1:-1))),[s]),{device:T}=t,B=T.isMobile,_=(0,S.y)((e=>({containerStyle:{width:"100%"},headerContainerStyle:{display:"flex",alignItems:"flex-start",cursor:"pointer",width:"100%",flexWrap:"wrap"},headerLabelStyle:{marginTop:2,marginBottom:12,padding:2,flex:1},filterContainerStyle:{paddingBottom:"12px"},resetButtonContainerStyle:{paddingBottom:"12px"},tableExperimentIDHeaderStyle:{width:"auto"},tableExperimentGroupHeaderStyle:{width:"auto",textAlign:"right"},experimentGroupContainerStyle:{width:"100%",display:"flex",justifyContent:"flex-end"},experimentGroupButtonStyle:{maxWidth:B?"100px":void 0,overflowX:"hidden",justifyContent:"left"},experimentGroupButtonChevronStyle:{width:10,marginLeft:4,fill:e.lightIconColor},experimentGroupButtonCheckContainerStyle:{width:B?16:14}})),[B]);return r()("div",{style:_.containerStyle},void 0,r()(w.Z,{large:!T.isMobile||void 0},void 0,"Experiment Overrides"),r()("div",{style:_.headerContainerStyle},void 0,r()(M.Z,{isSmall:!0,isMultiline:!0,style:_.headerLabelStyle},void 0,"Turn on (or off) experiments for yourself (this will not apply to anyone else)"),r()("div",{style:_.resetButtonContainerStyle},void 0,r()(P.Z,{isSmall:!0,onClick:()=>{C({reset:!0}),p.Z.resetExperimentOverrides(t).then((()=>{C(void 0)}))}},void 0,null!=n&&n.reset?r()(x.Z,{}):"Reset to defaults"))),r()("div",{style:_.filterContainerStyle},void 0,r()(Z.Z,{placeholder:"Filter by Experiment ID...",value:s,showClearButton:!0,autoCapitalize:"off",autoComplete:"off",onChange:e=>{i(e.target.value)}})),r()(f.Z,{columns:[{key:"name",header:"Experiment ID",style:_.tableExperimentIDHeaderStyle},{key:"group",header:"Group",style:_.tableExperimentGroupHeaderStyle}],rows:k.map((e=>{const s=e.group;return{key:e.experimentId,columns:[e.experimentId,r()("div",{style:_.experimentGroupContainerStyle},void 0,r()(h.Z,{popupType:T.isMobile?h.Z.PopupType.SlideUp:h.Z.PopupType.Popup,renderOrigin:t=>l().createElement(P.Z,o()({},t,{key:e.experimentId,style:_.experimentGroupButtonStyle}),null!=s?s:"unknown",g.Z.chevronDown(_.experimentGroupButtonChevronStyle)),render:i=>{let a;a=T.isMobile?{menuType:v.ZP.MenuType.Modal,title:e.experimentId,right:r()(y._H,{defaultMessage:"Done",id:"appearanceSettings.modal.done"}),onClickRight:i.close}:{menuType:v.ZP.MenuType.Popup,width:250};const d=e.groups.map((a=>({key:a,action:s=>{C({experimentId:e.experimentId,group:a}),p.Z.setExperimentOverride(t,e,a).then((()=>{C(void 0),I().delay((()=>{i.close()}),1e3)}))},render:(t,i)=>l().createElement(b.Z,o()({},t,{title:a,right:n&&n.experimentId===e.experimentId&&n.group===a?r()("div",{style:_.experimentGroupButtonCheckContainerStyle},void 0,r()(x.Z,{})):a!==s||n?void 0:r()("div",{style:_.experimentGroupButtonCheckContainerStyle},void 0,g.Z.check())}))})));return l().createElement(v.ZP,a,r()(c.Z,{type:c.Z.Type.Vertical,initialFocus:void 0,sections:[{key:e.experimentId,render:e=>l().createElement(u.Z,e),items:d}]}))}}))]}}))}))}function R(e){const t=(0,S.y)((e=>({headerLabelStyle:{marginTop:2,width:"80%"},outlineButtonStyle:{marginTop:12,marginBottom:4}})),[]);return r()("div",{},void 0,r()(w.Z,{},void 0,"Experiments"),r()(M.Z,{isSmall:!0,isMultiline:!0,style:t.headerLabelStyle},void 0,"Locally turn on (or off) experiments"),r()(h.Z,{popupType:h.Z.PopupType.SlideUp,renderOrigin:e=>l().createElement(P.Z,o()({},e,{isLarge:!0,style:t.outlineButtonStyle}),"View Experiments"),render:e=>{const t={menuType:v.ZP.MenuType.Modal,whiteBackground:!0,title:"Experiments",right:r()(y._H,{defaultMessage:"Done",id:"appearanceSettings.modal.done"}),onClickRight:e.close};return r()(k.Z,{capture:!0,allowEsc:!0,render:()=>l().createElement(v.ZP,t,r()(C.Z,{disableScroller:!0},void 0,r()(E,{})))})}}))}},74523:(e,t,s)=>{s.d(t,{Z:()=>c});var i=s(98135),o=s.n(i),n=(s(67294),s(66832)),r=s(86512),a=s(3779),l=s(50906),d=s(42001);class p extends n.Z{renderComponent(){return o()(r.Z,{style:{display:"flex",marginLeft:-6},className:"notion-print-ignore",href:this.props.href,external:!0,onClick:()=>l.Fsx(this.environment,{from:this.props.analyticsFrom})},void 0,o()(d.Z,{icon:a.Z.help,isSmall:!0,isLightGray:!0,shouldShrink:this.props.shouldShrink},void 0,this.props.title))}}const c=p},64131:(e,t,s)=>{s.d(t,{Z:()=>G});var i=s(98135),o=s.n(i),n=s(67154),r=s.n(n),a=s(59713),l=s.n(a),d=(s(33948),s(67294)),p=s.n(d),c=s(46167),u=s(66832),h=s(37235),m=s(98742),g=s(50906),S=s(14947),v=s(24666),y=s(3779),b=s(25584),f=s(95009),w=s(83071),M=s(98724),Z=s(8848),P=s(41216),C=s(82990),k=s(52689),x=s(52377),T=s(63334),I=s(70203),B=s(94610),L=s(89086),_=s(5366),E=s(15282);const R=p().Fragment;class H extends u.Z{constructor(...e){super(...e),l()(this,"storeTypes",{ignoreSelectionAreaStore:T.Z}),l()(this,"renderHighlightColorMenuItem",((e,t,s,i)=>({key:t||e,action:()=>{s(),this.menuItemAction(e),i.close()},render:s=>p().createElement(P.Z,r()({},s,{color:e,overrideDisplayName:t}))}))),l()(this,"handleToggleHighlightAnnotation",(()=>{M.a({environment:this.environment,annotation:["h",k.Z.state.color]}),g.mt_(this.environment,{action:"h",color:k.Z.state.color})})),l()(this,"handleButtonPopupClick",(e=>{g.mt_(this.environment,{action:"h"})})),l()(this,"handleClose",(()=>{v.Z.emit()})),l()(this,"menuItemAction",(e=>{M.m({environment:this.environment,annotationType:"h"}),"default"!==e&&(k.Z.setHighlightColor(e),this.handleToggleHighlightAnnotation())}))}renderComponent(){const{device:e}=this.environment,{intl:t}=this.props;return o()(c.Z,{popupType:e.isMobile?c.Z.PopupType.SlideUp:c.Z.PopupType.Popup,originGap:4,onClose:this.handleClose,onClick:this.handleButtonPopupClick,renderOrigin:t=>o()(h.Z,{renderTooltip:()=>o()(R,{},void 0,o()("div",{},void 0,o()(_._H,{defaultMessage:"Text color",id:"highlightSelectionButton.textColor.tooltip"})),o()("div",{},void 0,o()(B.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleHighlight"}))),render:s=>p().createElement(S.Z,r()({style:{display:"flex",alignItems:"center",paddingLeft:7,paddingRight:6,whiteSpace:"nowrap",...this.props.style},disabled:this.props.disabled,disabledFeedback:this.props.disabled},(0,m.Z)(t,s)),o()("div",{style:this.getColorIconStyle()},void 0,e.isMobile?o()(_._H,{defaultMessage:"Color",id:"highlightSelectionButton.mobileColorIcon.label"}):"A"),y.Z.chevronDown({width:10,marginLeft:e.isMobile?4:3,fill:"dark"===this.theme.mode?Z.ZP.white:this.theme.lightIconColor}))}),render:s=>{let i;return i=e.isMobile?{menuType:f.ZP.MenuType.Modal,title:o()(_._H,{defaultMessage:"Text color",id:"highlightSelectionButton.mobileTextColor.label"}),right:o()(E.CancelMenuText,{}),onClickRight:()=>{s.close()}}:{menuType:f.ZP.MenuType.Popup},p().createElement(f.ZP,i,o()(x.Z,{capture:e.isMobile,store:this.stores.ignoreSelectionAreaStore,ignoreBlockSelection:!1,restoreSelection:!0,focusOffscreenInput:!1,render:e=>{const i=Z.CY.map((t=>this.renderHighlightColorMenuItem(t,void 0,e,s))),n=[this.renderHighlightColorMenuItem("default",t.formatMessage({defaultMessage:"Default background",id:"highlightSelectionButton.defaultBackground.label"}),e,s),...Z._K.map((t=>this.renderHighlightColorMenuItem(t,void 0,e,s)))],a=k.Z.state.color;return o()(b.Z,{type:b.Z.Type.Vertical,sections:[{key:0,items:[{key:0,action:()=>{e(),this.menuItemAction(a),s.close()},render:e=>p().createElement(P.Z,r()({},e,{color:a,shortcuts:["toggleHighlight"]}))}],render:e=>p().createElement(w.Z,r()({},e,{title:o()(_._H,{defaultMessage:"Last used",id:"highlightSelectionButton.lastUsedSection.label"}),isTitleUppercase:!0}))},{key:1,items:i,render:e=>p().createElement(w.Z,r()({},e,{title:o()(_._H,{defaultMessage:"Color",id:"highlightSelectionButton.colorSection.label"}),isTitleUppercase:!0}))},{key:2,items:n,render:e=>p().createElement(w.Z,r()({},e,{title:o()(_._H,{defaultMessage:"Background",id:"highlightSelectionButton.backgroundSection.label"}),isTitleUppercase:!0}))}],initialFocus:void 0})}}))}})}getTextSelectionColor(){const e=(0,L.Ld)("h");return e?I.zI(e):"default"}getColorIconStyle(){const{device:e}=this.environment;return{display:"inline-flex",alignItems:"center",justifyContent:"center",height:18,textAlign:"center",fontSize:15,borderRadius:2,...!e.isMobile&&{width:18,fontWeight:C.Z.fontWeight.medium,marginBottom:2},...(0,Z.A_)(this.getTextSelectionColor(),this.theme)}}}const G=(0,_.XN)(H)},82945:(e,t,s)=>{s.d(t,{Z:()=>M});var i=s(67154),o=s.n(i),n=s(98135),r=s.n(n),a=s(59713),l=s.n(a),d=(s(33948),s(67294)),p=s.n(d),c=s(7476),u=s(66832),h=s(37235),m=s(94610),g=s(3779),S=s(50906),v=s(24666),y=s(14947),b=s(5366),f=s(68056);class w extends u.Z{constructor(...e){super(...e),l()(this,"handleClick",(e=>{const t=v.Z.state;if("editing"===t.mode){const e=(0,f.QY)(t.multiSelection);if(!e)return;const s=e.store;c.WD({environment:this.environment,textStore:s,blockStore:this.props.blockStore,selection:e.selection})}S.mt_(this.environment,{action:"comment"})}))}renderComponent(){const{device:e}=this.environment,t=e.isMobile;return r()(h.Z,{renderTooltip:()=>r()(d.Fragment,{},void 0,r()("div",{},void 0,r()(b._H,{defaultMessage:"Comment on selected text",id:"inlineCommentButton.tooltip"})),r()("div",{},void 0,r()(m.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"comment"}))),render:e=>p().createElement(y.Z,o()({style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",...this.props.style},disabled:this.props.disabled,disabledFeedback:this.props.disabled,onClick:this.handleClick},e),g.Z.speechBubbleThin({width:t?18:16,height:t?18:16,marginTop:t?0:1,marginRight:4}),!t&&r()(b._H,{defaultMessage:"Comment",id:"inlineCommentButton.commentLabel"}))})}}const M=w},39849:(e,t,s)=>{s.d(t,{Z:()=>u});var i,o=s(98135),n=s.n(o),r=s(59713),a=s.n(r),l=(s(67294),s(66832)),d=s(82990),p=s(8848);!function(e){e[e.Red=0]="Red",e[e.Gray=1]="Gray"}(i||(i={}));class c extends l.Z{renderComponent(){const{count:e}=this.props,t=this.props.color===i.Red;if(e&&!(e<=0))return n()("div",{style:{...c.style,...this.props.style,...e>99&&{width:void 0,padding:2},background:t?p.ZP.red:this.theme.lightIconColor}},void 0,this.renderNumber())}renderNumber(){const{count:e}=this.props;if(e)return 1===e?n()("span",{style:{marginBottom:1,marginLeft:-.5,letterSpacing:void 0,...this.props.numberStyle}},void 0,"1"):e>99?n()("span",{style:{marginBottom:1,letterSpacing:-.5,...this.props.numberStyle}},void 0,"99+"):n()("span",e>9?{style:{marginBottom:1,letterSpacing:-.5,marginLeft:-.5,...this.props.numberStyle}}:{style:{marginBottom:1,...this.props.numberStyle}},void 0,e)}}a()(c,"Color",i),a()(c,"style",{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:16,height:16,fontSize:10,textAlign:"center",fontWeight:d.Z.fontWeight.semibold,borderRadius:3,color:p.ZP.white,position:"static",marginLeft:6,WebkitFontSmoothing:"auto"});const u=c},376:(e,t,s)=>{s.d(t,{Z:()=>f});var i=s(98135),o=s.n(i),n=s(67294),r=s.n(n),a=s(66832),l=s(29368),d=s(47714),p=s(9953),c=s(8646),u=s(50906),h=s(27832),m=s(74523),g=s(46951),S=s(5366),v=s(57623),y=s(23189);class b extends a.Z{renderComponent(){const{device:e}=this.environment,{intl:t}=this.props;return o()("div",{},void 0,this.renderNotificationHeader(),o()("div",{style:this.getSettingsOptionStyle(),className:"notifications-settings"},void 0,this.renderSettingsOption(t.formatMessage({id:"notificationSettings.mobilePushNotificationSettings.title",defaultMessage:"Mobile push notifications"}),t.formatMessage({id:"notificationSettings.mobilePushNotificationSettings.description",defaultMessage:"Receive push notifications on mentions and comments via your mobile app."}),"notify_mobile"),e.isElectron&&o()(n.Fragment,{},void 0,o()(l.Z,{size:24}),this.renderSettingsOption(t.formatMessage({id:"notificationSettings.desktopNotificationSettings.title",defaultMessage:"Desktop push notifications"}),t.formatMessage({id:"notificationSettings.desktopNotificationSettings.description",defaultMessage:"Receive push notifications on mentions and comments immediately via your desktop app."}),"notify_desktop")),o()(l.Z,{size:24}),this.renderSettingsOption(t.formatMessage({id:"notificationSettings.emailNotificationSettings.title",defaultMessage:"Email notifications"}),t.formatMessage({id:"notificationSettings.emailNotificationSettings.description",defaultMessage:"Receive email updates on mentions, comments, and edit digests for all the pages you have followed."}),"notify_email"),this.getSwitchValue("notify_email")&&o()(r().Fragment,{},void 0,o()(l.Z,{size:24}),this.renderSettingsOption(t.formatMessage({id:"notificationSettings.emailAlwaysNotificationSettings.title",defaultMessage:"Always send email notifications"}),t.formatMessage({id:"notificationSettings.emailAlwaysNotificationSettings.description",defaultMessage:"Receive updates by email, even when you’re active on the app."}),"notify_email_always")),o()(l.Z,{size:24}),o()("div",{style:{marginTop:4}},void 0,o()(m.Z,{title:t.formatMessage({id:"notificationSettings.helpButton.caption",defaultMessage:"Learn about mobile and desktop notifications"}),href:(0,v.U)("guides.notificationSettings"),analyticsFrom:"notifications_settings"}))))}renderNotificationHeader(){const{device:e}=this.environment;return o()(y.Z,{large:!e.isMobile||void 0,divider:"full"},void 0,o()(S._H,{id:"notificationSettings.notificationSection.title",defaultMessage:"Notifications"}))}renderSettingsOption(e,t,s){const{device:i}=this.environment,n=this.getSwitchValue(s);return o()("div",{onClick:()=>{this.handleToggle(s),"notify_mobile"===s?u.lyF(this.environment,{is_on:!n}):"notify_desktop"===s?u.ZL0(this.environment,{is_on:!n}):("notify_email"===s||"notify_email_always"===s)&&u.b0T(this.environment,{is_on:!n})},style:{display:"flex",width:"100%",alignItems:"center",cursor:"pointer"}},void 0,o()("div",{style:{flex:1}},void 0,o()("div",{style:{fontSize:14}},void 0,e),o()(g.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%",marginTop:4}},void 0,t)),o()(d.Z,{on:Boolean(n),disabled:void 0===n,isAndroid:i.isAndroid}))}getSwitchValue(e){const{currentSpaceViewStore:t}=h.Z.state;if(t){const s=t.getValue();if(s)return s[e]}}handleToggle(e){const{currentSpaceViewStore:t}=h.Z.state;if(t){const s=t.getValue();if(s){const i=s[e];c.H5(this.environment,(s=>{p.sW({store:t,data:{[e]:!i},transaction:s})}))}}}getSettingsOptionStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto",paddingLeft:e.isMobile?t.state.paddingLeftCSS:0,paddingRight:e.isMobile?t.state.paddingRightCSS:0}}}const f=(0,S.XN)(b)},38043:(e,t,s)=>{s.d(t,{Z:()=>_});var i=s(98135),o=s.n(i),n=s(59713),r=s.n(n),a=(s(33948),s(67294)),l=s(5366),d=s(7765),p=s(66832),c=s(12318),u=s(27832),h=s(69503),m=s(32935),g=s(47307),S=s(43250),v=s(15102),y=s(62727),b=s(47966),f=s(72693),w=s(13490),M=s(8848),Z=s(46951),P=s(33058),C=s(69972),k=s(96486),x=s.n(k);function T(e){return e.match(/\d/)}var I=s(23189),B=s(33954);class L extends p.Z{constructor(...e){super(...e),r()(this,"storeTypes",{hasPasswordStore:c.Z.of(!1),emailStore:c.Z.of("")}),r()(this,"handleChangePasswordClick",(()=>{h.Z.setState({open:!0,setNewPassword:!0,password:"",repeatPassword:""})})),r()(this,"handleOldPasswordChange",(e=>{(h.Z.isSetNewPasswordModal()||h.Z.isRemovePasswordModal())&&h.Z.setState({...h.Z.state,oldPassword:e.target.value,alert:void 0})})),r()(this,"handleClearOldPassword",(()=>{(h.Z.isSetNewPasswordModal()||h.Z.isRemovePasswordModal())&&h.Z.setState({...h.Z.state,oldPassword:"",alert:void 0})})),r()(this,"handlePasswordChange",(e=>{h.Z.isSetNewPasswordModal()&&h.Z.setState({...h.Z.state,password:e.target.value,alert:void 0})})),r()(this,"handleCancelChangePassword",(()=>{const{onCancel:e}=h.Z.state;h.Z.reset(),e&&e()})),r()(this,"handleClearPassword",(()=>{h.Z.isSetNewPasswordModal()&&h.Z.setState({...h.Z.state,password:"",repeatPassword:"",alert:void 0})})),r()(this,"handleRepeatPasswordChange",(e=>{h.Z.isSetNewPasswordModal()&&h.Z.setState({...h.Z.state,repeatPassword:e.target.value,alert:void 0})})),r()(this,"handleClearRepeatPassword",(()=>{h.Z.isSetNewPasswordModal()&&h.Z.setState({...h.Z.state,repeatPassword:"",alert:void 0})})),r()(this,"handlePasswordBlur",(()=>{if(h.Z.isSetNewPasswordModal()){const{password:e,repeatPassword:t}=h.Z.state;e&&t&&e!==t&&h.Z.setState({...h.Z.state,alert:this.props.intl.formatMessage({id:"passwordSettings.changePasswordModal.newPasswordMismatchError",defaultMessage:"Your new password does not match."})})}})),r()(this,"handleSubmit",(async()=>{if(!h.Z.isSetNewPasswordModal())return;const{oldPassword:e,password:t,repeatPassword:s}=h.Z.state,i=this.stores.hasPasswordStore.get(),{intl:o}=this.props;let n;if(i&&!e)n=o.formatMessage({id:"passwordSettings.changePasswordModal.oldPasswordMissingError",defaultMessage:"Please enter your old password."});else if(t){const e=function(e){return x().uniq(e).length<=3?{success:!1,reason:{type:"password_too_consistent"}}:e.length>=15?{success:!0}:e.length<10?{success:!1,reason:{type:"password_too_short"}}:function(e){return e.match(/[a-z]/i)}(e)?T(e)?{success:!0}:{success:!1,reason:{type:"password_missing_number"}}:T(e)?{success:!1,reason:{type:"password_missing_letter"}}:{success:!1,reason:{type:"password_missing_letter_and_number"}}}(t);e.success?s?t!==s&&(n=o.formatMessage({id:"passwordSettings.changePasswordModal.newPasswordsMismatchError",defaultMessage:"Your passwords do not match."})):n=o.formatMessage({id:"passwordSettings.changePasswordModal.newPasswordNotRepeatedError",defaultMessage:"Please repeat your new password."}):n=this.getPasswordErrorMessage(e.reason)}else n=o.formatMessage({id:"passwordSettings.changePasswordModal.passwordNotEnteredError",defaultMessage:"Please enter a password."});if(n)return void h.Z.setState({...h.Z.state,alert:n});const r=await m.FY6(this.environment,{oldPassword:e,newPassword:t});if("success"===r.type)this.props.requestStore.refresh(),void 0===e?this.saveNewPasswordSuccess():this.changePasswordSuccess();else{const e=(0,B.wf)(this.props.intl,r);h.Z.setState({...h.Z.state,alert:e})}})),r()(this,"handleShowRemovePasswordModalClick",(()=>{h.Z.setState({open:!0,removePassword:!0,oldPassword:""})})),r()(this,"handleRemovePasswordClick",(async()=>{if(!h.Z.isRemovePasswordModal())return;const{oldPassword:e}=h.Z.state;if(!e)return void h.Z.setState({...h.Z.state,alert:this.props.intl.formatMessage({id:"passwordSettings.removePasswordModal.oldPasswordNotEnteredError",defaultMessage:"Please enter your current password.",description:"We require users to enter their password in a text box before they can delete it. This error message appears if the user attempts to delete their password but hasn't entered it into the text box."})});const t=await m.FY6(this.environment,{oldPassword:e,clearPassword:!0});if("success"===t.type)this.props.requestStore.refresh(),this.removePasswordSuccess();else{const e=(0,B.wf)(this.props.intl,t);h.Z.setState({...h.Z.state,alert:e||this.props.intl.formatMessage({id:"passwordSettings.removePasswordModal.message",defaultMessage:"Error removing password. Please try again later."})})}})),r()(this,"defaultErrorMessage",this.props.intl.formatMessage({id:"passwordSettings.genericPasswordSaveError",defaultMessage:"Error saving password. Please try again later."}))}willMount(e){super.willMount(e);const{currentUserStore:t}=u.Z.state;if(t){const e=t.getValue();e&&this.stores.emailStore.set(e.email)}}renderComponent(){const e=this.stores.emailStore.get();if(!e)return;const{requestStore:t}=this.props;return o()("div",{style:this.getSettingsOptionStyle()},void 0,o()(I.Z,{smallMarginBottom:!0},void 0,o()(l._H,{id:"passwordSettings.title",defaultMessage:"Password"})),o()(d.Z,{request:{},requestStore:t,performRequest:async()=>{const t=await m.JRL(this.environment,{email:e,allowAdminBypass:!0});if("success"===t.type){const{samlRedirect:e,hasPassword:s}=t.data;return{samlEnforced:e&&e.enforced,hasPassword:s}}throw t.error},render:(e,t)=>{if(e)return L.renderLabel(o()(l._H,{id:"passwordSettings.passwordSetError.message",defaultMessage:"Your password cannot be set at this time. Please try again later."}));if(t){const{samlEnforced:e,hasPassword:s}=t;return e?L.renderLabel(o()(l._H,{id:"passwordSettings.passwordManagedThroughSAMLProvider.message",defaultMessage:"Your password is managed through your SAML Single Sign-on Provider.",description:"Message letting users know that their password is managed through a 3rd-party provider, which is why they can't set their password on Notion's password settings page."})):(this.stores.hasPasswordStore.set(Boolean(s)),this.renderPasswordActions())}}}))}renderPasswordActions(){const{isEducationPlan:e}=this.props,t=this.stores.hasPasswordStore.get();return o()(a.Fragment,{},void 0,L.renderLabel(o()(l._H,{id:"passwordSettings.passwordSetInstructions",defaultMessage:"You can set a permanent password if you don't want to use temporary login codes."})),e&&L.renderLabel(this.renderEducationPlanInfo()),o()("div",{style:{display:"flex",alignItems:"center"}},void 0,o()(b.Z,{isLarge:!0,onClick:this.handleChangePasswordClick,style:{marginTop:12,marginBottom:4}},void 0,o()(l._H,t?{id:"passwordSettings.changePasswordButton.label",defaultMessage:"Change password"}:{id:"passwordSettings.setPasswordButton.label",defaultMessage:"Set a password"})),this.canRemovePassword()&&o()(P.Z,{onClick:this.handleShowRemovePasswordModalClick,style:{marginLeft:5,marginTop:12,marginBottom:4}},void 0,o()(l._H,{id:"passwordSettings.removePasswordButton.label",defaultMessage:"Remove password"}))),this.renderPasswordModal())}static renderLabel(e){return o()(Z.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,e)}renderPasswordModal(){const{device:e}=this.environment,{open:t}=h.Z.state;return o()(v.Z,{open:t,onDismiss:this.handleCancelChangePassword,innerStyle:{width:e.isPhone?"90%":460,minHeight:270,padding:24},className:S.BK,preventHideChildrenWhileOpening:!0,render:()=>o()(C.Z,{capture:!0,allowEsc:!0,render:()=>o()(a.Fragment,{},void 0,this.renderSaveNewPassword(),this.renderRemovePassword())})})}renderSaveNewPassword(){const{isEducationPlan:e}=this.props;if(!h.Z.isSetNewPasswordModal())return;const{password:t,repeatPassword:s,oldPassword:i,alert:n}=h.Z.state,r=this.stores.hasPasswordStore.get(),d=this.stores.emailStore.get();return o()(a.Fragment,{},void 0,o()(y.Z,{style:{display:"none"},type:"text",value:d,autoComplete:"username",disabled:!0}),r&&o()(a.Fragment,{},void 0,o()(w.Z,{},void 0,o()(l._H,{id:"passwordSettings.changePasswordModal.oldPasswordInput.label",defaultMessage:"Old Password"})),o()(y.Z,{type:"password",value:i,onChange:this.handleOldPasswordChange,showClearButton:!0,onClearButtonClick:this.handleClearOldPassword,placeholder:this.props.intl.formatMessage({id:"passwordSettings.oldPasswordInput.placeholder",defaultMessage:"Enter old password..."}),style:{padding:"4px 8px"},focusInitial:!0,autoComplete:"current-password"})),r?o()(w.Z,{hasMarginTop:!0},void 0,o()(l._H,{id:"passwordSettings.newPasswordInput.label",defaultMessage:"New password"})):o()(w.Z,{},void 0,o()(l._H,{id:"passwordSettings.passwordInput.label",defaultMessage:"Password"})),o()(y.Z,{type:"password",value:t,onChange:this.handlePasswordChange,onSubmit:this.handleSubmit,showClearButton:!0,onClearButtonClick:this.handleClearPassword,placeholder:this.props.intl.formatMessage({id:"passwordSettings.newPasswordInput.placeholder",defaultMessage:"Enter new password..."}),style:{padding:"4px 8px"},focusInitial:!r,onBlur:this.handlePasswordBlur,autoComplete:"new-password"}),o()(w.Z,{hasMarginTop:!0},void 0,o()(l._H,{id:"passwordSettings.repeatPasswordInput.label",defaultMessage:"Repeat password"})),o()(y.Z,{type:"password",value:s,onChange:this.handleRepeatPasswordChange,onSubmit:this.handleSubmit,showClearButton:!0,onClearButtonClick:this.handleClearRepeatPassword,placeholder:this.props.intl.formatMessage({id:"passwordSettings.repeatPasswordInput.placeholder",defaultMessage:"Repeat new password..."}),style:{padding:"4px 8px"},onBlur:this.handlePasswordBlur,autoComplete:"new-password"}),o()(Z.Z,{isMultiline:!0,isSecondaryColor:!0,style:{marginTop:14}},void 0,o()(l._H,{id:"passwordSettings.passwordGuidelines",defaultMessage:"Use a password at least 15 letters long, or at least 8 characters long with both letters and numbers."})),e&&o()(Z.Z,{isMultiline:!0,isSecondaryColor:!0,style:{marginTop:14}},void 0,this.renderEducationPlanInfo()),this.renderAlert(n),o()(f.Z,{isLarge:!0,style:{marginTop:14},onClick:this.handleSubmit},void 0,o()(l._H,r?{id:"passwordSettings.changePasswordButton.label",defaultMessage:"Change password"}:{id:"passwordSettings.setPasswordButton.label",defaultMessage:"Set a password"})))}renderRemovePassword(){const{isEducationPlan:e}=this.props;if(!h.Z.isRemovePasswordModal())return;const{oldPassword:t,alert:s}=h.Z.state;return o()(a.Fragment,{},void 0,o()("div",{style:{fontSize:14,width:"100%"}},void 0,o()(l._H,{id:"passwordSettings.removePasswordModal.text",defaultMessage:"You're about to remove your password. We'll email you temporary login codes to access Notion going forward.",description:"Message warning the user that they're about to delete their password, and telling them how to log in after their password has been deleted."}),e&&o()(l._H,{id:"passwordSettings.removePasswordModal.educationPlanWarning",defaultMessage:"If you lose access to your school email, you'll be unable to log back into Notion.",description:"Warning for users on the Education Plan that if they lose access to their school email, they won't be able to log into Notion without a password."})),o()(w.Z,{hasMarginTop:!0},void 0,o()(l._H,{id:"passwordSettings.deletePasswordModal.passwordInput.label",defaultMessage:"Password"})),o()(y.Z,{type:"password",value:t,onChange:this.handleOldPasswordChange,onSubmit:this.handleRemovePasswordClick,showClearButton:!0,onClearButtonClick:this.handleClearOldPassword,placeholder:this.props.intl.formatMessage({id:"passwordSettings.removePasswordModal.passwordInput.placeholder",defaultMessage:"Enter your password..."}),style:{padding:"4px 8px"},focusInitial:!0,autoComplete:"current-password"}),this.renderAlert(s),o()(f.Z,{isLarge:!0,style:{marginTop:14},onClick:this.handleRemovePasswordClick},void 0,o()(l._H,{id:"passwordSettings.removePasswordModal.removePasswordButton.label",defaultMessage:"Remove password"})))}renderAlert(e){if(e)return o()(Z.Z,{isMultiline:!0,style:{marginTop:8,color:M.ZP.red}},void 0,e)}renderEducationPlanInfo(){return o()(l._H,{id:"passwordSettings.educationPlanGuidelines",defaultMessage:"If you lose access to your school email address, you'll be able to log in using your password."})}getSettingsOptionStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto",paddingLeft:e.isMobile?t.state.paddingLeftCSS:0,paddingRight:e.isMobile?t.state.paddingRightCSS:0}}saveNewPasswordSuccess(){const{intl:e,isEducationPlan:t}=this.props,{onSubmit:s}=h.Z.state;h.Z.reset();const i=t?e.formatMessage({id:"passwordSettings.setPasswordSuccess.educationMessage",defaultMessage:"Your password is all set! You'll be able to log in, even if you lose access to your school email address."}):e.formatMessage({id:"passwordSettings.setPasswordSuccess.message",defaultMessage:"Your password is all set!"});g.PV({message:i,onAccept:s})}changePasswordSuccess(){const{onSubmit:e}=h.Z.state;h.Z.reset(),g.PV({message:this.props.intl.formatMessage({id:"passwordSettings.changePasswordSuccess.message",defaultMessage:"Your new password has been saved."}),onAccept:e})}removePasswordSuccess(){h.Z.reset(),g.PV({message:this.props.intl.formatMessage({id:"passwordSettings.removePasswordSuccess.message",defaultMessage:"Your password has been removed."})})}getPasswordErrorMessage(e){const t=B.Ql[e.type];return t?this.props.intl.formatMessage(t):this.defaultErrorMessage}canRemovePassword(){const{isEducationPlan:e}=this.props,t=this.stores.hasPasswordStore.get();return!e&&t}}const _=(0,l.XN)(L)},13612:(e,t,s)=>{s.d(t,{Z:()=>M});var i=s(98135),o=s.n(i),n=s(67154),r=s.n(n),a=s(59713),l=s.n(a),d=(s(33948),s(67294)),p=s.n(d),c=s(3779),u=s(50906),h=s(46167),m=s(66832),g=s(52858),S=s(95009),v=s(27832),y=s(14947),b=s(24677),f=s(7313);class w extends m.Z{constructor(...e){super(...e),l()(this,"renderOrigin",(e=>{const{device:t}=this.environment;return p().createElement(y.Z,r()({style:this.getButtonStyle(),mobileFeedback:t.isMobile},e),c.Z.dots({width:18,height:18}))})),l()(this,"renderPopup",(()=>{const{device:e}=this.environment,{store:t}=this.props,s={environment:this.environment,blocks:[t]};let i;return i=e.isMobile?{menuType:S.ZP.MenuType.ActionSheet}:{menuType:S.ZP.MenuType.Popup,width:210,maxHeight:"80vh"},p().createElement(S.ZP,i,o()(g.Z,{sections:f.G9,onAccept:this.handleAccept,context:s}))})),l()(this,"handleClick",(()=>{b.ZH(this.environment),u.FjP(this.environment)})),l()(this,"handleDismiss",(()=>{this.props.buttonPopupStore.setState({...this.props.buttonPopupStore.state,open:!1})})),l()(this,"handleAccept",(e=>{const{currentBlockStore:t}=v.Z.state;if(t){const s=t.getType();s&&u.dhV(this.environment,{analyticsName:e.analyticsName,from:"public_topbar_more_menu",block_type:s})}e.closeParentMenu&&this.handleDismiss()}))}renderComponent(){const{device:e}=this.environment;return o()(h.Z,{popupType:e.isMobile?h.Z.PopupType.SlideUp:h.Z.PopupType.Popup,buttonPopupStore:this.props.buttonPopupStore,renderOrigin:this.renderOrigin,onClick:this.handleClick,render:this.renderPopup,originGap:8})}getButtonStyle(){const{device:e}=this.environment;return e.isMobile?{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",marginLeft:8,marginRight:8}:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:3}}}const M=w},78092:(e,t,s)=>{s.d(t,{Z:()=>b});var i=s(67154),o=s.n(i),n=s(98135),r=s.n(n),a=s(67294),l=s.n(a),d=s(19757),p=s(48762),c=s(8848),u=s(3779),h=s(90175),m=s(20083),g=s(82990),S=s(5366),v=s(58879),y=s(64215);const b=function(e){const t=l().useRef(),s=(0,v.Fy)(),{isMobile:i}=s,{activeOption:n,items:a}=l().useMemo((()=>function(e){const{currentSortBy:t,setSortBy:s,sortOptions:i,selectButton:n}=e;let r=i[0];const a=i.map((e=>{const i=e.key===t;return i&&(r=e),{key:e.key,action:()=>{s(e.key),n&&n.current&&n.current.closeMenu()},render:t=>l().createElement(p.Z,o()({},t,{title:e.formattedName,right:i&&u.Z.check({fill:c.ZP.blue,width:12,height:12})}))}}));return{activeOption:r,items:a}}({...e,selectButton:t})),[e,t]),b=(0,y.y)((e=>({selectedTitle:{color:e.mediumTextColor},label:{marginRight:2,fontSize:i?g.Z.fontSize.UISmall.mobile:g.Z.fontSize.UISmall.desktop,transform:"translateY(0.5px)"},innerButton:{color:e.mediumTextColor,fontWeight:g.Z.fontWeight.medium,fontSize:i?g.Z.fontSize.UISmall.mobile:g.Z.fontSize.UISmall.desktop,height:20,padding:"2px 4px",marginRight:1,transform:"translateY(0.5px)"},menu:{minWidth:200}})),[i]),f=i?r()(S._H,{id:"search.sort.sortMenuTitle",defaultMessage:"Sort By"}):void 0;return l().createElement(m.Z,{ref:e=>{e&&(t.current=e)},alignmentToOrigin:d.v2.Start,selectedTitle:r()("div",{style:b.selectedTitle},void 0,n.formattedName),label:r()(S._H,{id:"search.sort.sortButtonPrefixLabel",defaultMessage:"Sort:",description:"Will be displayed next to a sortOrder"}),renderMenuSections:()=>[{key:"searchSortOrder",render:e=>l().createElement(h.Z,o()({},e,{title:f,desktopStyle:b.menu,disableDesktopPadding:!1})),items:a}],labelStyle:b.label,innerButtonStyle:b.innerButton})}},20083:(e,t,s)=>{s.d(t,{Z:()=>Z});var i=s(98135),o=s.n(i),n=s(67154),r=s.n(n),a=s(59713),l=s.n(a),d=(s(33948),s(67294)),p=s.n(d),c=s(66832),u=s(25584),h=s(46167),m=s(52016);class g extends m.Z{getInitialState(){return{}}}const S=g;var v=s(95009),y=s(61766),b=s(42001),f=s(3779),w=s(1464);class M extends c.Z{constructor(...e){super(...e),l()(this,"storeTypes",{buttonPopupStore:y.Z,SelectButtonStore:S}),l()(this,"renderMenuItemOrigin",(e=>{const{style:t}=this.props;if(this.props.isMenuItem){const s=this.props.label?{title:this.props.label,right:this.props.selectedTitle}:{title:this.props.selectedTitle};return p().createElement(w.Z,r()({},e,{focused:!!this.props.focused,disabled:this.props.disabled,style:t},s))}})),l()(this,"renderButtonOrigin",(e=>{const{innerButtonStyle:t}=this.props;return p().createElement(b.Z,r()({disabled:this.props.disabled,disabledFeedback:!0,style:{marginRight:-6,...t}},e),this.props.selectedTitle,this.chevronDownIcon())})),l()(this,"handleSelection",(e=>{this.stores.SelectButtonStore.setState({selectedKey:e})})),l()(this,"closeMenu",(()=>{const{buttonPopupStore:e}=this.stores;e.setState({...e.state,open:!1})})),l()(this,"chevronDownIcon",(()=>{const{device:e}=this.environment;return f.Z.chevronDown({width:e.isMobile?14:10,marginLeft:4,fill:this.theme.lightIconColor})}))}renderComponent(){const{isMenuItem:e,style:t,labelStyle:s}=this.props;return e?this.renderButtonPopup(this.renderMenuItemOrigin):o()("div",{style:{display:"flex",alignItems:"center",height:32,...t}},void 0,this.props.label&&o()("div",{style:{marginRight:"auto",color:this.theme.lightTextColor,fontSize:14,...s}},void 0,this.props.label),this.renderButtonPopup(this.renderButtonOrigin))}renderButtonPopup(e){const{device:t}=this.environment,{alignmentToOrigin:s}=this.props;return o()(h.Z,{popupType:t.isMobile?h.Z.PopupType.SlideUp:h.Z.PopupType.Popup,buttonPopupStore:this.stores.buttonPopupStore,alignmentToOrigin:void 0!==s?s:h.Z.Alignment.End,renderOrigin:e,placementToOrigin:this.props.isMenuItem?h.Z.Placement.Right:h.Z.Placement.Bottom,render:e=>{let s;s=t.isMobile?{menuType:v.ZP.MenuType.ActionSheet}:{menuType:v.ZP.MenuType.Popup};const{focusedIndex:i,menuSections:n}=this.getMenuSections(e);return p().createElement(v.ZP,s,o()(u.Z,{type:u.Z.Type.Vertical,initialFocus:i,sections:n}))}})}getMenuSections(e){let t,s=0;return{menuSections:this.props.renderMenuSections(e).map((e=>({...e,items:e.items.map((e=>(e.key===this.stores.SelectButtonStore.state.selectedKey&&(t=s),s++,{...e,action:t=>{e.action(t),this.handleSelection(e.key)}})))}))),focusedIndex:t}}}const Z=M},40464:(e,t,s)=>{s.d(t,{Z:()=>f});var i=s(98135),o=s.n(i),n=s(67154),r=s.n(n),a=s(59713),l=s.n(a),d=(s(33948),s(67294)),p=s.n(d),c=s(98724),u=s(66832),h=s(37235),m=s(50906),g=s(24666),S=s(14947),v=s(8848),y=s(89086);class b extends u.Z{constructor(...e){super(...e),l()(this,"handleClick",(e=>{c.a({environment:this.environment,annotation:[this.props.type]}),this.props.onClick&&this.props.onClick(),m.mt_(this.environment,{action:this.props.type})})),l()(this,"isDisabledStore",this.createComputedStore((()=>this.props.disabled||"editing"!==g.Z.state.mode)))}renderComponent(){return o()(h.Z,{renderTooltip:()=>this.props.tooltipLabel,render:e=>p().createElement(S.Z,r()({style:this.getButtonStyle(),disabled:this.isDisabledStore.state,disabledFeedback:this.isDisabledStore.state,onClick:this.handleClick},e),this.props.children)})}getButtonStyle(){return{display:"flex",alignItems:"center",padding:"0 8px",color:(0,y.Ld)(this.props.type)?v.ZP.blue:this.theme.regularTextColor,...this.props.style}}}const f=b},32404:(e,t,s)=>{s.d(t,{Z:()=>M});var i=s(67154),o=s.n(i),n=s(98135),r=s.n(n),a=s(59713),l=s.n(a),d=(s(33948),s(67294)),p=s.n(d),c=s(70203),u=s(14947),h=s(36280),m=s(66949),g=s(89086),S=s(5366),v=s(94610),y=s(66832),b=s(37235),f=s(24666);class w extends y.Z{constructor(...e){super(...e),l()(this,"renderMenuTooltip",(()=>{const e=this.getThemeColors();return r()(p().Fragment,{},void 0,r()("div",{},void 0,r()(S._H,{id:"richTextMenu.equationButton.tooltip",defaultMessage:"Create equation"})),r()("div",{},void 0,r()(v.Z,{style:e.keyboardShortcut,name:"openEquationMenu"})))})),l()(this,"handleButtonPopupClick",(e=>{const{onClick:t}=this.props;h.qn({environment:this.environment,analyticsFrom:"rich_text_menu"}),t&&t(e)})),l()(this,"isSelected",(()=>(0,g.Ld)(c.GK.Equation))),l()(this,"isDisabled",(()=>{const{disabled:e}=this.props;if(e)return!0;if("editing"!==f.Z.state.mode&&!m.Z.isOpen())return!0;const t={[c.GK.User]:c.GK.User,[c.GK.Page]:c.GK.Page,[c.GK.Bot]:c.GK.Bot,[c.GK.Date]:c.GK.Date,[c.GK.ExternalObjectInstance]:c.GK.ExternalObjectInstance,[c.GK.TemporaryPage]:c.GK.TemporaryPage,[c.GK.TemplateVariable]:c.GK.TemplateVariable};for(const s of Object.values(t))if((0,g.J6)(s))return!0;return!1})),l()(this,"styles",{equationButton:{display:"flex",alignItems:"center",borderRadius:0,paddingLeft:7,paddingRight:8}})}renderComponent(){const{style:e,children:t}=this.props,s=this.getThemeColors(),i=this.isDisabled();return r()(b.Z,{renderTooltip:this.renderMenuTooltip,render:n=>p().createElement(u.Z,o()({style:{...this.styles.equationButton,...s.equationButton,...e},disabled:i,disabledFeedback:i,onClick:this.handleButtonPopupClick},n),t)})}getThemeColors(){return{equationButton:{color:this.isSelected()?this.theme.blueColor:this.theme.regularTextColor},keyboardShortcut:{color:this.theme.mediumInvertedTextColor}}}}const M=(0,S.XN)(w)},73383:(e,t,s)=>{s.d(t,{Z:()=>Z});var i=s(67154),o=s.n(i),n=s(98135),r=s.n(n),a=s(59713),l=s.n(a),d=(s(33948),s(67294)),p=s.n(d),c=s(45990),u=s(66832),h=s(37235),m=s(94610),g=s(50906),S=s(14947),v=s(24666),y=s(23178),b=s(89086),f=s(5366),w=s(70203);class M extends u.Z{constructor(...e){super(...e),l()(this,"handleButtonPopupClick",(()=>{c.dz({focus:!0}),g.mt_(this.environment,{action:w.GK.Link})}))}renderComponent(){const e=(0,b.Ld)(w.GK.Link),t=this.isDisabled();return r()(h.Z,{renderTooltip:()=>r()(d.Fragment,{},void 0,r()("div",{},void 0,r()(f._H,{defaultMessage:"Add link",id:"selectionLinkButton.addLink.tooltip",description:"Prompt for the user to add a URL to link to from the selected text."})),r()("div",{},void 0,r()(m.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"openLinkMenu"}))),render:s=>p().createElement(S.Z,o()({style:{display:"flex",alignItems:"center",borderRadius:0,paddingLeft:7,paddingRight:8,...e&&{color:this.theme.blueColor},whiteSpace:"nowrap",...this.props.style},disabled:t,disabledFeedback:t},s,{onClick:this.handleButtonPopupClick}),this.props.children)})}isDisabled(){return!!this.props.disabled||("editing"!==v.Z.state.mode&&!y.Z.state.open||!!((0,b.J6)(w.GK.User)||(0,b.J6)(w.GK.Bot)||(0,b.J6)(w.GK.Date)||(0,b.J6)(w.GK.Page)))}}const Z=(0,f.XN)(M)},27386:(e,t,s)=>{s.d(t,{Z:()=>d});var i=s(98135),o=s.n(i),n=(s(67294),s(29368)),r=s(592),a=s(66832);class l extends a.Z{static renderDivider(){return o()(n.Z,{size:37})}renderComponent(){const{device:e}=this.environment,{children:t,controlRow:s}=this.props,i=()=>e.isMobile?18:60,n=()=>e.isMobile?18:36;return this.props.disableScroller?o()("div",{style:{paddingLeft:i(),paddingRight:i()}},void 0,o()("div",{style:{paddingTop:n(),paddingBottom:n()}},void 0,t),s&&o()("div",{style:{paddingTop:16,paddingBottom:16,boxShadow:"0 -1px 0 ".concat(this.theme.regularDividerColor)}},void 0,s)):o()("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%",backgroundColor:this.theme.contentBackground}},void 0,o()(r.ZP,{type:r.xm.All,style:{flexGrow:1,WebkitOverflowScrolling:"touch",transform:"translateZ(0)",paddingLeft:i(),paddingRight:i(),paddingTop:n(),paddingBottom:n()}},void 0,t),s&&o()("div",{style:{flexGrow:0,flexShrink:0,paddingLeft:i(),paddingRight:i(),paddingTop:16,paddingBottom:16,boxShadow:"0 -1px 0 ".concat(this.theme.regularDividerColor)}},void 0,s))}}const d=l},14694:(e,t,s)=>{s.d(t,{Z:()=>d});var i=s(98135),o=s.n(i),n=s(59713),r=s.n(n),a=(s(67294),s(66832));class l extends a.Z{renderComponent(){return o()("div",{style:this.getStyle(),onMouseMove:this.props.onMouseMove,onMouseLeave:this.props.onMouseLeave,className:this.props.className},void 0,this.props.left&&o()("div",{style:this.getLeftStyle()},void 0,this.props.left),this.props.icon&&o()("div",{style:this.getIconStyle()},void 0,this.props.icon),this.renderChildren(),this.props.right&&o()("div",{style:this.getRightStyle()},void 0,this.props.right))}renderChildren(){return o()("div",{style:{...l.childrenStyle,overflow:"hidden",textOverflow:this.props.right&&!this.props.isMobile?"clip":"ellipsis",...this.props.childrenStyle}},void 0,this.props.children)}getStyle(){const{WindowSizeStore:e}=this.environment,t={...this.props.isMobile?l.wrapMobileStyle:l.wrapStyle};if(this.props.isMobile){this.props.disableMobileBorder||(t.boxShadow="0 1px 0 ".concat(this.theme.regularDividerColor)),t.marginBottom=this.props.shouldShowMobileMarginBotton?12:1;const s=this.props.style&&"number"==typeof this.props.style.paddingLeft?this.props.style.paddingLeft:"number"==typeof t.paddingLeft?t.paddingLeft:0;t.paddingLeft=e.getSafePaddingLeftCSS(s)}else this.props.style&&this.props.style.paddingLeft&&(t.paddingLeft=this.props.style&&this.props.style.paddingLeft);return{...t,paddingLeft:t.paddingLeft,...this.props.style}}getLeftStyle(){return{flexShrink:0,flexGrow:0,borderRadius:3,color:this.theme.mediumTextColor,width:this.props.isMobile?26:22,height:this.props.isMobile?24:22,display:"flex",alignItems:"center",justifyContent:"center",marginRight:this.props.icon?0:8}}getIconStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,flexGrow:0,width:this.props.isMobile?28:22,height:this.props.isMobile?24:18,marginRight:4}}getRightStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,flexGrow:0,height:"100%"}}}r()(l,"wrapStyle",{display:"flex",alignItems:"center",minHeight:27,fontSize:14,paddingTop:2,paddingBottom:2,paddingLeft:14,paddingRight:14,width:"100%"}),r()(l,"wrapMobileStyle",{display:"flex",alignItems:"center",minHeight:26,fontSize:16,paddingTop:8,paddingBottom:8,paddingLeft:10,paddingRight:10,width:"100%",userSelect:"none",WebkitUserSelect:"none"}),r()(l,"childrenStyle",{flexGrow:1,flexShrink:1,flexBasis:"auto",whiteSpace:"nowrap",minWidth:0});const d=l},10118:(e,t,s)=>{s.d(t,{Z:()=>Qe});var i=s(67154),o=s.n(i),n=s(98135),r=s.n(n),a=s(59713),l=s.n(a),d=(s(33948),s(96486)),p=s.n(d),c=s(67294),u=s.n(c),h=s(58059),m=s(85419),g=s(76464),S=s(29974),v=s(31942),y=s(52016);let b;!function(e){e[e.Members=0]="Members",e[e.Groups=1]="Groups",e[e.Guests=2]="Guests"}(b||(b={}));class f extends y.Z{getInitialState(){return{currentTab:b.Members,limitMembers:!0,limitGuests:!0,membersFilter:"",guestsFilter:"",groupsFilter:"",groupNameInputValue:"",upsellModalOpen:!1}}}const w=f;var M=s(38978),Z=s(66832),P=s(29368),C=s(2107),k=s(26435),x=s(61766),T=s(46167),I=s(25584),B=s(95009),L=s(24042),_=s(83071),E=s(16328),R=s(47307),H=s(32935),G=s(21325),U=s(84210),D=s(8646),A=s(37235),O=s(86646),F=s(50906),N=s(70825),V=s(47966),W=s(42001),z=s(3779),K=s(1643),q=s(78291),j=s(5366),Y=s(85404);const X=(0,j.vU)({removingGuest:{id:"guestPagesPopup.removeGuest.updatingMessage",defaultMessage:"Updating…"},addingMember:{id:"guestPagesPopup.addMemberPermission.updatingMessage",defaultMessage:"Updating…"}});class J extends Z.Z{constructor(...e){super(...e),l()(this,"storeTypes",{buttonPopupStore:x.Z}),l()(this,"renderPopup",(()=>{const{device:e}=this.environment,{store:t,guest:s}=this.props,i=t.canAdmin(),n=s.guestPageIds.map((e=>{const s=k.Z.createChildStore(t,{table:Y.iU,id:e});return{key:e,render:e=>u().createElement(L.Z,o()({},e,{store:s,placeholder:r()(j._H,{id:"guestPagesPopup.privatePagePlaceholder",defaultMessage:"Private page"})})),action:()=>{const s=k.Z.createChildStore(t,{table:Y.iU,id:e}),i=(0,U.Z)({store:s,fullyQualified:!1});C.c4({environment:this.environment,url:i,metaClick:!0})}}}));let a,l;return a=e.isMobile?{menuType:B.ZP.MenuType.ActionSheet}:{menuType:B.ZP.MenuType.Popup,width:300},(0,K.qF)(this.environment)&&(l=r()(A.Z,{renderTooltip:()=>this.isSubscribed()?r()(j._H,{id:"guestPagesPopup.addMemberPermissionButton.tooltip",defaultMessage:"This guest will become a member of this workspace."}):r()(j._H,{id:"guestPagesPopup.addAdminPermissionButton.tooltip",defaultMessage:"This guest will become an admin of this workspace."}),render:e=>u().createElement(V.Z,o()({isLarge:!0,onClick:this.handleConvertToMemberClick},e),this.isSubscribed()?r()(j._H,{id:"guestPagesPopup.addMemberPermissionButton.label",defaultMessage:"Convert to member"}):r()(j._H,{id:"guestPagesPopup.addAdminPermissionButton.label",defaultMessage:"Convert to admin"}))})),u().createElement(B.ZP,a,i&&r()(O.Z,{title:r()("div",{style:{paddingTop:12,paddingBottom:8,display:"flex",alignItems:"flex-start"}},void 0,l,r()(A.Z,{renderTooltip:()=>r()(j._H,{id:"guestPagesPopup.removeGuestButton.tooltip",defaultMessage:"This guest will be removed from all pages in this Workspace."}),render:e=>u().createElement(V.Z,o()({isLarge:!0,isRed:!0,style:{marginLeft:l?8:0},onClick:this.handleRemoveClick},e),r()(j._H,{id:"guestPagesPopup.removeGuestButton.label",defaultMessage:"Remove"}))}))}),i&&r()(E.Z,{title:r()(j._H,{id:"guestPagesPopup.guestAccessiblePagesCaption",defaultMessage:"This guest can access these pages"})}),r()(I.Z,{type:I.Z.Type.Vertical,initialFocus:0,sections:[{key:"pages",render:e=>u().createElement(_.Z,e),items:n}]}))})),l()(this,"handleRemoveClick",(()=>{R.vC({showCancel:!0,keepFocus:!1,message:r()(j._H,{id:"guestPagesPopup.removeGuestModal.confirmationMessage",defaultMessage:"Are you sure you want to remove this person? They will lose access to all shared pages."}),items:[{label:r()(j._H,{id:"guestPagesPopup.removeGuestModal.removeButton.label",defaultMessage:"Remove"}),color:"red",onAccept:async()=>{const{guest:e,store:t}=this.props;this.stores.buttonPopupStore.setState({...this.stores.buttonPopupStore.state,open:!1}),N.j({message:X.removingGuest});"success"===(await H.XgZ(this.environment,{userIds:[e.userId],spaceId:t.id,removePagePermissions:!0,revokeUserTokens:!1})).type&&(await G.bi(this.environment),F.bwR(this.environment)),N.x()}}]})})),l()(this,"handleConvertToMemberClick",(async()=>{const e=D.Ue(this.environment),{store:t,guest:s,isSubscribed:i}=this.props,o=g.ep({environment:this.environment,store:t,permissionItems:[{type:"user_permission",role:i?"read_and_write":"editor",user_id:s.userId}],transaction:e});D.th({environment:this.environment,transaction:e}),this.stores.buttonPopupStore.setState({...this.stores.buttonPopupStore.state,open:!1}),N.j({message:X.addingMember});try{await o,await G.bi(this.environment),F.Rbv(this.environment,{member_user_id:s.userId})}finally{N.x()}}))}renderComponent(){const{device:e}=this.environment,{buttonPopupStore:t}=this.stores,{store:s,guest:i}=this.props;return i.guestPageIds.map((e=>{k.Z.createChildStore(s,{table:Y.iU,id:e}).getValue()})),0===i.guestPageIds.length?r()(j._H,{id:"guestPagesPopup.permissionsForUserGuest.label",defaultMessage:"Guest"}):r()(T.Z,{popupType:e.isMobile?T.Z.PopupType.SlideUp:T.Z.PopupType.Popup,renderOrigin:e=>u().createElement(W.Z,e,r()(j._H,{id:"guestPagesButton.label",defaultMessage:"{numberOfAccessiblePages, plural, one {{numberOfAccessiblePages} page} other {{numberOfAccessiblePages} pages}}",values:{numberOfAccessiblePages:i.guestPageIds.length}}),z.Z.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor})),buttonPopupStore:t,render:this.renderPopup})}isSubscribed(){const{data:e}=q.Z.state;return Boolean(e&&(0,K.YK)(e))}}const Q=(0,j.XN)(J);var $=s(62727),ee=s(7567),te=s(27386),se=s(40235),ie=s(66957),oe=s(26178),ne=s(41493),re=s(40515);class ae extends y.Z{getInitialState(){return{userInputValue:"",temporaryUserIds:[],limitUsers:!0}}}const le=ae;var de=s(15692),pe=s(58945),ce=s(44517),ue=s(7765),he=s(31299),me=s(97680),ge=s(47082),Se=s(13548),ve=s(31792),ye=s(69152),be=s(12534),fe=s(62619),we=s(89206),Me=s(49312),Ze=s(82990),Pe=s(22808),Ce=s(22294),ke=s(72693),xe=s(80527),Te=s(33728),Ie=s(27832),Be=s(43997),Le=s(16639);class _e extends Z.Z{constructor(...e){super(...e),l()(this,"storeTypes",{spacePermissionGroupStore:le,actionMenuButtonPopupStore:x.Z,addMemberButtonPopupStore:x.Z,autocompleteStore:ce.Z,mouseStore:ve.Z}),l()(this,"renderUser",(e=>{const{store:t,group:s,disabled:i}=this.props;return r()("div",{style:{display:"flex",alignItems:"center"}},e.id,r()(ne.Z,{userValue:e,style:{paddingRight:6,minHeight:34,lineHeight:1.2,width:"100%"},avatarSize:24}),!i&&r()(W.Z,{onClick:async()=>{if(await R.gt({message:r()(j._H,{id:"spacePermissionsSettings.groupsTab.removeMemberFromGroupDialog.confirmationMessage",defaultMessage:"Are you sure you want to remove this member?"}),acceptLabel:r()(j._H,{id:"spacePermissionsSettings.groupsTab.removeMemberFromGroupDialog.confirmationButton.label",defaultMessage:"Yes"})})){const i=(s.user_ids||[]).filter((t=>t!==e.id)),o={...s,user_ids:i};D.H5(this.environment,(e=>{S.jF({spaceStore:t,group:o,transaction:e})})),F.xtf(this.environment)}}},void 0,r()(j._H,{id:"spacePermissionsSettings.groupsTab.removeMemberFromGroupButton.label",defaultMessage:"Remove"})))})),l()(this,"renderActionMenu",(()=>{const e={key:"action_menu",render:e=>u().createElement(_.Z,e),items:[{key:"rename",render:e=>u().createElement(pe.Z,o()({},e,{title:r()(j._H,{id:"spacePermissionsSettings.groupsTab.groupList.actionMenu.renameItem",defaultMessage:"Rename"})})),action:this.handleRename},{key:"delete",render:e=>u().createElement(pe.Z,o()({},e,{title:r()(j._H,{id:"spacePermissionsSettings.groupsTab.groupList.actionMenu.deleteItem",defaultMessage:"Delete"})})),action:this.handleDelete}]};return r()(B.ZP,{menuType:B.ZP.MenuType.Popup},void 0,r()(I.Z,{type:I.Z.Type.Vertical,initialFocus:0,sections:[e],onAccept:()=>{this.stores.actionMenuButtonPopupStore.reset()}}))})),l()(this,"renderAddMemberMenu",(()=>{const{store:e}=this.props,{userInputValue:t,temporaryUserIds:s}=this.stores.spacePermissionGroupStore.state,i={request:{query:t,temporaryUserIds:this.stores.spacePermissionGroupStore.state.temporaryUserIds},performRequest:async({query:e,temporaryUserIds:t})=>{const{group:s}=this.props,i=s.user_ids||[];return(await he.O$({environment:this.environment,query:e,membersOnly:!0})).filter((e=>i.indexOf(e.id)<0&&t.indexOf(e.id)<0)).slice(0,20)},render:this.renderAddMemberResults},o=s.map((t=>{const i=e.getRecordValue({table:m.KJ,id:t});return r()(Be.vw,{userValue:i,format:Be.vw.Format.Medium,showRemoveButton:!0,onClickRemove:()=>{const e=s.filter((e=>e!==t));this.stores.spacePermissionGroupStore.setState({...this.stores.spacePermissionGroupStore.state,temporaryUserIds:e})},shouldShrink:!0,isSingle:!1},t)}));return r()(B.ZP,{menuType:B.ZP.MenuType.Popup,tokenInputHeader:!0,header:r()(ge.Z,{focus:!0,disabled:!1,focusAfterAnimation:!0,format:ge.Z.Format.Group,tokens:o,placeholder:this.props.intl.formatMessage({id:"spacePermissionsSettings.groupsTab.userGroup.userSearchInput.placeholder",defaultMessage:"Search for a person…"}),onRemoveLastToken:this.handleTokenInputMenuItemRemoveLastToken,value:t,onChange:this.handleTokenInputMenuItemChange,right:r()(ke.Z,{isLarge:!0,onClick:this.handleAddDoneClick},void 0,r()(j._H,{id:"spacePermissionsSettings.groupsTab.userGroup.addUserButton.label",defaultMessage:"Add"}))})},void 0,u().createElement(ue.Z,i))})),l()(this,"renderAddMemberResults",((e,t)=>{const{store:s}=this.props,i=t||[],{temporaryUserIds:n}=this.stores.spacePermissionGroupStore.state,a=i.map((({id:e})=>e));if(0===a.length)return r()(_.Z,{},void 0,r()(E.Z,{title:r()(j._H,{id:"spacePermissionsSettings.groupsTab.userGroup.searchUserDropdown.noResultsMessage",defaultMessage:"No results"})}));{const e={key:"user_menu",render:e=>u().createElement(_.Z,e),items:a.map((e=>{const t=M.Z.createChildStore(s,{table:m.KJ,id:e}).getValue();return{key:e,render:e=>u().createElement(me.Z,o()({},e,{user:t})),action:()=>{const t=[...n,e];this.stores.spacePermissionGroupStore.setState({...this.stores.spacePermissionGroupStore.state,temporaryUserIds:t,userInputValue:""})}}}))};return r()(I.Z,{type:I.Z.Type.Vertical,initialFocus:0,sections:[e]})}})),l()(this,"handleMouseEnter",(e=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})})),l()(this,"handleMouseLeave",(e=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})})),l()(this,"handleMouseDown",(e=>{(0,fe.sh)(e.target,(e=>e&&e.classList&&e.classList.contains(_e.dragHandleClass)))||(0,be.$0)(e)})),l()(this,"handleIconChange",(e=>{const{store:t,group:s}=this.props,i={...s,icon:e};D.H5(this.environment,(e=>{S.jF({spaceStore:t,group:i,transaction:e})})),F.zUE(this.environment,{is_emoji:(0,Pe.Z)(e)})})),l()(this,"handleRename",(()=>{const{group:e,spacePermissionsSettingsStore:t}=this.props;t.setState({...t.state,editingNameGroupId:e.id,groupNameInputValue:e.name||""}),this.stores.actionMenuButtonPopupStore.setState({...this.stores.actionMenuButtonPopupStore.state,open:!1}),F.XbW(this.environment)})),l()(this,"handleDelete",(async()=>{const{store:e,group:t}=this.props;this.stores.actionMenuButtonPopupStore.setState({...this.stores.actionMenuButtonPopupStore.state,open:!1});if(await R.gt({message:r()(j._H,{id:"spacePermissionsSettings.groupsTab.deleteGroupModal.confirmationMessage",defaultMessage:"Are you sure you want to delete this group? Any pages that are private to this group will be transferred to you."}),acceptLabel:r()(j._H,{id:"spacePermissionsSettings.groupsTab.deleteGroupModal.confirmationButton.label",defaultMessage:"Yes"})})){const s=D.Ue(this.environment);await S.Xv({environment:this.environment,spaceStore:e,group:t,transaction:s}),D.th({environment:this.environment,transaction:s}),F.dan(this.environment)}})),l()(this,"handleNameChange",(e=>{this.props.spacePermissionsSettingsStore.setState({...this.props.spacePermissionsSettingsStore.state,groupNameInputValue:e})})),l()(this,"handleNameCancel",(()=>{const{spacePermissionsSettingsStore:e}=this.props;e.setState({...e.state,editingNameGroupId:void 0,groupNameInputValue:""})})),l()(this,"handleNameAccept",(()=>{const{store:e,group:t,spacePermissionsSettingsStore:s}=this.props,{editingNameGroupId:i,groupNameInputValue:o}=s.state;if(i===t.id){if(o!==t.name){const s={...t,name:o};D.H5(this.environment,(t=>{S.jF({spaceStore:e,group:s,transaction:t})}))}s.setState({...s.state,editingNameGroupId:void 0,groupNameInputValue:""})}})),l()(this,"handleTokenInputMenuItemRemoveLastToken",(()=>{const{temporaryUserIds:e}=this.stores.spacePermissionGroupStore.state,t=e.slice(0,e.length-1);this.stores.spacePermissionGroupStore.setState({...this.stores.spacePermissionGroupStore.state,temporaryUserIds:t})})),l()(this,"handleTokenInputMenuItemChange",(e=>{const t=e.target.value,{spacePermissionGroupStore:s}=this.stores,{extractedEmails:i,newInputValue:o}=(0,Te.zI)(t),{currentSpaceStore:n}=Ie.Z.state,{data:r}=q.Z.state;if(!r||!n)return;const a=(0,K.uF)(r).map((e=>e.userId)),l=p().compact(a.map((e=>M.Z.createChildStore(n,{table:m.KJ,id:e}).getValue()))).filter((e=>i.includes(e.email)&&!s.state.temporaryUserIds.includes(e.id)));s.setState({...s.state,temporaryUserIds:[...s.state.temporaryUserIds,...l.map((e=>e.id))],userInputValue:o})})),l()(this,"handleAddDoneClick",(()=>{const{store:e,group:t}=this.props,{temporaryUserIds:s}=this.stores.spacePermissionGroupStore.state,i=t.user_ids||[],o=p().union(i,s),n={...t,user_ids:o};D.H5(this.environment,(t=>{S.jF({spaceStore:e,group:n,transaction:t})})),this.stores.spacePermissionGroupStore.reset(),this.stores.addMemberButtonPopupStore.setState({...this.stores.addMemberButtonPopupStore.state,open:!1}),F.Kf$(this.environment,{add_member_count:s.length})})),l()(this,"handleAddMemberButtonPopupClose",(()=>{this.stores.spacePermissionGroupStore.reset()})),l()(this,"handleShowMoreClick",(()=>{this.stores.spacePermissionGroupStore.setState({...this.stores.spacePermissionGroupStore.state,limitUsers:!1})}))}renderComponent(){const{store:e,group:t,spacePermissionsSettingsStore:s,disabled:i}=this.props,{groupsFilter:n}=s.state,{limitUsers:a}=this.stores.spacePermissionGroupStore.state,l=Le.k({intl:this.props.intl,group:t}),{countRemainingUsers:d,totalNumberMembers:c,limitedUserValues:h}=Le.r({group:t,spaceStore:e,limit:a&&!n?_e.defaultLimit:void 0}),g=p().sortBy(h,(e=>(0,m.of)(e))),S=n?(0,v.ZP)(n,g,(e=>(0,m.of)(e))):g,{mouseEntered:y}=this.stores.mouseStore.state,b=y&&!Ce.Z.state.isKeyboardMode&&!i,{editingNameGroupId:f,groupNameInputValue:w}=s.state;return r()("div",{style:{marginBottom:36,fontSize:14,width:"100%"},onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onMouseDown:this.handleMouseDown},void 0,r()("div",{style:{display:"flex"}},void 0,!i&&r()(Se.Z,{isVisible:!0,animationStyle:{opacity:b?1:0},enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},render:()=>r()("div",{style:{marginLeft:-24,marginRight:4},className:_e.dragHandleClass},void 0,r()(ye.Z,{hideClickMessage:!0}))}),r()(re.Z,i?{disabled:!0,icon:t.icon?{pointer:e.pointer,icon:t.icon}:void 0,size:22,isEmptyPage:!1,title:l,style:{marginLeft:3,marginRight:3}}:{disabled:!1,bucket:"public",icon:t.icon?{pointer:e.pointer,icon:t.icon}:void 0,size:22,isEmptyPage:!1,title:l,onChange:this.handleIconChange,style:{marginLeft:3,marginRight:3}}),f===t.id?r()(we.Z,{capture:!0,onEsc:this.handleNameCancel},void 0,r()(Me.Z,{disabled:i,type:Me.Z.Type.Inline,style:{marginLeft:4,cursor:"text",fontWeight:Ze.Z.fontWeight.semibold},placeholderStyle:{marginLeft:4,cursor:"text",color:this.theme.lightTextColor,fontWeight:Ze.Z.fontWeight.semibold},placeholder:this.props.intl.formatMessage({id:"spacePermissionsSettings.groupsTab.userGroup.groupNameInput.placeholder",defaultMessage:"Untitled"}),focus:!0,value:w,onChange:this.handleNameChange,onBlur:this.handleNameAccept,onSubmit:this.handleNameAccept})):r()(W.Z,{isSmall:!0,style:{fontWeight:Ze.Z.fontWeight.semibold,marginLeft:-2,marginTop:-1},onClick:this.handleRename,disabled:i,className:"notranslate"},void 0,l),c>0&&r()("div",{style:{alignItems:"center",marginLeft:8,color:this.theme.mediumTextColor},className:"notranslate"},void 0,r()(j._H,{id:"spacePermissionsSettings.groupsTab.userGroup.memberCount",defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} member} other {{numberOfGroupMembers} members}}",values:{numberOfGroupMembers:c}})),r()("div",{style:{flexGrow:1}}),!i&&r()(T.Z,{popupType:de.kQ.Popup,render:this.renderActionMenu,buttonPopupStore:this.stores.actionMenuButtonPopupStore,renderOrigin:e=>u().createElement(xe.Z,o()({icon:z.Z.dots},e))})),r()(P.Z,{size:12}),S.map(this.renderUser),d>0&&r()("div",{},void 0,r()(W.Z,{isGray:!0,style:{marginTop:4},onClick:this.handleShowMoreClick},void 0,r()(j._H,{id:"spacePermissionsSettings.groupsTab.showMoreUsersButton.label",defaultMessage:"{numberOfHiddenUsers, plural, one {Show {numberOfHiddenUsers} more} other {Show {numberOfHiddenUsers} more}}",values:{numberOfHiddenUsers:d}}))),!i&&r()(T.Z,{popupType:de.kQ.Popup,render:this.renderAddMemberMenu,buttonPopupStore:this.stores.addMemberButtonPopupStore,onClose:this.handleAddMemberButtonPopupClose,style:{width:400},renderOrigin:e=>r()("div",{},void 0,u().createElement(W.Z,o()({isGray:!0,icon:z.Z.plus,style:{marginTop:4}},e),r()(j._H,{id:"spacePermissionsSettings.groupsTab.groupList.addMemberButton.label",defaultMessage:"Add members"})))}))}}l()(_e,"dragHandleClass","drag_handle"),l()(_e,"defaultLimit",10);const Ee=(0,j.XN)(_e);var Re=s(98726),He=s(88632),Ge=s(92083),Ue=s(42402),De=s(33058),Ae=s(74523),Oe=s(46951),Fe=s(64581),Ne=s(47714),Ve=s(66055),We=s(68932),ze=s(57623),Ke=s(23189),qe=s(69435),je=s(97880),Ye=s(77907),Xe=s(38755);class Je extends Z.Z{constructor(...e){super(...e),l()(this,"storeTypes",{spacePermissionsSettingsStore:w}),l()(this,"renderSpaceGroup",(e=>{const{store:t}=this.props,{spacePermissionsSettingsStore:s}=this.stores;return r()(Ee,{store:t,group:e,spacePermissionsSettingsStore:s,disabled:!this.canEditGroups()},e.id)})),l()(this,"handleUpdateClick",(()=>{const e=(0,j.vU)({updatingPermissions:{id:"spacePermissionsSettings.updatePermissionsMessage",defaultMessage:"Updating…"}});N.j({message:e.updatingPermissions})})),l()(this,"handleUpdateComplete",(()=>{N.x()})),l()(this,"handleTabClick",(e=>{const t=e;switch(t){case b.Members:F.qTS(this.environment,{tab:"members"});break;case b.Groups:F.qTS(this.environment,{tab:"groups"});break;case b.Guests:F.qTS(this.environment,{tab:"guests"});break;default:(0,je.t1)(t)}this.stores.spacePermissionsSettingsStore.setState({...this.stores.spacePermissionsSettingsStore.state,currentTab:e})})),l()(this,"handleCreateGroupClick",(()=>{D.H5(this.environment,(e=>{const t=S.mo({spaceStore:this.props.store,transaction:e});t&&this.stores.spacePermissionsSettingsStore.setState({...this.stores.spacePermissionsSettingsStore.state,editingNameGroupId:t.id,groupNameInputValue:""})})),F.O8v(this.environment)})),l()(this,"handleGroupReorder",(e=>{const t=this.props.store.getValue();if(t){const s=t.permission_groups||[],i=p().compact(e.map((e=>s.find((t=>t.id===e)))));D.H5(this.environment,(e=>{S.oD({spaceStore:this.props.store,groups:i,transaction:e})}))}F.HCh(this.environment)})),l()(this,"handleFilterChange",(e=>{this.stores.spacePermissionsSettingsStore.setState({...this.stores.spacePermissionsSettingsStore.state,groupsFilter:e.target.value})})),l()(this,"handleMembersShowMoreClick",(()=>{this.stores.spacePermissionsSettingsStore.setState({...this.stores.spacePermissionsSettingsStore.state,limitMembers:!1})})),l()(this,"handleGuestsShowMoreClick",(()=>{this.stores.spacePermissionsSettingsStore.setState({...this.stores.spacePermissionsSettingsStore.state,limitGuests:!1})})),l()(this,"handleInviteLinkClick",(()=>{const e=!this.getInviteLinkEnabled();F.eoz(this.environment,{enabled:e}),D.H5(this.environment,(t=>{S.ys({transaction:t,spaceStore:this.props.store,inviteLinkEnabled:Boolean(e)})}))})),l()(this,"handleMemberPermissionRoleChange",(async(e,t,s)=>{const{store:i}=this.props,o=this.environment.currentUser.id;if(e.userId===o&&"none"===t){await S.bf({environment:this.environment,spaceId:i.id,userSettingsStore:s})&&Ge.ZP.setState({...Ge.ZP.state,open:!1})}else this.handleUpdateClick(),"none"===t?(await H.XgZ(this.environment,{userIds:[e.userId],spaceId:i.id,removePagePermissions:!0,revokeUserTokens:!0}),await G.bi(this.environment)):await D.H5(this.environment,(s=>g.ep({environment:this.environment,store:i,permissionItems:[{type:"user_permission",role:t,user_id:e.userId}],transaction:s}))),this.handleUpdateComplete()}))}renderComponent(){const{store:e,isMobile:t}=this.props;if(!He.Z.state.online)return this.renderOfflineMessage();const{data:s}=q.Z.state;if(!s)return this.renderLoadingSpinner();const i=K.uF(s);if(!p().every(i.map((t=>M.Z.createChildStore(e,{table:m.KJ,id:t.userId}).isReady()))))return this.renderLoadingSpinner();const o=i.filter(h.CF),n=i.filter(h.du),{currentTab:a}=this.stores.spacePermissionsSettingsStore.state;if(t)return r()(c.Fragment,{},void 0,this.canAdmin()&&r()(_.Z,{shouldShowBottomDivider:!0},void 0,this.renderMobileInviteButton(),r()("div",{style:this.mobileMenuItemStyle()},void 0,this.renderInviteLink())),r()(_.Z,{},void 0,this.renderSpaceMembers(o)));const l=[r()(j._H,{id:"spacePermissionsSettings.membersTab.title",defaultMessage:"Members ({numberOfMembers})",values:{numberOfMembers:o.length}}),r()(j._H,{id:"spaceBasicSettings.groupsTab.title",defaultMessage:"Groups"})];return n.length>0&&l.push(r()(j._H,{id:"spacePermissionsSettings.guestsTab.title",defaultMessage:"Guests ({numberOfGuests})",values:{numberOfGuests:n.length}})),r()(te.Z,{},void 0,r()(ie.Z,{tabs:l,selectedIndex:a,onChange:this.handleTabClick,style:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},tabStyle:{fontSize:16}}),this.renderTab(a,o,n))}renderLoadingSpinner(){return r()(We.Z,{style:{margin:"calc(50% - 1em) auto"}})}renderOfflineMessage(){return r()(Oe.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,r()(j._H,{id:"spacePermissionsSettings.offlineMessage",defaultMessage:"Please go online to manage members."}))}renderHelp(){return r()("div",{style:{marginTop:24,marginBottom:24}},void 0,r()(Ae.Z,{title:r()(j._H,{id:"spacePermissionsSettings.helpButton.caption",defaultMessage:"Learn about adding members to your workspace"}),href:(0,ze.U)("guides.members"),analyticsFrom:"members_settings"}))}renderTab(e,t,s){return e===b.Members?r()(c.Fragment,{},void 0,this.renderSpaceMembers(t)):e===b.Guests?r()(c.Fragment,{},void 0,this.renderSpaceGuests(s)):this.renderGroupsTab()}renderGroupsTab(){const{store:e}=this.props,{groupsFilter:t}=this.stores.spacePermissionsSettingsStore.state,s=e.getValue(),i=this.canUseGroups(),n=this.canEditGroups();if(s){const e=s.permission_groups||[];return r()("div",{},void 0,i?r()(Oe.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"}},void 0,r()(j._H,{id:"spacePermissionsSettings.groupsTab.caption",defaultMessage:"Set up groups to conveniently control page permissions from the share menu."})):r()(qe.Z,{for:"team",from:"permission_groups",icon:z.Z.group,title:r()(j._H,{id:"spacePermissionsSettings.groupsTab.upgradeTitle",defaultMessage:"Upgrade to create groups"}),caption:r()(j._H,{id:"spacePermissionsSettings.groupsTab.upgradeCaption",defaultMessage:"Upgrade to the Team Plan to set up groups and control permissions from the share menu."}),learnMoreRoute:"guides.groups"}),r()(P.Z,{size:24,isHidden:!0}),r()("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},void 0,i&&r()(A.Z,{renderTooltip:()=>this.canAdmin()?r()(j._H,{id:"spacePermissionsSettings.groupsTab.upgradeMessage",defaultMessage:"Upgrade to Team or Enterprise to use permission groups."}):r()(j._H,{id:"spacePermissionsSettings.groupsTab.adminsOnly",defaultMessage:"Only admins can add a permission group."}),render:e=>u().createElement(ke.Z,o()({isLarge:!0,onClick:this.handleCreateGroupClick,disabled:!n},n?void 0:e),r()(j._H,{id:"spacePermissionsSettings.groupsTab.createGroupButton.label",defaultMessage:"Create a group"}))}),e.length>0&&r()($.Z,{placeholder:this.props.intl.formatMessage({id:"spacePermissionsSettings.groupsTab.filterGroupsInput.placeholder",defaultMessage:"Filter by email or name…"}),left:z.Z.searchThick(this.getSearchIconStyle()),showClearButton:!0,format:$.Z.Format.Small,value:t,style:{...Je.filterStyle,marginRight:0},onChange:this.handleFilterChange})),e.length>0&&r()(P.Z,{size:24,style:{marginBottom:24}}),n?r()(Re.Z,{direction:Re.K.Vertical,keys:e.map((e=>e.id)),renderKey:(t,s)=>this.renderSpaceGroup(e[s]),isFullWidth:!0,onDrop:this.handleGroupReorder}):r()("div",{},void 0,e.map(this.renderSpaceGroup)))}}renderSpaceMembers(e){return this.props.isMobile?this.renderMobileMemberList(e):r()("div",{},void 0,!this.shouldRenderUpsell()&&this.renderHelp(),this.shouldRenderUpsell()&&this.renderUpsell(),this.renderInviteLink(),this.renderDesktopMemberList(e))}renderInviteLink(){if(!this.canUseInviteLink())return;const e=this.getInviteLink(),t=this.getInviteLinkEnabled();if(!e)return;const{spacePermissionsSettingsStore:s}=this.stores;return r()("div",{},void 0,r()("div",{style:{display:"flex",alignItems:"flex-start",cursor:"pointer"}},void 0,r()("div",{style:{marginRight:8,flexGrow:1}},void 0,r()(Ke.Z,{},void 0,r()(j._H,{id:"spacePermissionsSettings.spaceMembers.inviteLink.title",defaultMessage:"Invite link"})),r()(Oe.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"85%"}},void 0,r()(j._H,{id:"spacePermissionSettings.spaceMembers.inviteLink.caption",defaultMessage:"Share this secret link to invite people to this workspace. Only admins can see this."})," ",!this.props.isMobile&&this.renderInviteLinkReset())),r()("div",{style:{marginTop:5}},void 0,r()(Ne.Z,{on:t,onClick:this.handleInviteLinkClick}))),s&&t&&e&&this.renderInviteLinkUrl(e),r()(P.Z,{size:40}))}renderInviteLinkReset(){return r()(j._H,{id:"spacePermissionSettings.spaceMembers.inviteLink.resetLink",defaultMessage:"You can <resetlink>reset the link</resetlink> to generate a new invite link.",values:{resetlink:(...e)=>{const{store:t}=this.props,s=t.getValue();if(s)return r()(Ue.Z,{onClick:()=>{R.vC({message:r()(j._H,{id:"spacePermissionsSettings.inviteLinkRefreshModal.description",defaultMessage:"Are you sure you want to reset your invite link? Your old one will no longer be able to be used."}),showCancel:!0,keepFocus:!1,handleCancel:R.lo,items:[{label:r()(j._H,{id:"spacePermissionsSettings.inviteLinkRefreshModal.accept",defaultMessage:"Reset"}),color:"red",onAccept:async()=>{await H.Kdm(this.environment,{spaceId:s.id}),G.bi(this.environment)}}]})}},void 0,e)}}})}renderInviteLinkUrl(e){const{mobileNative:t}=this.environment,s=r()(j._H,{id:"spacePermissionsSettings.spaceMembers.inviteLink.copyButton",defaultMessage:"Copy link"}),i=()=>{Ve.RD({environment:this.environment,stringValue:e}),F.nlj(this.environment)},o=()=>{t&&t.share(e),F.nlj(this.environment)};return this.props.isMobile?r()("div",{},void 0,r()($.Z,{type:"text",format:$.B.Default,value:e,disabled:!0}),t?r()(V.Z,{onClick:o,style:{marginTop:10,width:"100%"}},void 0,r()(j._H,{id:"spacePermissionsSettings.spaceMembers.inviteLink.shareButton",defaultMessage:"Share link"})):r()(V.Z,{onClick:i,style:{marginTop:10,width:"100%"}},void 0,s)):r()("div",{},void 0,r()("div",{style:{display:"flex",alignItems:"flex-start",marginTop:12}},void 0,r()($.Z,{type:"text",format:$.B.Default,value:e,disabled:!0,style:{borderTopRightRadius:0,borderBottomRightRadius:0,width:"calc(100% - 90px)",height:32}}),r()(ke.Z,{onClick:i,style:{borderTopLeftRadius:0,borderBottomLeftRadius:0,width:90},isLarge:!0},void 0,s)))}renderMobileMemberList(e){const{store:t}=this.props;return r()(c.Fragment,{},void 0,e.map((e=>{const s=M.Z.createChildStore(t,{table:m.KJ,id:e.userId}).getValue();return r()("div",{style:{display:"flex",alignItems:"center",padding:10,borderBottom:"1px solid ".concat(this.theme.lightDividerColor),background:this.theme.contentBackground}},void 0,this.renderMember(s),r()("div",{style:{textAlign:"center",marginLeft:"auto"}},void 0,this.renderUserPermission(e)))})))}renderUpsell(){const{data:e}=q.Z.state,t=e&&!K.Ln(this.environment,e)&&"subscribed_admin"!==e.type?"team_free":"team";return u().createElement(u().Fragment,null,r()(qe.Z,{for:t,from:"members_settings",icon:z.Z.membersFilled,title:r()(j._H,{id:"spacePermissionSettings.memberUpsell.title",defaultMessage:"Share with unlimited members"}),caption:r()(j._H,{id:"spacePermissionSettings.memberUpsell.caption",defaultMessage:"Try Notion for Teams for a collaborative workspace, unlimited team members, and advanced permissions."}),learnMoreRoute:"guides.members",upgradeMessage:r()(j._H,"team_free"===t?{id:"spacePermissionSettings.memberUpsell.alternativeTrialLabel",defaultMessage:"Try it free"}:{id:"spacePermissionSettings.memberUpsell.alternativeUpgradeLabel",defaultMessage:"Upgrade to Team Plan"})}),r()(P.Z,{size:48}))}renderDesktopMemberList(e){const{spacePermissionsSettingsStore:t}=this.stores,{membersFilter:s,limitMembers:i}=t.state,o=this.getFilteredMembers(e,s),n=i?o.slice(0,Je.defaultLimit):o;return r()(u().Fragment,{},void 0,r()("div",{style:{marginRight:8,flexGrow:1}},void 0,r()(Ke.Z,{},void 0,r()(j._H,{id:"spacePermissionsSettings.spaceMembers.members.title",defaultMessage:"Members"}))),this.renderInviteViaDomainCaption(),r()(P.Z,{size:16,isHidden:!0}),r()("div",{},void 0,r()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}},void 0,this.renderInviteButton(),r()($.Z,{placeholder:this.props.intl.formatMessage({id:"spacePermissionsSettings.membersTab.filterMembersInput.placeholder",defaultMessage:"Filter by email or name…"}),left:z.Z.searchThick(this.getSearchIconStyle()),showClearButton:!0,format:$.Z.Format.Small,value:s,style:Je.filterStyle,onChange:e=>{t.setState({...t.state,membersFilter:e.target.value,limitMembers:!0})}})),this.renderUserTable(n),o.length>Je.defaultLimit&&i&&r()(De.Z,{style:Je.showMoreButtonStyle,onClick:this.handleMembersShowMoreClick},void 0,r()(j._H,{defaultMessage:"Show {moreMembersCount} more",id:"spacePermissionsSettings.membersTab.showMore.message",values:{moreMembersCount:o.length-Je.defaultLimit}}))))}renderSpaceGuests(e){const{spacePermissionsSettingsStore:t}=this.stores,{guestsFilter:s,limitGuests:i}=t.state,o=this.getFilteredMembers(e,s),n=i?o.slice(0,Je.defaultLimit):o;return r()("div",{},void 0,r()("div",{},void 0,r()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}},void 0,r()($.Z,{placeholder:this.props.intl.formatMessage({id:"spacePermissionsSettings.membersTab.filterGuestsInput.placeholder",defaultMessage:"Filter by email or name…"}),left:z.Z.searchThick(this.getSearchIconStyle()),showClearButton:!0,format:$.Z.Format.Small,value:s,style:Je.filterStyle,onChange:e=>{t.setState({...t.state,guestsFilter:e.target.value,limitGuests:!0})}})),this.renderUserTable(n),o.length>Je.defaultLimit&&i&&r()(De.Z,{style:Je.showMoreButtonStyle,onClick:this.handleGuestsShowMoreClick},void 0,r()(j._H,{id:"spacePermissionsSettings.membersTab.showMoreGuestsButton.label",defaultMessage:"{numberOfHiddenGuests, plural, one {Show {numberOfHiddenGuests} more} other {Show {numberOfHiddenGuests} more}}",values:{numberOfHiddenGuests:o.length-Je.defaultLimit}}))))}renderMobileInviteButton(){return r()(c.Fragment,{},void 0,r()("div",{style:this.mobileMenuItemStyle()},void 0,this.renderInviteButton({flex:1})),r()("div",{style:{borderBottom:"1px solid ".concat(this.theme.regularDividerColor)}}))}renderInviteButton(e){const{store:t}=this.props;return r()(Ye.Mc,{disabled:!this.canAdmin(),store:t,onInviteClick:this.handleUpdateClick,onInviteComplete:this.handleUpdateComplete,isSubscribed:this.isSubscribed(),membersOnly:!1,upgradeButtonName:"space_permission_settings",shouldGrow:!1,buttonStyle:e})}renderInviteViaDomainCaption(){const{store:e}=this.props,t=S.LV(e);return r()(Oe.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"}},void 0,r()(j._H,t?{id:"spaceBasicSettings.membersTab.manageMembersWithLinkCaption",defaultMessage:"Manage members here."}:{id:"spaceBasicSettings.membersTab.manageMembersWithoutLinkCaption",defaultMessage:"Manage members here, or <setupdomainlink>set up a domain</setupdomainlink>, so everyone with allowed email domains can join the workspace automatically.",values:{setupdomainlink:(...e)=>r()(Ue.Z,{onClick:()=>{Ge.ZP.setState({...Ge.ZP.state,currentTab:"settings"})}},void 0,e)}}))}getFilteredMembers(e,t){const{store:s}=this.props;return t&&t.length>0?(0,v.ZP)(t,e,(e=>{const t=M.Z.createChildStore(s,{table:m.KJ,id:e.userId}).getValue();return t?(0,m.of)(t):""})):e}renderUserTable(e){const{store:t}=this.props;return r()(se.Z,{columns:[{key:"user",header:r()(j._H,{id:"spacePermissionsSettings.userTable.userColumn.header",defaultMessage:"User"}),style:{width:"75%"}},{key:"access_level",header:r()(j._H,{id:"spacePermissionsSettings.userTable.accessLevelColumn.header",defaultMessage:"Access level"}),style:{width:"25%",textAlign:"center"}}],rows:e.map((e=>{const s=M.Z.createChildStore(t,{table:m.KJ,id:e.userId}).getValue();return{key:e.userId,columns:[this.renderMember(s),r()("div",{style:{textAlign:"center"}},void 0,this.renderUserPermission(e))]}}))})}renderMember(e){if(e)return r()("div",{style:{display:"flex",alignItems:"center",maxWidth:300}},void 0,r()(Fe.Z,{userValue:e,size:28}),r()("div",{style:{minWidth:0,marginLeft:6,marginRight:6}},void 0,r()(Oe.Z,{className:"notranslate"},void 0,(0,m.Nz)(this.props.intl,e)),r()(Oe.Z,{isSmall:!0},void 0,e.email)))}renderUserPermission(e){return"none"===e.role?r()(Q,{store:this.props.store,guest:e,isSubscribed:this.isSubscribed()}):this.renderMemberRoleSelect(e)}renderMemberRoleSelect(e){const t=this.environment.currentUser.id,{currentUserSettingsStore:s}=Ie.Z.state;if(s)return r()(ee.Z,{role:e.role,table:oe.bx,type:"user_permission",disabled:!this.canAdmin(),isUserPermission:e.userId===t,isSubscribed:this.isSubscribed(),upgradeButtonName:"space_permission_item",onChange:t=>this.handleMemberPermissionRoleChange(e,t,s)})}isSubscribed(){const{data:e}=q.Z.state;return Boolean(e&&K.YK(e))}canAdmin(){return this.props.store.canAdmin()}canUseGroups(){return K.qF(this.environment)&&this.isSubscribed()}canEditGroups(){return this.canUseGroups()&&this.canAdmin()}canUseInviteLink(){return this.canAdmin()&&K.qF(this.environment)}shouldRenderUpsell(){const e=this.props.store.getValue();return Boolean(e&&"personal"===e.plan_type&&this.canAdmin())}getInviteLinkEnabled(){const e=this.props.store.getValue();return Boolean(e&&e.invite_link_enabled)}getInviteLink(){const e=q.Z.state.data,t=this.props.store.getValue(),s=!e||"subscribed_admin"!==e.type&&"unsubscribed_admin"!==e.type?void 0:e.inviteLinkCode;if(t&&s)return(0,Xe.getSpaceInviteLinkUrl)(this.environment,t,s)}getSearchIconStyle(){return{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:this.theme.mediumIconColor}}mobileMenuItemStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",paddingTop:14,paddingBottom:14,paddingLeft:14,paddingRight:e.getSafePaddingRightCSS(14),background:this.theme.contentBackground}}}l()(Je,"defaultLimit",50),l()(Je,"filterStyle",{width:180,borderRadius:30}),l()(Je,"showMoreButtonStyle",{marginTop:8});const Qe=(0,j.XN)(Je)},42982:(e,t,s)=>{s.d(t,{Z:()=>u});var i=s(98135),o=s.n(i),n=(s(67294),s(5366)),r=s(66832),a=s(47966),l=s(23189),d=s(46951),p=s(86512);class c extends r.Z{renderComponent(){return o()("div",{},void 0,this.renderHeader(),o()("div",{style:this.getSettingsOptionStyle()},void 0,o()(d.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,this.renderMessage()),this.renderManageSubscriptionButton()))}renderHeader(){const{device:e}=this.environment;return o()(l.Z,{large:!e.isMobile||void 0,divider:e.isMobile?void 0:"full"},void 0,o()(n._H,{id:"subscriptionSettings.title",defaultMessage:"Subscription"}))}renderMessage(){const{device:e}=this.environment;return e.isMobile?o()(n._H,{id:"subscriptionSettings.mobileDescription",defaultMessage:"Manage your Personal Pro subscription though the App Store.",description:"Description for a button that will take users to Apple's App Store app to edit their subscription."}):o()(n._H,{id:"subscriptionSettings.description",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. You can manage your subscription in Apple's subscription settings.",description:"Description for a button that will take users to Apple's App Store app to edit their subscription."})}renderManageSubscriptionButton(){return o()(p.Z,{href:"https://apps.apple.com/account/subscriptions"},void 0,o()(a.Z,{isLarge:!0,style:{marginTop:12,marginBottom:4}},void 0,o()(n._H,{id:"subscriptionSettings.button",defaultMessage:"Manage subscription"})))}getSettingsOptionStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto",paddingLeft:e.isMobile?t.state.paddingLeftCSS:0,paddingRight:e.isMobile?t.state.paddingRightCSS:0}}}const u=c},46034:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(59713),o=s.n(i),n=(s(33948),s(66832));class r extends n.Z{constructor(...e){super(...e),o()(this,"touchX",void 0),o()(this,"handleTouchStart",(e=>{this.touchX=e.touches[0].clientX})),o()(this,"handleTouchMove",(e=>{if(void 0===this.touchX)return;const t=this.props.threshold||120,s=this.touchX-e.touches[0].clientX;s>t&&this.props.onSwipeLeft&&(this.props.onSwipeLeft(),this.touchX=void 0),s<-1*t&&this.props.onSwipeRight&&(this.props.onSwipeRight(),this.touchX=void 0)})),o()(this,"handleTouchEnd",(()=>{this.touchX=void 0})),o()(this,"handleTouchCancel",(()=>{this.touchX=void 0}))}renderComponent(){return this.props.render({onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,onTouchEnd:this.handleTouchEnd,onTouchCancel:this.handleTouchCancel})}}const a=r},66957:(e,t,s)=>{s.d(t,{Z:()=>h});var i=s(98135),o=s.n(i),n=s(59713),r=s.n(n),a=s(67294),l=s.n(a),d=s(66832),p=s(95009),c=s(42001);class u extends d.Z{renderComponent(){const{device:e}=this.environment;return o()("div",{style:{...this.environment.device.isMobile?this.getMobileStyle():this.getDesktopStyle(),...this.props.style}},void 0,this.props.tabs.map(((t,s)=>{const i=s===this.props.selectedIndex;return o()(l().Fragment,{},s,o()("div",{style:{...i?this.getSelectedTabStyle():this.getTabStyle()}},s,o()(c.Z,{style:this.props.tabStyle,onClick:()=>this.props.onChange(s),disabled:this.props.readOnly,mobileFeedback:e.isMobile},void 0,t),i&&o()("div",{style:this.getBorderStyle()})),this.props.separatorIndexes&&this.props.separatorIndexes.includes(s)&&o()("div",{style:this.getSeparatorStyle(),className:"notranslate"},"".concat(s,"-separator"),"|"))})),o()("div",{style:{flexGrow:1,display:"flex",alignItems:"center",justifyContent:"flex-end",color:this.theme.mediumTextColor}},void 0,this.props.right))}getDesktopStyle(){return{display:"flex",fontSize:14,width:"100%",paddingLeft:8,paddingRight:8,boxShadow:"0 1px 0 ".concat(this.theme.regularDividerColor),position:"relative",zIndex:1}}getSeparatorStyle(){return{display:"inline-flex",alignItems:"center",margin:"0 4px",paddingBottom:4,whiteSpace:"nowrap",minWidth:0,flexShrink:0,color:this.theme.regularDividerColor}}getMobileStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",fontSize:16,width:"100%",paddingTop:2,paddingLeft:this.context.menuType!==p.og.Popup?e.getSafePaddingLeftCSS(16):16,paddingRight:this.context.menuType!==p.og.Popup?e.getSafePaddingRightCSS(16):16,boxShadow:"0 1px 0 ".concat(this.theme.regularDividerColor),position:"relative",zIndex:2,height:44,background:this.theme.popoverBackground}}getTabStyle(){return{paddingTop:6,paddingBottom:6,whiteSpace:"nowrap",minWidth:0,flexShrink:0,color:this.theme.mediumTextColor}}getSelectedTabStyle(){return{...this.getTabStyle(),position:"relative",color:this.theme.regularTextColor}}getBorderStyle(){return{borderBottom:"2px solid ".concat(this.theme.regularTextColor),position:"absolute",bottom:-1,left:8,right:8}}}r()(u,"contextTypes",{...p.ff});const h=u},40235:(e,t,s)=>{s.d(t,{Z:()=>c});var i=s(98135),o=s.n(i),n=s(59713),r=s.n(n),a=(s(67294),s(66832)),l=s(46951),d=s(82990);class p extends a.Z{renderComponent(){const{columns:e,rows:t}=this.props;return o()("table",{style:this.getStyle()},void 0,o()("thead",{},void 0,o()("tr",{style:p.headerRowStyle},void 0,e.map((e=>o()("th",{style:{...p.tableHeaderStyle,...e.style}},e.key,o()(l.Z,{isSmall:!0},void 0,e.header)))))),o()("tbody",{},void 0,t.map((t=>o()("tr",{style:this.getRowStyle()},t.key,t.columns.map(((t,s)=>{const i=e[s];return o()("td",{style:p.cellStyle},i.key,t)})))))))}getStyle(){return{width:"100%",fontSize:13,borderTop:"1px solid ".concat(this.theme.regularDividerColor),borderBottom:"1px solid ".concat(this.theme.regularDividerColor)}}getRowStyle(){return{width:"100%",borderTop:"1px solid ".concat(this.theme.regularDividerColor)}}}r()(p,"cellPaddingTopBottom",8),r()(p,"headerRowStyle",{height:32,width:"100%"}),r()(p,"tableHeaderStyle",{fontWeight:d.Z.fontWeight.regular,textAlign:"left",paddingTop:p.cellPaddingTopBottom,paddingBottom:p.cellPaddingTopBottom}),r()(p,"cellStyle",{paddingTop:p.cellPaddingTopBottom,paddingBottom:p.cellPaddingTopBottom});const c=p},92933:(e,t,s)=>{s.d(t,{Z:()=>Ie});var i=s(67154),o=s.n(i),n=s(98135),r=s.n(n),a=s(59713),l=s.n(a),d=(s(33948),s(67294)),p=s.n(d),c=s(73935),u=s.n(c),h=s(17504),m=s(51454),g=s(1449),S=s(66832),v=s(53786),y=s(22789),b=s(48601),f=s(47590),w=s(62442),M=s(3779),Z=s(76668),P=s(76487),C=s(12534),k=s(13548),x=s(37235),T=s(94610),I=s(39849),B=s(7755),L=s(80527),_=s(43250),E=s(5366);class R extends S.Z{constructor(...e){super(...e),l()(this,"handlePlusIconMouseEnter",(e=>{(0,C.ZP)({event:e,context:C.Af.SidebarMouseMove,callback:()=>{Z.bA()}})}))}renderComponent(){return r()("div",{style:this.getStyle(),onMouseEnter:this.handlePlusIconMouseEnter,onMouseMove:this.handlePlusIconMouseEnter},void 0,r()("div",{style:{position:"relative"}},void 0,this.renderMenuButton(),this.renderExpandButton()))}renderMenuButton(){const e=P.Z.getTotalUnreadMentionsCount();return r()(k.Z,{isVisible:!0,animationStyle:{opacity:B.TC.state?0:1},render:()=>r()("div",{style:R.buttonWrapStyle},void 0,r()("div",{style:R.buttonStyle},void 0,M.Z.hamburgerMenu(this.getSvgStyle()),r()(I.Z,{color:I.Z.Color.Red,count:e,style:{position:"absolute",top:-1,right:-4}})))})}renderExpandButton(){return r()(k.Z,{isVisible:!0,animationStyle:{opacity:B.TC.state?1:0},render:()=>r()("div",{style:R.buttonWrapStyle},void 0,r()(x.Z,{renderTooltip:()=>r()("div",{},void 0,r()("div",{},void 0,r()(E._H,{defaultMessage:"Lock sidebar open",id:"sidebarExpandButton.tooltip"})),r()(T.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleSidebar"})),placement:x.Z.Placement.Right,alignment:x.Z.Alignment.Start,delayThreshold:0,originGap:6,render:e=>p().createElement(L.Z,o()({icon:M.Z.doubleChevronRight,style:{position:"relative"},isDarkIconColor:!0,onClick:()=>Z.lE({environment:this.environment,isExpanded:!0}),className:_.ex},e))}))})}getStyle(){return{flexShrink:0,width:48,height:48,margin:-12,padding:12,marginRight:-6}}getSvgStyle(){return{width:16,height:16,fill:this.theme.regularIconColor}}}l()(R,"buttonStyle",{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:3}),l()(R,"buttonWrapStyle",{position:"absolute",top:0,left:0,willChange:"opacity"});const H=R;var G=s(84908),U=s(27832),D=s(66708),A=s(52258),O=s(52016);class F extends O.Z{getInitialState(){return{isFullScreen:!1}}constructor(){super(),l()(this,"updateFromElectronState",(()=>{const e=G.Gr.get();void 0!==e&&this.setState({isFullScreen:e})})),G.Gr.addListener(this.updateFromElectronState),this.updateFromElectronState()}}const N=new F;var V=s(71802),W=s(67669),z=s(42001),K=s(87531),q=s(3297),j=s(29974),Y=s(2107),X=s(89101),J=s(65598),Q=s(95477),$=s(45094),ee=s(96026),te=s(47307),se=s(47966),ie=s(15517),oe=s(50906),ne=s(84122),re=s(38978),ae=s(85419),le=s(13612),de=s(84210),pe=s(51),ce=s(97148),ue=s(97880),he=s(4615),me=s(64002),ge=s(11819),Se=s(43803),ve=s(5111),ye=s(96677),be=s(64658),fe=s(77503),we=s(58879),Me=s(89940),Ze=s(29538),Pe=s(31792),Ce=s(7011),ke=s(64215);function xe(e){const t=(0,we.O7)(),{device:s}=t,{store:i,spaceStore:o,pageVisitStore:n,presenceStore:a,collectionViewStore:l,spaceViewStore:p}=e,c=(0,Me.VK)((()=>i.canEdit()),[i]),[u,h]=(0,Me.oR)(void 0,Pe.Z),[g,S]=(0,d.useState)(!1),[v]=(0,Me.oR)(Ce.ZP),y=(0,Me.VK)((()=>(0,$.Sx)(t)),[t]);(0,d.useEffect)((()=>{S(!y)}),[y]);const{canShowUpdateSidebarUnexpander:b,shouldShowUpdateSidebarUnexpander:f}=(0,Me.VK)((()=>{const e=!g&&y&&!(0,$._c)(t);return{canShowUpdateSidebarUnexpander:e,shouldShowUpdateSidebarUnexpander:e&&(v.mouseEntered||u.mouseEntered)}}),[g,y,t,u,v]),[w]=(0,Me.oR)(Ce.ZP),P=(0,Me.Kw)(V.tu),C=(0,ke.y)((()=>({actionButtonsWrapStyle:{flexGrow:0,flexShrink:0,display:"flex",alignItems:"center",paddingRight:s.isMobile?4:10,paddingLeft:s.isMobile?4:10,width:b?w.width:void 0,justifyContent:"space-between",zIndex:m.A_,height:Ie.getTopbarHeight(t),opacity:P?0:1,transition:"\n\t\t\t\t\topacity ".concat(Ie.transitionDuration,"ms,\n\t\t\t\t\tcolor ").concat(Ie.transitionDuration,"ms\n\t\t\t\t")},rightButtonsContainer:{display:"flex"}})),[b,s,w,t,P]);if(e.isInvalidPage)return null;return r()("div",{style:C.actionButtonsWrapStyle,onMouseMove:()=>{h({...u,mouseEntered:!0})},onMouseLeave:()=>{h({...u,mouseEntered:!1})},className:_.A_},void 0,r()(Ze.C,{shouldHide:s.isElectronMac&&V.tu.state||!b||!f||v.isAnimating,icon:M.Z.doubleChevronRight,caption:r()(E._H,{defaultMessage:"Close sidebar",id:"updateSidebarUnexpandButton.closeSidebar.tooltip"}),onClick:()=>{S(!0),Z.EG({environment:t,isExpanded:!1})},keyboardShortcutName:"toggleSidebar"}),r()("div",{style:C.rightButtonsContainer},void 0,c&&n&&a&&r()(ge.Z,{rootStore:i,pageVisitStore:n,presenceStore:a}),r()(ve.Z,{store:i,buttonPopupStore:D.Z}),!s.isMobile&&r()(be.Z,{blockStore:i,spaceStore:o,buttonPopupStore:fe.Z}),r()(ye.Z,{store:i,spaceViewStore:p}),!s.isMobile&&r()(Se.Z,{store:i,collectionViewStore:l,buttonPopupStore:A.Z})))}class Te extends S.Z{constructor(...e){super(...e),l()(this,"startedInitialPublicPageEdit",!1),l()(this,"handleDoubleClickTopbar",(e=>{e.target===e.currentTarget&&(0,C.ZP)({event:e,context:C.Af.EditorDoubleClick,callback:G.Gx})})),l()(this,"maybeOpenOnBaseUrl",(()=>{var e;const{RouterStore:t}=this.environment,s=t.state.route,i=null===(e=this.pageContext)||void 0===e?void 0:e.pageStore;if("page"===s.name&&s.requestedOnPublicDomain&&i){const e=(0,de.Z)({store:i,preferPublicLink:!1});return Y.Li({environment:this.environment,url:e}),!0}return!1})),l()(this,"handleStartPublicEdit",(()=>{this.maybeOpenOnBaseUrl()||(this.environment.currentUser.isLoggedIn()?(0,te.vC)({showCancel:!0,keepFocus:!1,message:r()(E._H,{defaultMessage:"When you start editing, your name, email and photo will be visible to the page owners.",id:"topbar.startPublicEditDialog.message"}),items:[{label:r()(E._H,{defaultMessage:"Continue",id:"topbar.startPublicEditDialog.continueLabel"}),color:"blue",onAccept(){ee.Z.setState({editing:!0})}}]}):((0,ie.Hr)({currentUserId:this.environment.currentUser.id,blockId:this.props.store.id}),Y.Li({environment:this.environment,url:X._j.login})))})),l()(this,"handleAttemptPublicComment",(()=>{(0,ie.Hr)({currentUserId:this.environment.currentUser.id,blockId:this.props.store.id}),this.maybeOpenOnBaseUrl()||Y.Li({environment:this.environment,url:X._j.login})})),l()(this,"forkPageRef",null),l()(this,"handleForkPageRef",(e=>{this.forkPageRef=e})),l()(this,"handleOpenQuickFind",(()=>{K.UT({environment:this.environment,analyticsFrom:"public-page-topbar"})})),l()(this,"handleOpenForkPage",(()=>{q.S({environment:this.environment,store:this.props.store,originRect:this.getDuplicateClientRect()})})),l()(this,"handleClickNotion",(()=>{const{currentUserRootStore:e,currentUserSettingsStore:t}=U.Z.state;if(oe.T3Y(this.environment),e&&t)j.L5({environment:this.environment,userRootStore:e,userSettingsStore:t});else{const e={utm_source:"public_page",utm_content:"topbar_cta"},{currentBlockStore:t}=U.Z.state;null!=t&&t.id&&(e.utm_campaign=(0,he.F9)(null==t?void 0:t.id));const s=(0,me.SK)(X._j.login,e);Y.Li({environment:this.environment,url:s})}})),l()(this,"appRenderState",this.createComputedStore((()=>V.h1(this.environment))))}didUpdate(){const{store:e}=this.props,{RouterStore:t}=this.environment,s=t.state.route,{publicPageData:i}=pe.Z.state;this.isReady()&&e.canEdit()&&!ee.Z.state.editing&&"page"===s.name&&!s.requestedOnPublicDomain&&this.shouldRenderPublicPageTopbar()&&!this.startedInitialPublicPageEdit&&null!=i&&i.requireLogin&&(this.startedInitialPublicPageEdit=!0,this.handleStartPublicEdit())}renderComponent(){return(0,h.Z)((e=>p().createElement("div",o()({style:this.getWrapStyle()},e),r()("div",{style:this.getStyle(),className:_.lI},void 0,this.isReady()&&(this.shouldRenderPublicPageTopbar()?this.renderPublicPageTopbar():this.renderDefaultTopbar())),r()(b.Z,{banners:this.props.banners,isMobile:!1}))))}renderPublicPageTopbar(){const{device:e}=this.environment,{store:t,isInvalidPage:s,isElectron:i}=this.props;return r()("div",{style:this.getContainerStyle(),onDoubleClick:this.handleDoubleClickTopbar},void 0,i&&r()(w.Z,{}),!s&&r()(g.Z,{store:t,style:Te.breadcrumbStyle,maxAncestorCount:2,ancestorMaxWidth:160,currentPageMaxWidth:240,showCurrentPageControls:!0,isMobile:!1}),r()("div",{style:{flexGrow:1,flexShrink:1}}),t.canEdit()&&!ee.Z.state.editing&&r()(se.Z,{onClick:this.handleStartPublicEdit,style:{marginRight:8,padding:"0 8px"}},void 0,M.Z.pencil(Te.topbarIconStyle),r()(E._H,{id:"topbar.publicPage.edit",defaultMessage:"Edit"})),!this.environment.currentUser.isLoggedIn()&&t.canComment()&&!t.canEdit()&&r()(se.Z,{onClick:this.handleAttemptPublicComment,style:{marginRight:8,padding:"0 8px"}},void 0,M.Z.speechBubbleThin(Te.topbarIconStyle),r()(E._H,{id:"topbar.publicPage.comment",defaultMessage:"Comment"})),r()(z.Z,{onClick:this.handleOpenQuickFind},void 0,M.Z.searchThick(Te.topbarIconStyle),r()(E._H,{defaultMessage:"Search",id:"topbar.publicPage.searchButton.label"})),(0,W.S4)(this.props.store)&&p().createElement(z.Z,{onClick:this.handleOpenForkPage,ref:this.handleForkPageRef},r()(E._H,{defaultMessage:"Duplicate",id:"topbar.publicPage.duplicateButton.label"})),!e.isMobile&&!s&&r()(le.Z,{store:t,buttonPopupStore:A.Z}),r()("div",{style:this.getPublicPageTopbarDividerStyle()}),r()(z.Z,{onClick:this.handleClickNotion},void 0,M.Z.notionLogo(Te.notionLogoStyle),this.renderCtaFormattedMessage()))}renderDefaultTopbar(){const{store:e,isInvalidPage:t,isElectron:s,showSidebarButton:i,collectionViewStore:o}=this.props,{isMobile:n}=this.environment.device,{pageVisitStore:a,presenceStore:l,currentSpaceStore:d,currentSpaceViewStore:p}=U.Z.state,c=(0,W.IJ)(this.environment,this.props.store);return r()(f.Z,{store:e,disableRectangularSelection:!0,disableEditNearestBlock:!0,render:()=>r()("div",{style:this.getContainerStyle(),onDoubleClick:this.handleDoubleClickTopbar},void 0,i&&r()(H,{}),s&&r()(w.Z,{}),!t&&r()(g.Z,{store:e,style:Te.breadcrumbStyle,maxAncestorCount:2,ancestorMaxWidth:160,currentPageMaxWidth:240,showCurrentPageControls:!0,isMobile:!1}),e.canEdit()&&r()(y.Z,{store:e,isMobile:!1},e.id),e.isRestricted()&&r()(ne.Z,{style:{marginRight:10},onClick:()=>{D.Z.setState({open:!0})}}),!t&&r()(v.Z,{}),r()("div",{style:{flexGrow:1,flexShrink:1}}),!n&&!c&&r()(xe,{store:e,collectionViewStore:o,spaceStore:d,spaceViewStore:p,pageVisitStore:a,presenceStore:l,isInvalidPage:t}))})}renderCtaFormattedMessage(){const e=ce.Z.getGroup(this.environment,"public-page-cta");switch(e){case"get":return r()(E._H,{defaultMessage:"Get Notion",id:"topbar.publicPage.cta.label.get"});case"try":return r()(E._H,{defaultMessage:"Try Notion",id:"topbar.publicPage.cta.label.try"});case"try-free":return r()(E._H,{defaultMessage:"Try Notion Free",id:"topbar.publicPage.cta.label.try-free"});case"control":return r()(E._H,{defaultMessage:"Notion",id:"topbar.publicPage.cta.label"});default:(0,ue.t1)(e)}}getDuplicateClientRect(){if(this.forkPageRef){const e=u().findDOMNode(this.forkPageRef);if(e instanceof Element)return e.getBoundingClientRect()}}isReady(){const e=(0,J.Oh)(this.props.store),{id:t}=this.environment.currentUser,s=t?re.Z.createChildStore(this.props.store,{table:ae.KJ,id:t}):void 0,i=!s||s.isReady();return e&&i}shouldRenderPublicPageTopbar(){return!Q.Z.isAdminMode&&(0,W.IJ)(this.environment,this.props.store)}getWrapStyle(){return{maxWidth:"100vw",zIndex:m.lI,background:this.theme.contentBackground,WebkitUserSelect:"none",userSelect:"none"}}static getTopbarHeight(e){const{device:t}=e;return t.isElectronMac?Te.desktopMacHeight:Te.defaultHeight}getStyle(){return{width:"100%",maxWidth:"100vw",height:Te.getTopbarHeight(this.environment),opacity:V.tu.state?0:1,transition:"\n\t\t\t\topacity ".concat(Te.transitionDuration,"ms,\n\t\t\t\tcolor ").concat(Te.transitionDuration,"ms\n\t\t\t"),position:"relative"}}getContainerStyle(){const{device:e}=this.environment,t=e.isElectronMac&&(!this.appRenderState.state.shouldShowSidebar||!(0,$.in)(this.environment))&&!N.state.isFullScreen;return{display:"flex",justifyContent:"space-between",alignItems:"center",overflow:"hidden",height:Te.getTopbarHeight(this.environment),paddingLeft:t?Te.paddingLeftWhenDesktopSidebarClose:e.isMobile?4:12,paddingRight:e.isMobile?4:10}}getPublicPageTopbarDividerStyle(){return{flex:"none",width:1,height:16,marginLeft:8,marginRight:8,background:this.theme.darkDividerColor}}}l()(Te,"defaultHeight",45),l()(Te,"desktopMacHeight",37),l()(Te,"paddingLeftWhenDesktopSidebarClose",73),l()(Te,"transitionDuration",700),l()(Te,"breadcrumbStyle",{height:"100%",flexGrow:0,marginRight:8,fontSize:14,minWidth:0}),l()(Te,"topbarIconStyle",{width:14,height:14,marginRight:6}),l()(Te,"notionLogoStyle",{width:18,height:18,marginRight:6});const Ie=Te},62442:(e,t,s)=>{s.d(t,{Z:()=>P});var i=s(98135),o=s.n(i),n=s(67154),r=s.n(n),a=s(59713),l=s.n(a),d=(s(33948),s(67294)),p=s.n(d),c=s(3779),u=s(2107),h=s(66832),m=s(94610),g=s(37235),S=s(87953),v=s(50906),y=s(80527),b=s(5366),f=s(14947),w=s(15692),M=s(88923);class Z extends h.Z{constructor(...e){super(...e),l()(this,"renderDesktopButtons",(()=>o()(S.Z,{capture:!0,render:e=>p().createElement("div",r()({style:{display:"flex",flexShrink:0}},e),this.renderBackButton(),this.renderForwardButton())}))),l()(this,"handleBackClick",(()=>{v.MEX(this.environment,{type:"back"}),u.op()})),l()(this,"handleForwardClick",(()=>{v.MEX(this.environment,{type:"forward"}),u.eH()}))}renderComponent(){return this.environment.device.isMobile?this.renderMobile():this.renderDesktop()}renderDesktop(){return o()(w.ZP,{style:{background:"transparent",borderRadius:0,boxShadow:"none"},origin:this.renderDesktopButtons(),render:this.renderDesktopButtons,placementToOrigin:w.ZP.Placement.Center,alignmentToOrigin:w.ZP.Alignment.Center,open:M.ZP.state.open,disableMouseCapture:!0,preventCaptureEsc:!0,preventScaleTransition:!0,preventOpacityTransition:!0,popupType:w.ZP.PopupType.Popup})}renderBackButton(){const{RouterStore:e}=this.environment;return o()(g.Z,{renderTooltip:()=>o()("div",{style:{display:"flex"}},void 0,o()(b._H,{id:"topbarBrowserHistoryButtons.goBackButton.label",defaultMessage:"Go back"}),o()(m.Z,{name:"goBack",style:{opacity:.5,marginLeft:4}})),placement:g.Z.Placement.Bottom,alignment:g.Z.Alignment.Center,originGap:6,render:t=>p().createElement(y.Z,r()({icon:c.Z.historyBack,isDarkIconColor:!0,className:"notion-history-back-button",disabled:!e.canGoBack(),style:{position:"relative"},onClick:this.handleBackClick},t))})}renderForwardButton(){const{RouterStore:e}=this.environment;return o()(g.Z,{renderTooltip:()=>o()("div",{style:{display:"flex"}},void 0,o()(b._H,{id:"topbarBrowserHistoryButton.goForwardButton.label",defaultMessage:"Go forward"}),o()(m.Z,{name:"goForward",style:{opacity:.5,marginLeft:4}})),placement:g.Z.Placement.Bottom,alignment:g.Z.Alignment.Center,originGap:6,render:t=>p().createElement(y.Z,r()({icon:c.Z.historyForward,isDarkIconColor:!0,className:"notion-history-forward-button",disabled:!e.canGoForward(),style:{position:"relative"},onClick:this.handleForwardClick},t))})}renderMobile(){return o()(S.Z,{capture:!0,render:e=>p().createElement("div",r()({style:{display:"flex",flexShrink:0,height:"100%",paddingLeft:4,paddingRight:4}},e),this.renderMobileBackButton(),this.renderMobileForwardButton())})}renderMobileBackButton(){const{RouterStore:e}=this.environment,t=!e.canGoBack();return o()(f.Z,{onClick:this.handleBackClick,className:"notion-history-back-button",disabled:t,disabledFeedback:!0,mobileFeedback:!0,style:Z.mobileButtonStyle},void 0,c.Z.historyBack({width:16,height:16}))}renderMobileForwardButton(){const{RouterStore:e}=this.environment,t=!e.canGoForward();return o()(f.Z,{onClick:this.handleForwardClick,className:"notion-history-forward-button",disabled:t,mobileFeedback:!0,disabledFeedback:!0,style:Z.mobileButtonStyle},void 0,c.Z.historyForward({width:16,height:16}))}}l()(Z,"mobileButtonStyle",{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:32});const P=Z},53786:(e,t,s)=>{s.d(t,{Z:()=>x});var i=s(67154),o=s.n(i),n=s(98135),r=s.n(n),a=s(59713),l=s.n(a),d=(s(33948),s(67294)),p=s.n(d),c=s(96486),u=s.n(c),h=s(66832),m=s(68932),g=s(37235),S=s(45023),v=s(88632),y=s(99757),b=s(46167),f=s(42001),w=s(95009),M=s(32056),Z=s(3779),P=s(15517),C=s(5366);class k extends h.Z{constructor(...e){super(...e),l()(this,"fakeSync",!1),l()(this,"realSync",!1),l()(this,"handleKeyDown",(e=>{if((0,S.Z)(this.environment,e,"command+s")){e.preventDefault();!v.Z.state.online||this.fakeSync||y.n.state||(this.fakeSync=!0,this.enqueueForceUpdate(),setTimeout((()=>{this.fakeSync=!1,this.enqueueForceUpdate()}),500))}})),l()(this,"handleStartSync",(()=>{v.Z.state.syncing&&!this.realSync&&(this.realSync=!0,this.enqueueForceUpdate())})),l()(this,"handleStartSyncDebounced",u().debounce(this.handleStartSync,8e3)),l()(this,"handleStopSync",(()=>{this.realSync&&!v.Z.state.syncing&&(this.realSync=!1,this.enqueueForceUpdate())})),l()(this,"handleStopSyncDebounced",u().debounce(this.handleStopSync,200)),l()(this,"isOnline",this.createComputedStore((()=>v.Z.state.online))),l()(this,"shouldShowLoadingSpinner",(()=>(this.fakeSync||this.realSync)&&!y.n.state))}willMount(){this.listenForSave(),v.Z.addListener(this.handleStartSyncDebounced),v.Z.addListener(this.handleStopSyncDebounced)}willUnmount(){this.unlistenForSave(),v.Z.removeListener(this.handleStartSyncDebounced),v.Z.removeListener(this.handleStopSyncDebounced)}renderComponent(){const{device:e}=this.environment;return r()(d.Fragment,{},void 0,!e.isMobile&&this.renderDesktopIndicators(),e.isMobile&&this.renderMobileLoadingSpinner(),this.renderErrors())}renderDesktopIndicators(){const{intl:e}=this.props;return this.isOnline.state?this.shouldShowLoadingSpinner()?r()(g.Z,{renderTooltip:()=>r()(C._H,{defaultMessage:"{percent} complete.",id:"connectionState.savePercentangeIndicator.tooltip",values:{percent:y.Z.percentComplete(e)}}),render:e=>p().createElement("div",o()({style:this.getLoadingStateStyle()},e),r()(m.Z,{style:{margin:4,marginRight:8}}),r()(C._H,{defaultMessage:"Saving…",id:"connectionState.saving.message"}))}):void 0:r()(g.Z,{renderTooltip:()=>r()("div",{style:{width:200}},void 0,r()(C._H,{defaultMessage:"{numberOfEdits, plural, one {You have {numberOfEdits} edit that will be synced next time you are online.} other {You have {numberOfEdits} edits that will be synced next time you are online.}}",id:"connectionState.offlineBadge.tooltip",values:{numberOfEdits:y.Z.state.totalPending}})),textWrap:!0,render:e=>p().createElement("div",o()({style:this.getOfflineBadgeStyle()},e),r()(C._H,{defaultMessage:"Offline",id:"connectionState.offlineBadge.label"}))})}renderMobileLoadingSpinner(){return r()("div",{style:{display:"flex",alignItems:"center",height:"100%",marginLeft:"auto",paddingLeft:4,paddingRight:8,visibility:this.shouldShowLoadingSpinner()?"visible":"hidden"}},void 0,r()(m.Z,{style:{height:18,width:18}}))}renderErrors(){const{device:e}=this.environment;if(y.Z.state.transactionQueueError){const e=r()(C._H,{defaultMessage:"Cannot save changes",id:"connectionState.errorIndicator.cannotSaveChanges.message"}),t=r()(C._H,{defaultMessage:"You can no longer make edits: {errorMessage} Contact support if that doesn’t fix the issue. {usageInfoMessage}",id:"connectionState.errorIndicator.cannotMakeEdits.detailedMessage",values:{errorMessage:y.Z.state.transactionQueueError.message,usageInfoMessage:this.renderUsageInfo()}});return this.renderErrorIndicator(e,t)}const t=y.Z.state.storageUsageEstimate;if(void 0!==t&&!(0,P.mn)(t)){const t=e.isBrowser?r()(C._H,{defaultMessage:"Low browser storage",id:"connectionState.errorIndicator.lowStorageOnWebApp.message"}):e.isMobileNative?r()(C._H,{defaultMessage:"Low app storage",id:"connectionState.errorIndicator.lowStorageOnMobileApp.message"}):r()(C._H,{defaultMessage:"Low disk space",id:"connectionState.errorIndicator.lowStorageOnDesktopApp.message"});return this.renderErrorIndicator(t,r()(d.Fragment,{},void 0,this.renderUsageInfo()," ",r()(C._H,{id:"connectionState.errorIndicator.possibleLostEdits.detailedMessagePart2",defaultMessage:"You may lose changes made while offline. Try closing and re-opening your app, and contact support if that doesn’t fix the issue."})))}}renderUsageInfo(){const e=y.Z.state.storageUsageEstimate,{intl:t}=this.props;if(e){const s=e.usage/e.quota;return r()(C._H,{defaultMessage:"Notion is using {percentageOfStorageBytesUsed} of its available storage on your device ({usedNumberOfBytes} of {totalNumberOfBytes}).",id:"connectionState.errorIndicator.possibleLostEdits.detailedMessagePart1",values:{usedNumberOfBytes:(0,M.uf)(e.usage,"bytes",t),totalNumberOfBytes:(0,M.uf)(e.quota,"bytes",t),percentageOfStorageBytesUsed:t.formatNumber(s,{style:"percent",maximumFractionDigits:2})}})}}renderErrorIndicator(e,t){const{device:s}=this.environment,i=Z.Z.collectionDescriptionSmall({marginLeft:6,width:14,height:14,fill:this.getErrorStateStyle().color});return s.isMobile?r()(b.Z,{popupType:b.Z.PopupType.SlideUp,renderOrigin:t=>p().createElement(f.Z,o()({style:this.getErrorStateStyle()},t),e||i),render:({close:e})=>r()(w.ZP,{menuType:w.ZP.MenuType.ActionSheet},void 0,r()("div",{style:{padding:15,background:this.theme.errorText,color:"white"},onClick:e},void 0,t))}):r()(g.Z,{renderTooltip:()=>r()("div",{style:{width:320,whiteSpace:"normal"}},void 0,t),render:t=>p().createElement("div",o()({style:this.getErrorStateStyle()},t),e,i)})}listenForSave(){window.addEventListener("keydown",this.handleKeyDown)}unlistenForSave(){window.removeEventListener("keydown",this.handleKeyDown)}getTextStyle(){const{device:e}=this.environment,t=e.isMobile;return{display:"flex",alignItems:"center",marginRight:t?0:18,fontSize:t?12:14}}getOfflineBadgeStyle(){const{device:e}=this.environment,t=e.isMobile;return{display:"flex",alignItems:"center",padding:"0px 6px",height:t?20:24,borderRadius:3,marginRight:t?4:18,whiteSpace:"nowrap",fontSize:t?12:14,color:this.theme.mediumTextColor,border:"1px solid ".concat(this.theme.darkDividerColor)}}getLoadingStateStyle(){return{...this.getTextStyle(),color:this.theme.lightTextColor}}getErrorStateStyle(){return{...this.getTextStyle(),whiteSpace:"nowrap",color:this.theme.errorText}}}const x=(0,C.XN)(k)},29538:(e,t,s)=>{s.d(t,{V:()=>b,C:()=>f});var i=s(67154),o=s.n(i),n=s(98135),r=s.n(n),a=s(67294),l=s.n(a),d=s(3779),p=s(76668),c=s(13548),u=s(66832),h=s(37235),m=s(94610),g=s(80527),S=s(43250),v=s(5366),y=s(71802);class b extends u.Z{renderComponent(){const{device:e}=this.environment;return r()(f,{shouldHide:e.isElectronMac&&y.tu.state,icon:d.Z.doubleChevronLeft,caption:r()(v._H,{defaultMessage:"Close sidebar",id:"sidebarUnexpandButton.closeSidebar.tooltip"}),onClick:()=>p.lE({environment:this.environment,isExpanded:!1}),keyboardShortcutName:"toggleSidebar"})}}class f extends u.Z{renderComponent(){const{device:e}=this.environment;return r()(h.Z,{disableTooltip:this.props.shouldHide,renderTooltip:()=>r()("div",{},void 0,r()("div",{},void 0,this.props.caption),r()(m.Z,{style:{color:this.theme.mediumInvertedTextColor},name:this.props.keyboardShortcutName})),originGap:6,render:t=>r()(c.Z,{isVisible:!0,animationStyle:{opacity:this.props.shouldHide?0:1},enterAnimationStyle:{opacity:0},render:()=>l().createElement(g.Z,o()({disabled:this.props.shouldHide,icon:this.props.icon,style:{position:"relative",...e.isMobile&&{height:"100%"}},mobileFeedback:e.isMobile,onClick:this.props.onClick,className:S.Mf},t))})})}}},69435:(e,t,s)=>{s.d(t,{Z:()=>v});var i=s(98135),o=s.n(i),n=s(59713),r=s.n(n),a=(s(33948),s(67294),s(66832)),l=s(72693),d=s(47966),p=s(57623),c=s(50906),u=s(93678),h=s(2107),m=s(82990),g=s(5366);class S extends a.Z{constructor(...e){super(...e),r()(this,"handleUpgradeClick",(e=>{const{from:t,for:s,onUpgradeClick:i}=this.props;u.y(this.environment,{from:t,for:s}),i&&i(e)})),r()(this,"handleLearnMoreClick",(()=>{const{from:e,learnMoreRoute:t}=this.props;(0,h.Db)({environment:this.environment,url:(0,p.U)(t)}),c.Fsx(this.environment,{from:e})}))}renderComponent(){return o()("section",{style:this.getWrapStyle()},void 0,this.renderIcon(),this.renderTitle(),this.renderCaption(),this.renderActions())}renderIcon(){const{icon:e}=this.props;return e(this.getIconStyle())}renderTitle(){const{title:e}=this.props;return o()("header",{style:this.getTitleStyle()},void 0,e)}renderCaption(){const{caption:e}=this.props;return o()("p",{style:this.getCaptionStyle()},void 0,e)}renderActions(){return o()("footer",{},void 0,this.renderUpgradeButton(),this.renderLearnMoreButton())}renderUpgradeButton(){const{upgradeMessage:e}=this.props;return o()(l.Z,{onClick:this.handleUpgradeClick,isLarge:!0},void 0,e||o()(g._H,{defaultMessage:"Upgrade",id:"upsellCallout.upgradeButton.text"}))}renderLearnMoreButton(){return o()(d.Z,{onClick:this.handleLearnMoreClick,style:this.getLearnMoreButtonStyle()},void 0,o()(g._H,{defaultMessage:"Learn more",id:"upsellCallout.learnMoreButton.text"}))}getWrapStyle(){const{device:e}=this.environment;return{fontSize:14,...!e.isMobile&&{maxWidth:340}}}getIconStyle(){return{width:32,height:"auto",fill:this.theme.mediumIconColor,marginBottom:8}}getTitleStyle(){return{fontWeight:m.Z.fontWeight.semibold}}getCaptionStyle(){return{color:this.theme.mediumTextColor,marginTop:4,marginBottom:16}}getLearnMoreButtonStyle(){return{marginLeft:12}}}const v=S},30045:(e,t,s)=>{s.d(t,{Z:()=>f});var i=s(98135),o=s.n(i),n=s(59713),r=s.n(n),a=(s(33948),s(67294),s(5366)),l=s(66832),d=s(46951),p=s(72087),c=s(63143),u=s(7765),h=s(4122),m=s(27832),g=s(32935),S=s(17256),v=s(47966),y=s(23189);class b extends l.Z{constructor(...e){super(...e),r()(this,"storeTypes",{requestStore:p.Z}),r()(this,"renderResult",((e,t,s)=>o()(h.Z,{loaded:s,spinnerSize:16,showSpinnerTimeout:600},void 0,e||!t?o()("div",{},void 0,this.props.intl.formatMessage({id:"userDataConsent.render.error",defaultMessage:"Something went wrong"})):this.renderOutput(t)))),r()(this,"renderOutput",(e=>{const t=Boolean(e.expiryTime&&Number(e.expiryTime)>Date.now()),s=t?this.revokeDataAccess:this.grantDataAccess;return o()("div",{style:this.getSettingsOptionStyle()},void 0,o()("div",{style:{display:"flex",alignItems:"flex-start",marginBottom:12,width:"100%"}},void 0,o()("div",{style:{flex:1}},void 0,o()(y.Z,{},void 0,o()(a._H,{id:"userDataConsentSettings.header.label",defaultMessage:"Support access"})),o()(d.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4,width:"80%"}},void 0,t&&e.expiryTime?o()(a._H,{id:"userDataConsentSettings.accessGranted.label",defaultMessage:"You have granted Notion access to your account for support purposes until {expiryTime}.",values:{expiryTime:S.Z.unix(e.expiryTime/1e3).locale(this.props.intl.locale).format("lll")}}):o()(a._H,{id:"userDataConsentSettings.accessNotGranted.label",defaultMessage:"Grant Notion support temporary access to your account so we can troubleshoot problems or recover content on your behalf. You can revoke access at any time."})),o()(v.Z,{onClick:s,isLarge:!0,style:{marginTop:12,marginBottom:4}},void 0,o()(a._H,t?{id:"userDataConsentSettings.revokeSupportAccess.button",defaultMessage:"Revoke access"}:{id:"userDataConsentSettings.allowSupportAccess.button",defaultMessage:"Allow support access"})))))})),r()(this,"fetchUserDataConsentSettings",(async e=>{const t=await g.Zmw(this.environment,{});if("failed"===t.type)throw t.error;return t.data})),r()(this,"grantDataAccess",(async()=>{await this.setDataAccessExpiryTime({expiryTime:Date.now()+14*c.A0})})),r()(this,"revokeDataAccess",(async()=>{await this.setDataAccessExpiryTime({})})),r()(this,"setDataAccessExpiryTime",(async e=>{const t=await g.VK_(this.environment,e);if("success"===t.type&&t.data){const e=this.stores.requestStore.state;this.stores.requestStore.setState({...e,result:t.data})}}))}renderComponent(){const{currentUserStore:e}=m.Z.state;return e&&o()(u.Z,{requestStore:this.stores.requestStore,request:{userId:e.id,expiryTime:Date.now()+14*c.A0},performRequest:this.fetchUserDataConsentSettings,render:this.renderResult})}getSettingsOptionStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto",paddingLeft:e.isMobile?t.state.paddingLeftCSS:0,paddingRight:e.isMobile?t.state.paddingRightCSS:0}}}const f=(0,a.XN)(b)},5188:(e,t,s)=>{s.d(t,{Z:()=>n});var i=s(52016);class o extends i.Z{getInitialState(){return{open:!1}}}const n=new o},66205:(e,t,s)=>{s.d(t,{Z:()=>n});var i=s(52016);class o extends i.Z{getInitialState(){return{open:!1}}}const n=new o},46911:(e,t,s)=>{s.d(t,{Z:()=>n});var i=s(52016);class o extends i.Z{getInitialState(){return{contacts:!1}}}const n=o}}]);