"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[8],{56877:(e,t,i)=>{i.r(t),i.d(t,{default:()=>f});var o=i(98135),n=i.n(o),s=i(59713),r=i.n(s),a=(i(33948),i(67294)),l=i.n(a),d=i(62727),c=i(33846),h=i(66832),p=i(3779),u=i(24677),m=i(98104),g=i(56109),b=i(87953),y=i(41101),v=i(5366);class S extends h.Z{constructor(...e){super(...e),r()(this,"storeTypes",{store:c.Z}),r()(this,"handleFocused",(()=>{u.ZH(this.environment),m.ZH(this.environment),this.stores.store.setState({...this.stores.store.state,focus:!0})})),r()(this,"handleBlurred",(()=>{this.stores.store.setState({...this.stores.store.state,focus:!1})})),r()(this,"handleSearchQueryChange",(e=>{this.props.onChange({searchQuery:e.target.value})}))}renderComponent(){const{searchQuery:e,intl:t}=this.props,{focus:i}=this.stores.store.state;return n()(g.Z,{capture:i},void 0,n()(b.Z,{capture:!0,render:o=>l().createElement("div",o,n()(d.Z,{style:this.getStyle(),format:d.B.Transparent,value:e,placeholder:t.formatMessage({defaultMessage:"Type to search…",id:"database.mobileSearch.placeholder"}),onChange:this.handleSearchQueryChange,autoComplete:"on",autoCorrect:"on",onFocus:this.handleFocused,onBlur:this.handleBlurred,showClearButton:!0,left:p.Z.searchThick(this.getSearchIconStyle())}),n()(y.Z,{show:i}))}))}getStyle(){return{boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,flexGrow:0,flexShrink:0,height:32,paddingLeft:8,paddingRight:12,borderRadius:3,fontSize:14,marginBottom:4}}getSearchIconStyle(){return{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:this.theme.mediumIconColor}}}const f=(0,v.XN)(S)},44299:(e,t,i)=>{i.r(t),i.d(t,{default:()=>V});var o=i(67154),n=i.n(o),s=i(98135),r=i.n(s),a=i(59713),l=i.n(a),d=(i(33948),i(67294)),c=i.n(d),h=i(96486),p=i.n(h),u=i(3779),m=i(44886),g=i(60165),b=i(24677),y=i(50906),v=i(82990),S=i(66832),f=i(40464),M=i(73383),k=i(82945),T=i(16961),Z=i(98104),w=i(15692),C=i(80935),I=i(27724),P=i(24666),x=i(17903),B=i(14947),A=i(64131),R=i(5366),_=i(32404),L=i(17215),F=i(72653),H=i(85394),E=i(52533),O=i(67074),U=i(74350),D=i(69454),N=i(59488);class W extends S.Z{constructor(...e){super(...e),l()(this,"scrollerDiv",void 0),l()(this,"currentlyShownTimer",void 0),l()(this,"previouslyShownOnNative",!1),l()(this,"handleScrollerRef",(e=>{e&&(this.scrollerDiv=e)})),l()(this,"handleUnindent",(e=>{O.$$(this.environment)})),l()(this,"handleIndent",(e=>{O.O2(this.environment)})),l()(this,"handleMoveUp",(e=>{O.s0(this.environment)})),l()(this,"handleMoveDown",(e=>{O.rZ(this.environment)})),l()(this,"handleUndo",(()=>{O.i2(this.environment)})),l()(this,"handleRedo",(()=>{O.GH(this.environment)})),l()(this,"handleDismissKeyboard",(e=>{b.ZH(this.environment),this.props.stores.store.setState({...this.props.stores.store.state,isInsertOpen:!1}),this.trackItemTap("hide_keyboard"),Z.sD()})),l()(this,"handleInsert",(e=>{this.props.stores.store.setState({...this.props.stores.store.state,isInsertOpen:!0}),this.trackItemTap("insert")})),l()(this,"handleTakePicture",(e=>{O.vs(this.environment)})),l()(this,"handleMention",(e=>{O.Z3(this.environment)})),l()(this,"handleComment",(e=>{O.ol(this.environment,!1)})),l()(this,"handleDelete",(e=>{O.fn(this.environment)})),l()(this,"handleActionsScroll",(()=>{y.FGU(this.environment)})),l()(this,"handleActionsScrollDebounced",p().debounce(this.handleActionsScroll,500)),l()(this,"handleMoreClick",(e=>{O.w1(this.environment,e.clientX,e.clientY)})),l()(this,"listenForPositionChanges",this.createComputedStore((()=>{const e=P.Z.state,t="editing"===e.mode&&e.multiSelection;return t?{scrollTop:x.Z.state.scrollTop,editing:!0,store:t.end.store.id,selection:t.end}:{scrollTop:x.Z.state.scrollTop,editing:!1}}))),l()(this,"renderStore",this.createComputedStore((()=>{var e;return O.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state)}))),l()(this,"shouldShowTextActions",this.createComputedStore((()=>O.oQ(this.props.stores.ignoreSelectionAreaStore)))),l()(this,"shouldShowBlockActions",this.createComputedStore((()=>!this.shouldShowTextActions.state))),l()(this,"canTriggerBlockActions",this.createComputedStore((()=>!!this.shouldShowBlockActions.state&&O.Bo(this.pageContext&&this.pageContext.publicEditModeStore.state)))),l()(this,"canTriggerTextActions",this.createComputedStore((()=>O.eQ(this.pageContext&&this.pageContext.publicEditModeStore.state,this.props.currentBlockStore))))}willMountOrUpdate(){const{device:e}=this.environment,t=this.renderStore.state.shouldShow;if(e.isMobileBrowser){const e=this.props.stores.store.state.isOpen;t?e?void 0!==this.currentlyShownTimer&&(window.clearTimeout(this.currentlyShownTimer),this.currentlyShownTimer=void 0):(this.props.stores.store.setState({...this.props.stores.store.state,isOpen:!0}),this.scrollerDiv&&(this.scrollerDiv.scrollLeft=0)):e&&void 0===this.currentlyShownTimer&&(this.currentlyShownTimer=window.setTimeout((()=>{this.currentlyShownTimer=void 0,this.props.stores.store.setState({...this.props.stores.store.state,isOpen:!1})}),200))}else t!==this.previouslyShownOnNative&&(this.previouslyShownOnNative=t,this.scrollerDiv&&(this.scrollerDiv.scrollLeft=0))}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,i=this.isOpen(),o=e.isMobile&&F.Z.state;if(this.props.position===E.n.Bottom){let e=0;return(0,N.de)()?e=D.Z.estimatedKeyboardWebViewOverlap():o&&(e=t.getSafePaddingBottomCSS(H.default.height)),r()("div",{style:{position:"absolute",bottom:e,left:0,height:W.height,width:"100%",pointerEvents:i?"auto":"none",opacity:i?1:0,transform:i?"translateY(0)":"translateY(".concat(W.height,"px)"),transition:"opacity 120ms ease-out, transform 120ms ease-out"}},void 0,this.renderActionButtons())}{const e=this.props.stores.ignoreSelectionAreaStore.state.savedTextSelectionRect||C.TJ();if(!e)return;const t=document.body.getBoundingClientRect(),o={...e,left:10,top:e.top+10-t.top};this.listenForPositionChanges.state;const{device:n}=this.environment;return r()(w.ZP,{popupType:n.isMobileNative?w.ZP.PopupType.SlideUp:w.ZP.PopupType.Popup,open:i,preventBlockRenderQueueOnEnter:!0,placementToOrigin:w.ZP.Placement.Bottom,alignmentToOrigin:w.ZP.Alignment.Start,originRect:o,disableMouseCapture:!0,keepFocus:!0,render:()=>r()("div",{style:{height:W.height,width:"calc(80wv)",borderRadius:3,overflow:"hidden"}},void 0,this.renderActionButtons())})}}renderActionButtons(){const e=this.shouldShowTextActions.state,t=this.shouldShowBlockActions.state,i=O.Tz({environment:this.environment,store:this.props.currentBlockStore});return r()("div",{style:this.getActionButtonStyles()},void 0,i&&this.renderTemplatesButton(),!i&&t&&this.renderBlockActions(),!i&&e&&this.renderTextActions(),r()(B.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...this.getItemStyle(),borderLeft:this.getItemBorder(),borderRight:"none"},onClick:this.handleDismissKeyboard},void 0,W.keyboardIcon))}renderBlockActions(){const e=this.canTriggerBlockActions.state;let t=!1,i=!1;const o=this.props.currentBlockStore.getValue();o&&((0,L._T)(o)||(t=!0),(0,L.lQ)(o)||(i=!0));const{device:s}=this.environment;return c().createElement("div",{ref:this.handleScrollerRef,style:this.getActionMenuStyle(),onScroll:this.handleActionsScrollDebounced},r()(B.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...this.getItemStyle(),...!s.isSmallPhone&&{paddingLeft:12,paddingRight:12}},onClick:this.handleInsert,disabled:!e},void 0,W.plusIcon,this.renderChevronDown()),r()(B.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...this.getItemStyle(),fontWeight:v.Z.fontWeight.medium},onClick:e=>{this.props.stores.store.setState({...this.props.stores.store.state,isTurnIntoOpen:!0}),this.trackItemTap("turn_into")},disabled:!e},void 0,r()(R._H,{defaultMessage:"Turn into",id:"mobileActionBar.turnInto.buttonTitle"}),this.renderChevronDown()),r()(T.Z,{capture:!0,render:e=>c().createElement(B.Z,n()({mobileFeedback:!0,disabledFeedback:!0},e,{style:this.getItemStyle(),onClick:this.handleMention,disabled:!i}),r()("span",{style:{fontSize:19,lineHeight:1,fontWeight:v.Z.fontWeight.medium,marginBottom:s.isAndroid?4:0}},void 0,"@"))}),r()(B.Z,{mobileFeedback:!0,disabledFeedback:!0,style:this.getItemStyle(),onClick:this.handleComment,disabled:!t},void 0,W.discussionIcon),r()(B.Z,{mobileFeedback:!0,disabledFeedback:!0,style:this.getItemStyle(),onClick:this.handleTakePicture,disabled:!e},void 0,W.imageIcon),r()(B.Z,{mobileFeedback:!0,disabledFeedback:!0,style:this.getItemStyle(),onClick:this.handleDelete,disabled:!e},void 0,W.trashIcon),this.renderBlockMovementActions(),this.renderBlockUndoActions(),r()(B.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...this.getItemStyle(),fontWeight:v.Z.fontWeight.medium},onClick:e=>{this.props.stores.store.setState({...this.props.stores.store.state,isColorOpen:!0}),this.trackItemTap("color")},disabled:!e},void 0,r()(R._H,{defaultMessage:"Color",id:"mobileActionBar.color.buttonTitle"}),this.renderChevronDown()),r()(B.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...this.getItemStyle(),fontWeight:v.Z.fontWeight.medium},onClick:this.handleMoreClick,disabled:!e},void 0,r()(R._H,{defaultMessage:"More",id:"mobileActionBar.more.buttonTitle"}),this.renderChevronDown()))}renderBlockMovementActions(){const e=this.canTriggerBlockActions.state,t=I.Z.state.stores[0];return r()("div",{style:{...this.getItemStyle(),paddingLeft:6,paddingRight:6}},void 0,r()(B.Z,{mobileFeedback:!0,disabledFeedback:!0,style:W.minorItemStyle,disabled:!e||!m.gq(t),onClick:this.handleUnindent},void 0,W.unindentIcon),r()(B.Z,{mobileFeedback:!0,disabledFeedback:!0,style:W.minorItemStyle,disabled:!e||!m.nt(t),onClick:this.handleIndent},void 0,W.indentIcon),r()(B.Z,{mobileFeedback:!0,disabledFeedback:!0,style:W.minorItemStyle,disabled:!e,onClick:this.handleMoveUp},void 0,W.moveUpIcon),r()(B.Z,{mobileFeedback:!0,disabledFeedback:!0,style:W.minorItemStyle,disabled:!e,onClick:this.handleMoveDown},void 0,W.moveDownIcon))}renderBlockUndoActions(){return r()("div",{style:{...this.getItemStyle(),paddingLeft:6,paddingRight:6}},void 0,r()(B.Z,{mobileFeedback:!0,disabledFeedback:!0,style:W.minorItemStyle,disabled:!g.L0(),onClick:this.handleUndo},void 0,W.undoIcon),r()(B.Z,{mobileFeedback:!0,disabledFeedback:!0,style:W.minorItemStyle,disabled:!g.AZ(),onClick:this.handleRedo},void 0,W.redoIcon))}renderTextActions(){const e=this.canTriggerTextActions.state,t=this.props.currentBlockStore.canComment();return r()("div",{style:this.getActionMenuStyle(),onScroll:this.handleActionsScrollDebounced},void 0,r()(k.Z,{style:this.getItemStyle(),blockStore:I.Z.state.stores[0],disabled:!t}),r()(f.Z,{type:"b",style:this.getItemStyle(),onClick:()=>this.trackItemTap("bold"),disabled:!e},void 0,r()("span",{style:{fontWeight:v.Z.fontWeight.semibold}},void 0,r()(R._H,{defaultMessage:"B",id:"mobileActionBar.bold.symbol",description:"Letter 'B' which represents 'bold' format option."}))),r()(f.Z,{type:"i",style:this.getItemStyle(),onClick:()=>this.trackItemTap("italic"),disabled:!e},void 0,r()("span",{style:{fontStyle:"italic",fontWeight:v.Z.fontWeight.semibold}},void 0,r()(R._H,{defaultMessage:"i",id:"mobileActionBar.italic.symbol",description:"Letter 'i' which represents 'italic' format option."}))),r()(f.Z,{type:"_",style:this.getItemStyle(),onClick:()=>this.trackItemTap("underline"),disabled:!e},void 0,r()("span",{style:{textDecoration:"underline"}},void 0,r()(R._H,{defaultMessage:"U",id:"mobileActionBar.underline.symbol",description:"Letter 'U' which represents 'underline' format option."}))),r()(f.Z,{type:"s",style:this.getItemStyle(),onClick:()=>this.trackItemTap("strike_through"),disabled:!e},void 0,r()("span",{style:{textDecoration:"line-through"}},void 0,r()(R._H,{defaultMessage:"S",id:"mobileActionBar.strikeThrough.symbol",description:"Letter 'S' which represents 'strike-through' format option."}))),r()(f.Z,{type:"c",style:this.getItemStyle(),onClick:()=>this.trackItemTap("code"),disabled:!e},void 0,r()("span",{style:{fontFamily:v.Z.getCompositeFontFamily(U.SP).githubMono}},void 0,r()(R._H,{defaultMessage:"Code",id:"mobileActionBar.code.symbol",description:"Word 'code' which represents 'code' format option."}))),r()(M.Z,{style:this.getItemStyle(),disabled:!e},void 0,r()("span",{style:{borderBottom:"1px solid ".concat(this.theme.linkDecorationColor)}},void 0,r()(R._H,{defaultMessage:"Link",id:"mobileActionBar.link.symbol",description:"Word 'link' which represents 'link' format option."}))),r()(_.Z,{onClick:()=>this.trackItemTap("equation"),disabled:!e,style:this.getItemStyle()},void 0,u.Z.equation({width:16,height:16})),r()(A.Z,{style:this.getItemStyle(),ignoreSelectionAreaStore:this.props.stores.ignoreSelectionAreaStore,disabled:!e}))}renderTemplatesButton(){return r()("div",{style:this.getActionMenuStyle()},void 0,r()(B.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...this.getItemStyle(),borderRight:"none",fontWeight:v.Z.fontWeight.medium},onClick:e=>{this.props.stores.store.setState({...this.props.stores.store.state,isTemplatesOpen:!0}),this.trackItemTap("templates")}},void 0,u.Z.templatesColor({width:20,marginRight:8}),r()(R._H,{defaultMessage:"Choose a template...",id:"mobileActionBar.templates.buttonTitle"}),this.renderChevronDown()))}renderChevronDown(){return u.Z.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor})}isOpen(){const{device:e}=this.environment;return e.isMobileBrowser?this.props.stores.store.state.isOpen:this.renderStore.state.shouldShow}trackItemTap(e){y.YOV(this.environment,{itemName:e})}getItemBorder(){return"1px solid ".concat(this.theme.regularDividerColor)}getActionButtonStyles(){const{device:e,WindowSizeStore:t}=this.environment;return{height:"100%",width:"100%",fontSize:15,display:"flex",boxShadow:this.props.position===E.n.Bottom?this.theme.bottomActionBarShadow:this.theme.mediumBoxShadow,backgroundColor:this.theme.keyboardActionBarBackground,paddingLeft:e.isMobileNative?t.state.paddingLeftCSS:0,paddingRight:e.isMobileNative?t.state.paddingRightCSS:0}}getActionMenuStyle(){return{flexGrow:1,flexShrink:1,marginRight:-1,display:"flex",overflowX:"auto",overflowY:"hidden",WebkitOverflowScrolling:"touch"}}getItemStyle(){const{device:e}=this.environment;return{display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:e.isSmallPhone?8:10,paddingRight:e.isSmallPhone?8:10,borderRight:this.getItemBorder(),whiteSpace:"nowrap",height:W.height,flexShrink:0,flexGrow:0,flexBasis:"auto",color:this.theme.regularTextColor,minWidth:e.isSmallPhone?42:44}}}l()(W,"unindentIcon",u.Z.indentDown({width:18,height:18,transform:"rotate(90deg)",position:"relative",left:1})),l()(W,"indentIcon",u.Z.indentDown({width:18,height:18,transform:"rotate(-90deg)",position:"relative",left:-1})),l()(W,"moveUpIcon",u.Z.moveUp({width:18,height:18,position:"relative",left:2})),l()(W,"moveDownIcon",u.Z.moveUp({width:18,height:18,transform:"rotate(180deg)",position:"relative",left:2})),l()(W,"undoIcon",u.Z.undo({width:19,height:19})),l()(W,"redoIcon",u.Z.redo({width:19,height:19})),l()(W,"trashIcon",u.Z.trash({width:18,height:18})),l()(W,"discussionIcon",u.Z.speechBubbleThin({width:18,height:18})),l()(W,"plusIcon",u.Z.thinPlus({width:14,height:14})),l()(W,"keyboardIcon",u.Z.keyboard({width:18,height:18})),l()(W,"imageIcon",u.Z.image({width:18,height:18})),l()(W,"height",42),l()(W,"minorItemStyle",{width:34,justifyContent:"center"});const V=(0,R.XN)(W)},82043:(e,t,i)=>{i.r(t),i.d(t,{default:()=>O});var o=i(98135),n=i.n(o),s=i(67154),r=i.n(s),a=i(59713),l=i.n(a),d=(i(33948),i(67294)),c=i.n(d),h=i(50906),p=i(7313),u=i(52016);class m extends u.Z{getInitialState(){return{isOpen:!1,isInsertOpen:!1,isTurnIntoOpen:!1,isColorOpen:!1,isTemplatesOpen:!1}}}const g=m;var b=i(52858),y=i(95009),v=i(66832),S=i(52377),f=i(16961),M=i(51454),k=i(15692),T=i(27724),Z=i(24666),w=i(63334),C=i(5366),I=i(29798),P=i(25584),x=i(94006),B=i(94660),A=i(34574),R=i(70442),_=i(21325),L=i(83071),F=i(15282),H=i(67074);class E extends v.Z{constructor(...e){super(...e),l()(this,"storeTypes",{store:g,ignoreSelectionAreaStore:w.Z,templatePickerMenuListStore:I.Z}),l()(this,"renderMobileTemplatePreviewItem",(e=>({key:e.name,render:t=>c().createElement(A.Z,r()({},t,{key:e.name,title:e.name,type:"page_template",format:"phone-modal",emoji:e.emoji,locked:!1})),action:()=>{R.$7({environment:this.environment,item:e,createNewPage:!1,isPrivate:!1})}}))),l()(this,"renderPageTemplatePickerItem",(e=>{const t=this.props.currentBlockStore;return{key:e.name,render:t=>c().createElement(A.Z,r()({},t,{key:e.name,format:"phone-modal",title:e.name,type:e.type,icon:e.icon,locked:!1})),action:i=>{t&&(0,_.M_)(this.environment)&&(h.rNQ(this.environment,{name:e.name,is_keyboard:"keydown"===i.event.type}),e.onClick(this.environment,t))}}})),l()(this,"handleCloseColorPopup",(()=>{this.stores.store.setState({...this.stores.store.state,isColorOpen:!1})})),l()(this,"handleCloseInsertPopup",(()=>{this.stores.store.setState({...this.stores.store.state,isInsertOpen:!1})})),l()(this,"handleCloseTurnIntoPopup",(()=>{this.stores.store.setState({...this.stores.store.state,isTurnIntoOpen:!1})})),l()(this,"handleCloseTemplatesPopup",(()=>{this.stores.store.setState({...this.stores.store.state,isTemplatesOpen:!1})})),l()(this,"renderStore",this.createComputedStore((()=>{var e;return H.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state)})))}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,i=this.isOpen(),{makeActionBarComponent:o}=this.props;return n()(d.Fragment,{},void 0,n()(f.Z,{capture:!0,render:e=>c().createElement("div",r()({},e,{style:{position:"relative",width:"100%",height:0,zIndex:M.Eo}}),o(this.stores),this.renderNativeMenuIgnoreSelectionArea(),this.renderInsertPopup(),this.renderTurnIntoPopup(),this.renderColorPopup(),this.renderTemplatesPopup())}),!i&&e.isIPhoneX&&e.isNative&&n()("div",{style:{position:"absolute",bottom:0,background:"transparent",height:t.state.paddingBottomCSS,width:"100%",pointerEvents:"none",WebkitUserSelect:"none"}}))}renderNativeMenuIgnoreSelectionArea(){const e=this.environment.NativeMobileActionBarStore;return e?n()(S.Z,{store:this.stores.ignoreSelectionAreaStore,capture:H.y6(this.environment),ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:"editing"!==Z.Z.state.mode&&e.state.shouldRestoreSelectionForMenu,render:e=>null}):null}renderInsertPopup(){const{device:e}=this.environment;return n()(S.Z,{capture:this.stores.store.state.isInsertOpen,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!1,render:t=>n()(k.ZP,{popupType:e.isMobile?k.ZP.PopupType.SlideUp:k.ZP.PopupType.Popup,preventBlockRenderQueueOnEnter:!0,open:this.stores.store.state.isInsertOpen,keepFocus:!0,onDismiss:()=>{t(),this.handleCloseInsertPopup()},render:()=>n()(y.ZP,{menuType:y.ZP.MenuType.Modal,title:n()(C._H,{defaultMessage:"Insert block",id:"mobileActionBar.insertBlock.modalTitle"}),right:n()(F.CancelMenuText,{}),onClickRight:()=>{t(),this.handleCloseInsertPopup()}},void 0,n()(b.Z,{sections:p.kR,context:{environment:this.environment,blocks:T.Z.state.stores},onAccept:this.handleCloseInsertPopup}))})})}renderTurnIntoPopup(){const{device:e}=this.environment;return n()(S.Z,{capture:this.stores.store.state.isTurnIntoOpen,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!0,render:()=>n()(k.ZP,{popupType:e.isMobile?k.ZP.PopupType.SlideUp:k.ZP.PopupType.Popup,open:this.stores.store.state.isTurnIntoOpen,keepFocus:!0,onDismiss:this.handleCloseTurnIntoPopup,preventBlockRenderQueueOnEnter:!0,render:()=>n()(y.ZP,{menuType:y.ZP.MenuType.Modal,title:n()(C._H,{defaultMessage:"Turn into",id:"mobileActionBar.turnInto.modalTitle"}),right:n()(F.CancelMenuText,{}),onClickRight:this.handleCloseTurnIntoPopup},void 0,n()(b.Z,{sections:[{...p.gH,title:""}],context:{environment:this.environment,blocks:T.Z.state.stores},onAccept:this.handleCloseTurnIntoPopup}))})})}renderColorPopup(){const{device:e}=this.environment;return n()(S.Z,{capture:this.stores.store.state.isColorOpen,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!0,render:()=>n()(k.ZP,{popupType:e.isMobile?k.ZP.PopupType.SlideUp:k.ZP.PopupType.Popup,open:this.stores.store.state.isColorOpen,keepFocus:!0,onDismiss:this.handleCloseColorPopup,preventBlockRenderQueueOnEnter:!0,render:()=>n()(y.ZP,{menuType:y.ZP.MenuType.Modal,title:n()(C._H,{defaultMessage:"Block color",id:"mobileActionBar.blockColor.modalTitle"}),right:n()(F.CancelMenuText,{}),onClickRight:this.handleCloseColorPopup},void 0,n()(b.Z,{sections:[p.te,p.rz,p.Vm],context:{environment:this.environment,blocks:T.Z.state.stores},onAccept:this.handleCloseColorPopup}))})})}renderTemplatesPopup(){const{device:e}=this.environment;return n()(S.Z,{capture:this.stores.store.state.isTemplatesOpen,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!1,render:()=>n()(k.ZP,{popupType:e.isMobile?k.ZP.PopupType.SlideUp:k.ZP.PopupType.Popup,open:this.stores.store.state.isTemplatesOpen,keepFocus:!0,render:()=>n()(y.ZP,{menuType:y.ZP.MenuType.Modal,title:n()(C._H,{defaultMessage:"Templates",id:"mobileActionBar.templates.modalTitle"}),right:n()(F.CancelMenuText,{}),onClickRight:this.handleCloseTemplatesPopup},void 0,n()(P.Z,{type:P.Z.Type.Vertical,store:this.stores.templatePickerMenuListStore,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,onAccept:this.handleCloseTemplatesPopup,sections:[{key:"Basic",render:e=>n()(L.Z,{},void 0,e.children),items:x.ss.map(this.renderPageTemplatePickerItem)},{key:"Database",render:e=>n()(L.Z,{title:n()(C._H,{defaultMessage:"Database",id:"mobileActionBar.databaseSection.title"})},void 0,e.children),items:x.Im.filter((e=>e.shouldShow(this.environment))).map(this.renderPageTemplatePickerItem)},...B.Ip(this.environment,this.props.intl).map((e=>({key:e.name,render:t=>n()(L.Z,{title:e.name},e.name,t.children),items:e.items.map(this.renderMobileTemplatePreviewItem)})))]}))})})}isOpen(){const{device:e}=this.environment;return e.isMobileBrowser?this.stores.store.state.isOpen:this.renderStore.state.shouldShow}}const O=(0,C.XN)(E)},85394:(e,t,i)=>{i.r(t),i.d(t,{default:()=>M});var o=i(98135),n=i.n(o),s=i(59713),r=i.n(s),a=(i(33948),i(67294)),l=i(66832),d=i(14947),c=i(76668),h=i(3779),p=i(27832),u=i(51454),m=i(87531),g=i(70951),b=i(50906),y=i(60165),v=i(72653),S=i(43250);class f extends l.Z{constructor(...e){super(...e),r()(this,"handleClickFind",(()=>{m.Kf({environment:this.environment,analyticsFrom:"mobile-bottom-bar"}),b.nBz(this.environment,{itemName:"search"})})),r()(this,"handleClickQuickAdd",(()=>{c.hU({environment:this.environment,from:"mobile_bottom_bar"}),b.nBz(this.environment,{itemName:"add_page"})})),r()(this,"handleUndo",(()=>{y.Yw(this.environment,!0),b.nBz(this.environment,{itemName:"undo"})})),r()(this,"handleRedo",(()=>{y.KX(this.environment,!0),b.nBz(this.environment,{itemName:"redo"})})),r()(this,"canQuickAdd",this.createComputedStore((()=>Boolean(p.Z.state.currentSpaceStore&&p.Z.state.currentSpaceStore.canEdit()))))}renderComponent(){const e=v.Z.state;if(e){const{isTablet:t}=this.environment.device;return n()("div",{style:this.getWrapStyle(e),className:e?S.rK:S.al},void 0,t?this.renderTabletButtons():this.renderPhoneButtons())}}renderPhoneButtons(){return n()(a.Fragment,{},void 0,this.renderSearchButton(),this.renderUpdatesButton(),this.renderQuickAddPageButton())}renderTabletButtons(){return n()(a.Fragment,{},void 0,this.renderSearchButton(),this.renderUpdatesButton(),this.renderQuickAddPageButton(),this.renderUndoRedoButtons())}renderSearchButton(){return n()(d.Z,{style:this.getSearchButtonStyle(),onClick:this.handleClickFind,mobileFeedback:!0},void 0,h.Z.mobileBottomBarSearch(this.getIconStyle()))}renderUpdatesButton(){const{isTablet:e}=this.environment.device;return n()(g.Z,{format:e?g.Z.Format.MobileBottomBarTablet:g.Z.Format.MobileBottomBarPhone})}renderQuickAddPageButton(){return n()(d.Z,{style:this.getQuickAddButtonStyle(),onClick:this.handleClickQuickAdd,mobileFeedback:!0,disabled:!this.canQuickAdd.state,disabledFeedback:!0},void 0,h.Z.mobileBottomBarAddPage(this.getIconStyle()))}renderUndoRedoButtons(){return n()(a.Fragment,{},void 0,n()(d.Z,{style:this.getUndoButtonStyle(),onClick:this.handleUndo,mobileFeedback:!0,disabled:!y.L0(),disabledFeedback:!0},void 0,h.Z.mobileBottomBarUndo(this.getIconStyle())),n()(d.Z,{style:this.getRedoButtonStyle(),onClick:this.handleRedo,mobileFeedback:!0,disabled:!y.AZ(),disabledFeedback:!0},void 0,h.Z.mobileBottomBarRedo(this.getIconStyle())))}getWrapStyle(e){const{WindowSizeStore:t}=this.environment,{isTablet:i}=this.environment.device;return{position:"absolute",left:0,right:0,bottom:0,display:"flex",justifyContent:i?"flex-start":"space-around",height:t.getSafePaddingBottomCSS(f.height),paddingBottom:t.state.paddingBottomCSS,background:this.theme.contentBackground,borderTop:"1px ".concat(this.theme.darkDividerColor," solid"),zIndex:u.D_,pointerEvents:e?"auto":"none",cursor:"pointer"}}getSearchButtonStyle(){const{WindowSizeStore:e}=this.environment,{isTablet:t}=this.environment.device;return{display:"flex",alignItems:"center",justifyContent:"flex-start",flex:1,paddingLeft:e.getSafePaddingLeftCSS(18),...t&&{flex:"none",paddingLeft:2,width:f.tabletButtonWidth,justifyContent:"center"}}}getQuickAddButtonStyle(){const{WindowSizeStore:e}=this.environment,{isTablet:t}=this.environment.device;return{display:"flex",alignItems:"center",justifyContent:"flex-end",flex:1,paddingRight:e.getSafePaddingRightCSS(18),...t&&{justifyContent:"center",flex:"none",paddingRight:0,width:f.tabletButtonWidth,marginRight:"auto"}}}getUndoButtonStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",alignItems:"center",justifyContent:"flex-start",flex:"none",paddingLeft:e.getSafePaddingLeftCSS(18),width:f.tabletButtonWidth}}getRedoButtonStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",flex:"none",width:f.tabletButtonWidth,paddingRight:4}}getIconStyle(){return{width:26,fill:this.theme.regularTextColor}}}r()(f,"height",44),r()(f,"tabletButtonWidth",54);const M=f},56140:(e,t,i)=>{i.r(t),i.d(t,{default:()=>K});var o=i(98135),n=i.n(o),s=i(59713),r=i.n(s),a=(i(33948),i(96486)),l=i.n(a),d=i(67294),c=i(17256),h=i(66832),p=i(3779),u=i(52016);class m extends u.Z{getInitialState(){return{}}}const g=m;var b=i(82990),y=i(84210),v=i(40515),S=i(79029),f=i(6695),M=i(42285),k=i(32918),T=i(65598),Z=i(86512),w=i(48762),C=i(33929);class I extends h.Z{constructor(...e){super(...e),r()(this,"renderProperty",(e=>{const{schema:t,store:i,blockPropertyValueOverlayStore:o}=this.props;if(t[e])return n()(M.Z,{store:i,property:e,schema:t,disabled:!0,locked:!1,format:M.Z.Format.Calendar,tableWrap:!1,blockPropertyValueOverlayStore:o},e)}))}renderComponent(){const{time:e,store:t}=this.props,i=t.hasIcon()||!t.isEmptyPage(),o=(0,y.Z)({store:t,fullyQualified:!1}),s=T.Xp(t,{recursivelyLoadAllDiscussions:!1});return n()(Z.Z,{href:o},void 0,n()(w.Z,{focused:!1,title:n()(d.Fragment,{},void 0,e&&n()("div",{style:{display:"flex",color:this.theme.mediumTextColor,fontSize:14,marginTop:8,marginBottom:6}},void 0,e),n()("div",{style:{display:"flex",alignItems:"center",...e&&{marginBottom:8}}},void 0,i&&n()(v.Z,{disabled:!0,icon:t.getIcon(),isEmptyPage:t.isEmptyPage(),size:24,style:{flexShrink:0,marginRight:8}}),n()(S.Z,{store:t,style:{fontWeight:b.Z.fontWeight.semibold}}),s>0&&n()("div",{style:{display:"flex",alignItems:"center",color:this.theme.regularDividerColor,fontSize:12,marginLeft:4,flexShrink:0}},void 0,p.Z.speechBubble({width:12,height:12,marginRight:4,fill:this.theme.mediumIconColor}),s))),caption:this.renderProperties()}))}renderProperties(){const{format:e,schema:t,store:i}=this.props,o=(e.calendar_properties?e.calendar_properties.filter((e=>e.visible)).map((e=>e.property)):[]).filter((e=>f.XU({blockValue:i.getValue(),property:e,schema:t,getRecordValue:i.getRecordValue,userTimeZone:k.x7,intl:C.Z.getIntl()})));if(o.length>0)return n()("div",{style:{marginTop:8}},void 0,o.map(this.renderProperty))}}const P=I;var x=i(26435),B=i(26797),A=i(8646),R=i(95009),_=i(83071),L=i(13401),F=i(78948),H=i(16328),E=i(80527),O=i(2107),U=i(57269),D=i(68718),N=i(5366),W=i(15282),V=i(40863),q=i(75498),z=i(12318),G=i(85404);class j extends h.Z{constructor(...e){super(...e),r()(this,"storeTypes",{store:g,resultStore:z.Z.of(void 0)}),r()(this,"renderResults",(()=>{const{disabled:e,collectionStore:t}=this.props,i=this.getCurrentStartOfDay(),o=i.clone().endOf("day"),s=this.getCurrentResults();return n()(R.ZP,{menuType:R.ZP.MenuType.Modal,title:n()("div",{style:j.headerStyle},void 0,n()(E.Z,{onClick:this.handleLeftClick,icon:p.Z.chevronLeft,style:{marginRight:8,marginTop:2},mobileFeedback:!0}),n()("div",{},void 0,i.format("MMMM Do")),n()(E.Z,{onClick:this.handleRightClick,icon:p.Z.chevronRight,style:{marginLeft:8,marginTop:2},mobileFeedback:!0})),right:n()(W.DoneMenuText,{}),onClickRight:this.props.onDismiss},void 0,!s&&n()(_.Z,{},void 0,n()(F.Z,{})),s&&0===s.length&&n()(_.Z,{},void 0,n()(H.Z,{title:n()(N._H,{defaultMessage:"No items",id:"mobileCalendarDayMenu.noResults.message"})})),s&&s.length>0&&n()(_.Z,{},void 0,s.map((e=>{const n=x.Z.createChildStore(t,{id:e.id,table:G.iU});return this.renderItem(n,e,i,o)}))),!e&&n()(_.Z,{topBorder:!0},void 0,n()(L.Z,{focused:!1,onClick:this.handleAddItemClick,title:n()(N._H,{defaultMessage:"New item",id:"mobileCalendarDayMenu.newItemButton.label"})})))})),r()(this,"handleLeftClick",(()=>{const e=this.getCurrentStartOfDay();this.stores.store.setState({...this.stores.store.state,currentStartOfDay:e.clone().add(-1,"day").valueOf()})})),r()(this,"handleRightClick",(()=>{const e=this.getCurrentStartOfDay();this.stores.store.setState({...this.stores.store.state,currentStartOfDay:e.clone().add(1,"day").valueOf()})})),r()(this,"handleAddItemClick",(()=>{const{collectionViewLocalStore:e,collectionStore:t,calendarBy:i,resultsStore:o}=this.props,n=this.getCurrentStartOfDay(),s=A.H5(this.environment,(s=>B.uV({environment:this.environment,collectionStore:t,collectionViewLocalStore:e,calendarBy:i,startOfDay:n.valueOf(),results:o.state,transaction:s}))),r=(0,y.Z)({store:s});this.navigate(r)})),r()(this,"reducerStore",this.createComputedStore((()=>{const{collectionViewLocalStore:e}=this.props;return(0,V.YG)({collectionViewLocalStore:e,startOfDay:this.getCurrentStartOfDay().valueOf()})}),!0)),r()(this,"getRecordValue",this.props.collectionStore.getRecordValue)}navigate(e){this.context.overrideLinkClick?this.context.overrideLinkClick(e):O.c4({environment:this.environment,url:e})}renderComponent(){const{collectionViewLocalStore:e}=this.props,t=this.reducerStore.state;if(t)return n()(q.Z,{id:"calendar_day_results",reducer:t,collectionViewLocalStore:e,render:this.renderResults,resultStore:this.stores.resultStore})}renderItem(e,t,i,o){const{disabled:s,blockPropertyValueOverlayStore:r}=this.props;return n()(P,{store:e,time:t.includeTime?this.renderTime(t,i,o):void 0,disabled:s,format:this.props.format,schema:this.props.schema,blockPropertyValueOverlayStore:r},t.id)}renderTime(e,t,i){const{schema:o,calendarBy:n,intl:s}=this.props,r=o[n];if(!r||"date"!==r.type)return;const a=r.date_format||k.sF,l=r.time_format||k.c_,d=(0,c.Z)(e.start),h=e.end?(0,c.Z)(e.end):void 0,p=Boolean(!d.isBetween(t,i)||h&&!h.isBetween(t,i));if(e.end){const t=k.iC(e.start.valueOf(),e.end?e.end.valueOf():e.start.valueOf(),e.timeZone);return p?(0,U.ZV)({value:t,date_format:a,time_format:l,userTimeZone:e.timeZone,allowRelativeDates:!0,intl:s}):(0,U.ns)({start_time:t.start_time,end_time:t.end_time,time_format:l,humanReadable:!0,intl:s})}return(0,U.mr)({start_time:k.CQ(e.start.valueOf(),e.timeZone).start_time,time_format:l,humanReadable:!0,intl:s})}getCurrentStartOfDay(){const{currentStartOfDay:e}=this.stores.store.state;return e?(0,c.Z)(e):(0,c.Z)(this.props.initialStartOfDay)}getCurrentResults(){const{collectionStore:e,collectionViewLocalStore:t}=this.props,i=this.stores.resultStore.state,o=t.normalizedQueryStore.state,n=t.normalizedSchemaStore.state,s=o?o.calendar_by:void 0;if(!(i&&o&&s&&n))return;let r=l().compact(i.blockIds.map((t=>{const i=x.Z.createChildStore(e,{id:t,table:G.iU});return(0,V.BO)({blockStore:i,calendarBy:s,schema:n,getRecordValue:this.getRecordValue,intl:this.props.intl})})));return o.sort||(r=l().sortBy(r,(e=>e.start))),r}}r()(j,"contextTypes",D.u),r()(j,"headerStyle",{display:"flex",alignItems:"center",height:"100%"});const K=(0,N.XN)(j)},30386:(e,t,i)=>{i.r(t),i.d(t,{default:()=>tn});var o=i(98135),n=i.n(o),s=i(59713),r=i.n(s),a=(i(33948),i(67294)),l=i.n(a),d=i(66832),c=i(41432),h=i(3779),p=i(52315),u=i(26435),m=i(4122),g=i(67154),b=i.n(g),y=i(6404),v=i(89858),S=i(84210),f=i(81997),M=i(52016);class k extends M.Z{getInitialState(){return{open:!1,focused:!1}}}const T=k;var Z=i(28452),w=i(28240),C=i(40515),I=i(92628),P=i(14694),x=i(37235),B=i(79029),A=i(27832),R=i(82990),_=i(5366),L=i(45669);class F extends d.Z{constructor(...e){super(...e),r()(this,"handleClick",(()=>{const{onNavigate:e,store:t}=this.props;e&&e(t)}))}renderComponent(){const{store:e,collectionViewStore:t}=this.props,i=(0,S.Z)({store:e,fullyQualified:!1,collectionViewId:t.id}),o=t.getValue();if(o)return n()(w.Z,{href:i,style:{width:"100%"},onClick:this.handleClick},void 0,n()(P.Z,{icon:this.renderIcon(),style:this.getSidebarItemStyle(),isMobile:this.props.isMobile},void 0,n()(L.Z,{collectionViewName:o.name,collectionViewType:o.type})))}renderIcon(){return n()("div",{style:{...this.getInitialIconStyle()}},void 0,"•")}getInitialIconStyle(){return{fontSize:12,fontWeight:500,color:this.theme.mediumTextColor}}getSidebarItemStyle(){const{device:e}=this.environment;return{...this.isCurrentPage()&&{background:this.theme.buttonHoveredBackground,color:this.theme.regularTextColor,fontWeight:R.Z.fontWeight.semibold,...e.isMobile&&{boxShadow:"\n\t\t\t\t\t\t0 1px 0 ".concat(this.theme.buttonHoveredBackground,"\n\t\t\t\t\t")}},...this.props.style}}isCurrentPage(){const{store:e,collectionViewStore:t}=this.props,{currentBlockStore:i,currentCollectionViewStore:o}=A.Z.state;return i&&e.id===i.id&&o&&o.id===t.id}}const H=(0,_.XN)(F);var E=i(12534);class O extends d.Z{constructor(...e){super(...e),r()(this,"renderCollectionView",(e=>{const{store:t}=this.props;return n()(H,{store:t,collectionViewStore:e,style:this.props.itemStyle,isMobile:this.props.isMobile,onNavigate:this.props.onNavigate},e.id)})),r()(this,"handleContextMenu",(e=>{e.preventDefault(),(0,E.ZP)({event:e,context:E.Af.EditorContextMenu,callback:()=>{}})}))}renderComponent(){const{store:e}=this.props,t=e.getCollectionViewStores();return n()("div",{onContextMenu:this.handleContextMenu},void 0,t.map(this.renderCollectionView))}}const U=O;var D=i(9953),N=i(8646),W=i(50906),V=i(68932),q=i(24677),z=i(21325),G=i(7313),j=i(5210),K=i(14947),Y=i(81844),Q=i(80796),X=i(15157),J=i(99764),$=i(2107),ee=i(22889),te=i(42330),ie=i(94419);class oe extends Z.Z{constructor(...e){super(...e),r()(this,"showAsLoadingSpinner",!1),r()(this,"storeTypes",{outlinerItemStore:T}),r()(this,"toggleOpen",(e=>{this.stores.outlinerItemStore.setState({...this.stores.outlinerItemStore.state,open:e}),this.shouldPersistToggleState()&&X.Z.set({userId:this.environment.currentUser.id,key:this.getLocalStoreKey(),value:e})})),r()(this,"isCurrentPage",this.createComputedStore((()=>{const{store:e}=this.props,{currentBlockStore:t}=A.Z.state;return t&&e.id===t.id}))),r()(this,"handleLinkClick",(()=>{const{store:e}=this.props;W.Yg1(this.environment,{type:this.props.isTopLevelItem?"top_level":"nested"}),this.props.onNavigate&&this.props.onNavigate(e)})),r()(this,"handleMouseMove",(e=>{Q.Z.state.isDragging||this.stores.outlinerItemStore.setState({...this.stores.outlinerItemStore.state,focused:!0})})),r()(this,"handleMouseLeave",(e=>{this.stores.outlinerItemStore.setState({...this.stores.outlinerItemStore.state,focused:!1})})),r()(this,"handleDrop",(async e=>{const{droppedDirection:t,droppedStores:i,duplicate:o}=e,{store:n,type:s,isTopLevelItem:r,parentStore:a}=this.props;await v.Ar({type:s,droppedStores:i,droppedDirection:t})&&a&&N.H5(this.environment,(e=>{v.LQ({environment:this.environment,type:s,targetParentStore:a,targetStore:n,isTopLevelItem:r,droppedDirection:t,droppedStores:i,duplicate:o,transaction:e})}))})),r()(this,"handleShowMenuButtonClick",(e=>{const{store:t}=this.props;q.Ys({environment:this.environment,store:t}),y.Qn({environment:this.environment,stores:[this.props.store],left:e.clientX,top:e.clientY,showInput:!1,actions:G.Oq,analyticsFrom:"sidebar_more_menu"})})),r()(this,"handleToggleClick",(()=>{const{outlinerItemStore:e}=this.stores,t=!e.state.open;W.t8_(this.environment,{type:this.props.isTopLevelItem?"top_level":"nested",is_toggled:t}),this.toggleOpen(t)})),r()(this,"handleInsertBefore",(e=>{const{store:t,type:i}=this.props;return v.LR({environment:this.environment,store:t,insertStores:e.insertStores,parentStore:e.parentStore,before:!0,transaction:e.transaction,type:i})})),r()(this,"handleInsertAfter",(e=>{const{store:t,type:i}=this.props;return v.LR({environment:this.environment,store:t,insertStores:e.insertStores,parentStore:e.parentStore,before:!1,transaction:e.transaction,type:i})})),r()(this,"handleRemove",(e=>{const{store:t}=this.props,i=t.recordStoreParent();i&&ie.Od({remove:t,parent:i,transaction:e.transaction})})),r()(this,"handleRecordIconChange",(e=>{const t=this.getTargetStore();if(!t)return;const i=t.getIconStore();i&&N.H5(this.environment,(t=>{D.sO({store:i,value:e,transaction:t})}))})),r()(this,"handleAddPageButtonClick",(e=>{const{device:t}=this.environment;if((0,z.M_)(this.environment)){this.props.onCreatePage&&this.props.onCreatePage();const e=N.H5(this.environment,(e=>v.D0({environment:this.environment,store:this.props.store,transaction:e})));te.Z.setState({...te.Z.state,lastPageId:A.Z.state.currentBlockStore?A.Z.state.currentBlockStore.id:void 0}),t.isMobile?$._c({environment:this.environment,store:e,showMoveTo:!1,saveParent:!1,visitType:ee.vu.Link}):$.II({environment:this.environment,store:e,showMoveTo:!0,saveParent:!1}),this.props.store.isCollectionView()||this.toggleOpen(!0)}}))}toggleStore(){return this.stores.outlinerItemStore}get registries(){return[Y.Z]}didMount(){if(super.didMount(),this.shouldPersistToggleState()){const e=X.Z.get({userId:this.environment.currentUser.id,key:this.getLocalStoreKey()});this.stores.outlinerItemStore.setState({...this.stores.outlinerItemStore.state,open:e})}const{store:e}=this.props;this.showAsLoadingSpinner="copy_indicator"===e.getType()&&J.n.isPendingTransactionForRecord(e.pointer)}renderPersisted(){const{store:e,isFirstItem:t,type:i,parentStore:o}=this.props,n=e.canRead()&&"copy_indicator"!==e.getType()&&"offline"!==i,s=this.canEdit(),r=n&&o?{onInsertAfter:e=>this.handleInsertAfter({...e,parentStore:o}),onInsertBefore:e=>this.handleInsertBefore({...e,parentStore:o})}:{};return l().createElement(I.Z,b()({analyticsName:"outliner_item",blockMenuActions:G.Oq,canDrag:n,canDropAbove:t,canDropBelow:n,canDropOnto:s,canInsertAfter:n,canInsertBefore:n,canSelect:n,canTriggerContextMenu:!0,onRemove:this.handleRemove,onSelectableDrop:this.handleDrop,shouldShowDropZone:!0,showBlockMenuInput:!1,store:e},r),this.renderItem(),this.shouldShowChildren()&&this.renderOutliner())}renderOutliner(){const{disabled:e}=this.props,t=this.getTargetStore();if(t)return t.isCollectionView()?n()(U,{store:t,itemStyle:this.getSubOutlinerStyle(),isMobile:this.props.isMobile,onNavigate:this.props.onNavigate}):n()(de,{isMobile:this.props.isMobile,type:this.props.type,isTopLevel:!1,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,parentStore:t.getContentStore(),itemStyle:this.getSubOutlinerStyle(),itemToggleStyle:this.props.toggleStyle,onCreatePage:this.props.onCreatePage,onNavigate:this.props.onNavigate,disabled:e})}renderItem(){const{store:e}=this.props;if("copy_indicator"===e.getType())return this.showAsLoadingSpinner?n()(P.Z,{style:this.getSidebarItemStyle(),childrenStyle:oe.sidebarChildrenStyle,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,isMobile:this.props.isMobile},void 0,n()(V.Z,{})):void 0;{let e=n()(P.Z,{style:this.getSidebarItemStyle(),childrenStyle:oe.sidebarChildrenStyle,left:this.renderLeftToggleButton(),icon:this.renderIcon(),right:this.renderRightIcons(),onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,isMobile:this.props.isMobile},void 0,this.isAlias()&&this.renderAliasIcon(),this.renderTitle());const t=this.getURL();return t&&(e=n()(w.Z,{style:{width:"100%"},href:t,onClick:this.handleLinkClick},void 0,e)),e}}renderRightIcons(){const{isMobile:e,store:t}=this.props;if(e||this.stores.outlinerItemStore.state.focused){const e=t.getType()&&this.canEdit();return n()("div",{style:{display:"flex",paddingLeft:3}},void 0,this.renderMenuButton(),e&&this.renderAddPageButton())}}renderAliasIcon(){const{store:e}=this.props;return n()(x.Z,{renderTooltip:()=>e.isCollectionView()?"This is a linked database":"This is a link to the original page",render:e=>l().createElement("div",b()({style:{marginRight:"0.125em"}},e),oe.aliasIcon)})}renderLeftToggleButton(){return n()(j.Z,{isSidebar:!0,fill:!0,open:Boolean(this.stores.outlinerItemStore.state.open),color:this.theme.mediumIconColor,onClick:this.handleToggleClick})}renderAddPageButton(){const{isMobile:e}=this.props;return n()(x.Z,{renderTooltip:()=>n()(_._H,{defaultMessage:"Quickly add a page inside",id:"sidebarItem.addAPageInside.tooltip"}),placement:x.Z.Placement.Bottom,render:t=>l().createElement(K.Z,b()({mobileFeedback:e,style:{...this.getButtonStyle(),marginLeft:e?0:4,...!e&&{border:"1px solid ".concat(this.theme.outlineButtonBorder)}},onClick:this.handleAddPageButtonClick},t),h.Z.plus(this.getButtonIconStyle()))})}renderMenuButton(){const{isMobile:e}=this.props;return n()(x.Z,{renderTooltip:()=>"bookmarks"===this.props.type?n()(_._H,{defaultMessage:"Remove, rename, and more…",id:"sidebarItem.favoritedPageMenuButton.tooltip"}):n()(_._H,{defaultMessage:"Delete, duplicate, and more…",id:"sidebarItem.pageMenuButton.tooltip"}),placement:x.Z.Placement.Bottom,render:t=>l().createElement(K.Z,b()({mobileFeedback:e,style:this.getButtonStyle(),onClick:this.handleShowMenuButtonClick},t),h.Z.dots({...this.getButtonIconStyle(),width:e?18:14}))})}renderIcon(){const e=this.getTargetStore();if(!e)return;const t=e.getIcon(),i=!this.props.isMobile&&this.canEdit()&&!e.isLocked();return n()(x.Z,{renderTooltip:()=>n()(_._H,{defaultMessage:"Change icon",id:"sidebarItem.changeIconButton.tooltip"}),placement:x.Z.Placement.Bottom,render:o=>i?l().createElement(C.Z,b()({bucket:"secure",disabled:!1,icon:t,store:e,title:void 0,isEmptyPage:e.isEmptyPage(),size:this.props.isMobile?24:20,onChange:this.handleRecordIconChange,pageIconStyle:{fill:this.theme.mediumIconColor}},o)):n()(C.Z,{disabled:!0,icon:t,title:void 0,isEmptyPage:e.isEmptyPage(),size:this.props.isMobile?24:20,pageIconStyle:{fill:this.theme.mediumIconColor}})})}renderTitle(){const{store:e}=this.props;return n()(B.Z,{store:e})}shouldPersistToggleState(){return this.props.isTopLevelItem}shouldShowChildren(){return this.stores.outlinerItemStore.state.open}getURL(){const e=this.getTargetStore();if(e){if(e.isNavigableBlock())return(0,S.Z)({store:e,fullyQualified:!1});{const t=f.Dg(e);if(t)return(0,S.Z)({store:t,scrollToBlockId:e.id,fullyQualified:!1})}}}getLocalStoreKey(){const{store:e}=this.props;return"Outliner-".concat(e.id)}isAlias(){const{store:e,parentStore:t,isTopLevelItem:i}=this.props,o=e.getValue();if(e.isCollectionView()){const t=e.getCollectionViewCollectionStore();if(t){const i=t.getValue();if(i&&i.parent_id!==e.id)return!0}}return!(!o||o.type!==c.Z.alias)||!i&&(!!t&&(!!o&&o.parent_id!==t.id))}getTargetStore(){const{store:e}=this.props;return e.getType()===c.Z.alias?e.getAliasTargetStore():e}getPaddingLeftUnit(){return this.props.isMobile?22:14}getSidebarItemStyle(){const{device:e}=this.environment;return{...this.isCurrentPage.state&&{background:this.theme.buttonHoveredBackground,color:this.theme.regularTextColor,fontWeight:R.Z.fontWeight.semibold,...e.isMobile&&{boxShadow:"\n\t\t\t\t\t\t0 1px 0 ".concat(this.theme.buttonHoveredBackground,"\n\t\t\t\t\t")}},...this.props.style}}getSubOutlinerStyle(){const e={...this.props.style},t=this.getSidebarItemStyle(),i="number"==typeof t.paddingLeft?t.paddingLeft:this.getInitialPaddingLeft();return e.paddingLeft=i+this.getPaddingLeftUnit(),e}getInitialPaddingLeft(){return this.props.isMobile?6:14}getButtonStyle(){const{isMobile:e}=this.props;return{display:"flex",alignItems:"center",justifyContent:"center",width:e?32:20,height:e?32:20,borderRadius:3}}getButtonIconStyle(){const{isMobile:e}=this.props;return{fill:e?this.theme.lightIconColor:this.theme.sidebarTextColor,width:e?18:12}}}r()(oe,"aliasIcon",h.Z.alias({width:"1em",height:"1em",marginRight:2})),r()(oe,"sidebarChildrenStyle",{display:"flex",alignItems:"center"});const ne=oe;var se=i(43250),re=i(70203),ae=i(85404);class le extends d.Z{constructor(...e){super(...e),r()(this,"outlinerItemTree",this.createComputedStore((()=>{const{parentStore:e}=this.props,t=[];if(e){const i=u.Z.createChildStore(e,{table:ae.iU,id:e.id});this.getOutlinerItemsInSubtree(i,i,t,new Set)}return t}))),r()(this,"handleCreatePageClick",(async()=>{const{spaceStore:e,spaceViewStore:t,type:i,onCreatePage:o}=this.props;await v.kC({environment:this.environment,spaceStore:e,spaceViewStore:t,type:i,prepend:!1})&&o&&o()})),r()(this,"handleEmptyDrop",(async e=>{const{droppedDirection:t,droppedStores:i,duplicate:o}=e,{type:n,isTopLevel:s,parentStore:r}=this.props;if(r){await v.Ar({type:n,droppedStores:i,droppedDirection:t})&&N.H5(this.environment,(e=>{v.LQ({environment:this.environment,type:n,targetParentStore:r,isTopLevelItem:s,droppedDirection:t,droppedStores:i,duplicate:o,transaction:e})}))}}))}renderComponent(){const{device:e}=this.environment,{parentStore:t,isTopLevel:i,childStores:o,disabled:s}=this.props;let r=[],a=!1;if(o)r=o.map(((e,i)=>this.renderPageItem(e,!0,i,t))),a=!0;else if(t){const e=u.Z.createChildStore(t,{table:ae.iU,id:t.id});r=this.outlinerItemTree.state,a=p.b(e)}const l=0===r.length,d=(l||this.props.isHeaderless||e.isMobile)&&this.props.showAddPageButton&&!s,c=l&&!d&&!i,h={offline:se.bl,bookmarks:se.fe,workspace:se.BE,shared:se.Jk,private:se.q1}[this.props.type];return n()(m.Z,{style:this.props.style,className:h,loaded:a,showSpinnerTimeout:3e3,spinnerSize:"1em"},void 0,r,l&&i&&this.renderEmptyDroppable(),d&&this.renderAddPageButton(),c&&this.renderEmptyChildrenPlaceholder())}renderEmptyChildrenPlaceholder(){const{device:e}=this.environment;return n()(P.Z,{style:this.props.itemStyle,isMobile:this.props.isMobile},void 0,n()("div",{style:{color:this.theme.lightTextColor,paddingLeft:12,...e.isMobile&&{display:"flex",alignItems:"center",height:32}}},void 0,n()(_._H,{defaultMessage:"No pages inside",id:"outliner.NoPagesInside.placeholder"})))}renderAddPageButton(){return n()(K.Z,{mobileFeedback:this.props.isMobile,onClick:this.handleCreatePageClick},void 0,n()(P.Z,{style:{color:this.theme.mediumTextColor},left:this.getPlusIcon(),isMobile:this.props.isMobile,disableMobileBorder:!0},void 0,this.props.addPageTitle))}renderPageItem(e,t,i,o){return n()(ne,{isMobile:this.props.isMobile,type:this.props.type,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,store:e,style:this.props.itemStyle,toggleStyle:this.props.itemToggleStyle,isFirstItem:0===i,isTopLevelItem:t,parentStore:o,onNavigate:this.props.onNavigate,onCreatePage:this.props.onCreatePage,disabled:this.props.disabled},e.id)}renderEmptyDroppable(){const{currentBlockStore:e}=A.Z.state;if(e){const t=u.Z.createChildStore(this.props.spaceStore,e.pointer);return n()(I.Z,{store:t,canDropBelow:!0,onSelectableDrop:this.handleEmptyDrop,analyticsName:"outliner_item",shouldShowDropZone:!0})}}getPlusIcon(){return n()("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},void 0,h.Z.plus({fill:this.theme.mediumIconColor,width:16,height:16}))}getOutlinerItemsInSubtree(e,t,i,o){let n=!0;const s=e.getType();if(!o.has(e.id)&&(o.add(e.id),s&&le.shouldSkipItemTypes[s]?n=!1:s&&e!==t&&le.shouldShowItemTypes[s]&&(n=!1,i.push(this.renderPageItem(e,!1,i.length,e.recordStoreParent()))),n)){const n=e.getType()===c.Z.transclusionReference?e.getTransclusionReferenceTargetStore():e;if(!n)return;const s=n.getContentStores();for(const e of s){const n=e.getValue();if(n&&n.properties){const t=n.properties.title,o=re.jD(t);if(o)for(const s of o){const t=u.Z.createChildStore(e,{table:ae.iU,id:s});t.getParentId()===n.id&&i.push(this.renderPageItem(t,!1,i.length,t.recordStoreParent()))}}this.getOutlinerItemsInSubtree(e,t,i,o)}}}}r()(le,"shouldShowItemTypes",{[c.Z.page]:!0,[c.Z.collectionView]:!0,[c.Z.collectionViewPage]:!0,[c.Z.alias]:!0}),r()(le,"shouldSkipItemTypes",{[c.Z.factory]:!0});const de=le;var ce=i(87531),he=i(592),pe=i(96486),ue=i.n(pe),me=i(39634),ge=i(95477),be=i(46167),ye=i(98742),ve=i(25584),Se=i(83071),fe=i(48762),Me=i(95009),ke=i(84908),Te=i(89101),Ze=i(475),we=i(58455);class Ce extends M.Z{getInitialState(){return{showUpdateInfo:!1}}}const Ie=Ce;var Pe=i(57491),xe=i(11342),Be=i(86646),Ae=i(17256);class Re extends d.Z{constructor(...e){super(...e),r()(this,"storeTypes",{store:Ie}),r()(this,"renderUpdateInfo",(()=>{const{AppUpdateStore:e}=this.environment,t=e.state.appUpdate?this.renderUpdateState("App.js - ",e.state.appUpdate):n()(_._H,{defaultMessage:"App.js - Waiting…",id:"appVersionMenuItem.waitingForAppJsUpdate.message"}),i=e.state.electronUpdate&&this.renderUpdateState("Electron - ",e.state.electronUpdate);return n()("div",{},void 0,t,i)})),r()(this,"handleResetCache",(()=>{const{AppUpdateStore:e,mobileNative:t}=this.environment;e.setState({appUpdate:void 0,electronUpdate:e.state.electronUpdate}),t&&t.resetAssetCache()})),r()(this,"handleShowUpdateInfo",(()=>{this.stores.store.setState({showUpdateInfo:!0})}))}renderComponent(){const{device:e}=this.environment,t="Notion 2.11.".concat(ge.Z.version),i=n()(_._H,{id:"appVersionMenuItem.lastUpdatedTime.menuItem",defaultMessage:"Updated {lastUpdatedTime}",description:"Message to tell the user when their current version of the Notion app was last updated.",values:{lastUpdatedTime:(0,Ae.Z)(ge.Z.lastUpdatedTime).fromNow()}});let o=n()(l().Fragment,{},void 0,t,n()("br",{}),i);if(e.isMobileNative){const e=Pe.c0(),s=n()(_._H,{defaultMessage:"Mobile {reactNativeVersionFormatted}",values:{reactNativeVersionFormatted:(0,xe.ko)(e)},id:"appVersionMenuItem.lastUpdatedReactNativeVersion.menuItem"});o=n()(l().Fragment,{},void 0,t,n()("br",{}),s,n()("br",{}),i)}if(e.isElectron){const e=ke.zF(),s=n()(_._H,{defaultMessage:"Desktop {desktopVersionFormatted}",values:{desktopVersionFormatted:(0,xe.ko)(e)},id:"appVersionMenuItem.desktopVersion.menuItem"});o=n()(l().Fragment,{},void 0,t,n()("br",{}),s,n()("br",{}),i)}const s=ge.Z.isLocalhost||"local"===ge.Z.env||"development"===ge.Z.env;if(e.isMobile){const e=s&&this.stores.store.state.showUpdateInfo&&n()("div",{},void 0,this.renderUpdateInfo(),n()(K.Z,{style:{paddingTop:4},onClick:this.handleResetCache},void 0,n()(_._H,{defaultMessage:"Clear cache",id:"appVersionMenuItem.mobile.clearCache.message"})));return n()(Be.Z,{caption:n()("div",{style:{color:this.theme.lightTextColor}},void 0,n()("div",{style:{userSelect:"none",WebkitUserSelect:"none"}},void 0,o),e),onClick:s?this.handleShowUpdateInfo:void 0})}return s?n()(x.Z,{renderTooltip:this.renderUpdateInfo,placement:x.Z.Placement.Left,render:e=>l().createElement(Be.Z,b()({caption:n()("div",{style:{color:this.theme.lightTextColor}},void 0,o)},e))}):n()(Be.Z,{caption:n()("div",{style:{color:this.theme.lightTextColor}},void 0,o)})}renderUpdateState(e,t){return"checking"===t.state?n()("div",{},void 0,e," ",n()(_._H,{defaultMessage:"Checking for updates…",id:"appVersionMenuItem.updateStateForApp.checking.message"})):"no-update"===t.state?n()("div",{},void 0,e," ",n()(_._H,{defaultMessage:"No update {timeFromNow}",id:"appVersionMenuItem.noUpdatesForApp.message",description:"timeFromNow is a translated message like '2 hours ago' that refers to the time of the last update.",values:{timeFromNow:(0,Ae.Z)(t.timestamp).fromNow()}})):"downloading"===t.state?n()("div",{},void 0,e," ",n()(_._H,{defaultMessage:"Downloading {version} {percentComplete}",id:"appVersionMenuItem.downloadingUpdate.message",values:{percentComplete:this.props.intl.formatNumber(t.progress,{style:"percent",maximumFractionDigits:0}),version:(0,xe.ko)(t.version)}})):"ready"===t.state?n()("div",{},void 0,e," ",n()(_._H,{defaultMessage:"Update ready {version}",id:"appVersionMenuItem.updateReady.message",values:{version:(0,xe.ko)(t.version)}})):"error"===t.state?n()("div",{},void 0,e," ",n()(_._H,{defaultMessage:"Update error {errorMessage}",id:"appVersionMenuitem.updateError.message",values:{errorMessage:t.error&&t.error.message}})):void 0}}const _e=(0,_.XN)(Re);var Le=i(97148),Fe=i(1643),He=i(57623),Ee=i(74350);const Oe=function(e){const{locale:t,children:i}=e;return t===Ee.SP?n()(l().Fragment,{},void 0,i):null};var Ue=i(5188),De=i(75009),Ne=i(66205),We=i(85419),Ve=i(45094),qe=i(51454),ze=i(71802),Ge=i(92933);function je(e,t){const{theme:i,rightEdgeDistance:o}=t,{device:n}=e,s=(0,Ve.TO)(e);return{position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",background:i.buttonBackground,bottom:16+n.scrollbarWidth,right:o+n.scrollbarWidth,width:36,height:36,borderRadius:"100%",fontSize:20,boxShadow:i.lightBoxShadow,zIndex:qe.hT,opacity:ze.tu.state?0:1,transform:"translateX(-".concat(s,"px) translateZ(0)"),transition:"\n\t\t\topacity ".concat(Ge.Z.transitionDuration,"ms,\n\t\t\tcolor ").concat(Ge.Z.transitionDuration,"ms,\n\t\t\ttransform 200ms\n\t\t")}}var Ke=i(37181),Ye=i(41892);class Qe extends M.Z{getInitialState(){return{currentOpenStageIndex:void 0,stages:[{id:"what_is_notion",sections:[{type:"title",content:"What is Notion?"},{type:"text",content:"blah"},{type:"video",content:"https://www.youtube.com/embed/oTahLEX3NXo"},{type:"text",content:"more blah"},{type:"image",content:Ye.Z.images.gifs.followPageGif}]},{id:"create_pages"},{id:"slash_and_blocks"},{id:"share_your_work"},{id:"collaborate_with_others"},{id:"tips_and_tricks"}]}}getStageIndex(e){return this.state.stages.findIndex((t=>t.id===e))}getStage(e){if(!(e>=this.state.stages.length))return this.state.stages[e]}}new Qe;i(64875);var Xe=i(61766);const Je=new Xe.Z;class $e extends d.Z{constructor(...e){super(...e),r()(this,"renderOrigin",(e=>this.props.isMobile?l().createElement(K.Z,b()({hovered:Ze.Z.state.open,mobileFeedback:this.props.isMobile},e),n()(P.Z,{isMobile:this.props.isMobile,left:h.Z.help({fill:this.theme.mediumIconColor,width:16,height:16}),disableMobileBorder:!0},void 0,n()(_._H,{defaultMessage:"Help & feedback",id:"helpButton.mobileHelpFeedbackButton.label"}))):l().createElement(l().Fragment,null,n()(x.Z,{renderTooltip:()=>n()("span",{},void 0,n()(_._H,{defaultMessage:"Help, feedback, and {br}keyboard shortcuts",id:"helpButton.desktopHelpButton.tooltip",values:{br:n()("br",{})}})),render:t=>l().createElement(K.Z,b()({className:"notion-help-button",style:je(this.environment,{theme:this.theme,rightEdgeDistance:16}),hoveredStyle:{background:this.theme.whiteButtonHoveredBackground},pressedStyle:{background:this.theme.whiteButtonPressedBackground}},(0,ye.Z)(e,t)),"?")})))),r()(this,"renderMessageItem",(e=>{const{device:t}=this.environment;return t.isElectron?this.renderMessageButton(e):n()(x.Z,{renderTooltip:()=>this.renderIntercomTooltip(),delayThreshold:0,placement:x.Z.Placement.Right,render:t=>this.renderMessageButton((0,ye.Z)(e,t))},e.key)})),r()(this,"renderSalesItem",(e=>{const{device:t}=this.environment;return t.isElectron?this.renderSalesButton(e):n()(x.Z,{renderTooltip:()=>this.renderIntercomTooltip(),delayThreshold:0,placement:x.Z.Placement.Right,render:t=>this.renderSalesButton((0,ye.Z)(e,t))},e.key)})),r()(this,"renderGuideItem",(e=>l().createElement(fe.Z,b()({},e,{isTokenTitle:!0,icon:h.Z.helpButtonGuide(this.getIconStyle()),title:n()(_._H,{defaultMessage:"Help & support guide",id:"helpButton.helpSupportGuide.menuItem"})})))),r()(this,"renderMessageButton",(e=>l().createElement(fe.Z,b()({},e,{isTokenTitle:!0,icon:h.Z.helpButtonMessage(this.getIconStyle()),title:n()(_._H,{defaultMessage:"Send us a message",id:"helpButton.sendMessage.menuItem"})})))),r()(this,"renderCsatButton",(e=>l().createElement(fe.Z,b()({},e,{isTokenTitle:!0,icon:h.Z.feedback(this.getIconStyle()),title:n()(_._H,{defaultMessage:"Give feedback",id:"helpButton.giveFeedback.menuItem"})})))),r()(this,"renderOnboardingChecklistItem",(e=>l().createElement(fe.Z,b()({},e,{isTokenTitle:!0,icon:h.Z.onboardingUseCaseNotebook(this.getIconStyle()),title:n()(_._H,{defaultMessage:"Getting started",id:"helpButton.onboardingChecklist.menuItem"})})))),r()(this,"renderSalesButton",(e=>l().createElement(fe.Z,b()({},e,{isTokenTitle:!0,icon:h.Z.helpButtonSales(this.getIconStyle()),title:n()(_._H,{defaultMessage:"Chat with sales",id:"helpButton.salesChat.menuItem"})})))),r()(this,"renderJoinUsItem",(e=>n()(Oe,{locale:"en-US"},void 0,l().createElement(fe.Z,b()({},e,{title:n()(_._H,{defaultMessage:"Join us",id:"helpButton.joinUs.menuItem"})}))))),r()(this,"renderKeyboardShortcutsItem",(e=>l().createElement(fe.Z,b()({},e,{title:n()(_._H,{defaultMessage:"Keyboard shortcuts",id:"helpButton.keyboardShortcuts.menuItem"})})))),r()(this,"renderNewsItem",(e=>l().createElement(fe.Z,b()({},e,{title:n()(_._H,{defaultMessage:"What's new?",id:"helpButton.whatsNew.menuItem"})})))),r()(this,"renderTermsItem",(e=>{const{device:t}=this.environment;return t.isMobile?l().createElement(fe.Z,b()({},e,{title:"Terms & privacy"})):l().createElement(fe.Z,b()({},e,{caption:"Terms & privacy"}))})),r()(this,"renderTwitterItem",(e=>{const{device:t}=this.environment;return t.isMobile?l().createElement(fe.Z,b()({},e,{title:n()(_._H,{defaultMessage:"Twitter – @{notionHandle}",id:"helpButton.mobileTwitter.menuItem",values:{notionHandle:"NotionHQ"}})})):l().createElement(fe.Z,b()({},e,{caption:n()(_._H,{defaultMessage:"Twitter – @{notionHandle}",id:"helpButton.twitter.menuItem",values:{notionHandle:"NotionHQ"}})}))})),r()(this,"renderStatusItem",(e=>{const{device:t}=this.environment;return t.isMobile?l().createElement(fe.Z,b()({},e,{title:"Status"})):l().createElement(fe.Z,b()({},e,{caption:"Status"}))})),r()(this,"acceptMessageItem",(()=>{this.analyticsTrackClickItem("help_feedback"),me.O({environment:this.environment,from:"help_button"}),this.closePopup()})),r()(this,"acceptSalesItem",(()=>{this.analyticsTrackClickItem("sales_chat");const{currentUserStore:e}=A.Z.state,t=e&&e.getValue();Ne.Z.setState({open:!0,email:t&&t.email,name:t&&(0,We.Nz)(this.props.intl,t)}),this.closePopup()})),r()(this,"acceptCsatItem",(()=>{this.analyticsTrackClickItem("csat"),Ue.Z.setState({open:!0,type:De.og}),this.closePopup()})),r()(this,"acceptOnboardingChecklistItem",(()=>{var e;const{currentUserSettingsStore:t}=A.Z.state;this.analyticsTrackClickItem("onboarding-checklist");const i=null==t||null===(e=t.getSettings())||void 0===e?void 0:e.onboarding_checklist_settings;t&&i&&("open"!==i.onboarding_checklist_visibility&&N.H5(this.environment,(e=>{(0,Ke.d2)({userSettingsStore:t,transaction:e,data:{onboarding_checklist_settings:{...i,onboarding_checklist_visibility:"open"}}})})),Je.setState({...Je.state,open:!0}),this.closePopup())})),r()(this,"acceptGuideItem",(()=>{this.analyticsTrackClickItem("guides"),$.Db({environment:this.environment,url:(0,He.U)("guides.guides")}),this.closePopup()})),r()(this,"acceptKeyboardShortcutsItem",(()=>{this.analyticsTrackClickItem("keyboard_shortcuts"),$.Db({environment:this.environment,url:(0,He.U)("guides.keyboardShortcuts")}),this.closePopup()})),r()(this,"acceptTwitterItem",(()=>{this.analyticsTrackClickItem("twitter"),$.Db({environment:this.environment,url:Te._j.notionTwitter}),this.closePopup()})),r()(this,"acceptStatusItem",(()=>{this.analyticsTrackClickItem("status"),$.Db({environment:this.environment,url:Te._j.statusPage}),this.closePopup()})),r()(this,"acceptJoinUsItem",(()=>{this.analyticsTrackClickItem("join_us"),$.Db({environment:this.environment,url:Te._j.careers}),this.closePopup()})),r()(this,"acceptNewsItem",(()=>{$.Db({environment:this.environment,url:Te._j.whatsNew}),this.analyticsTrackClickItem("whats_new"),this.closePopup()})),r()(this,"acceptTermsItem",(()=>{$.Db({environment:this.environment,url:Te._j.termsAndPrivacy}),this.analyticsTrackClickItem("terms"),this.closePopup()})),r()(this,"trackClickHelp",(()=>{W.Ar6(this.environment)}))}renderComponent(){const{device:e}=this.environment,t=this.props.isMobile;return n()(be.Z,{popupType:e.isMobile?be.Z.PopupType.SlideUp:be.Z.PopupType.Popup,renderOrigin:this.renderOrigin,originGap:t?0:12,placementToOrigin:t?be.Z.Placement.Right:be.Z.Placement.Top,alignmentToOrigin:t?be.Z.Alignment.Center:be.Z.Alignment.End,buttonPopupStore:Ze.Z,onClick:this.trackClickHelp,render:()=>{const t=this.getSections();let i;return i=e.isMobile?{menuType:Me.ZP.MenuType.ActionSheet}:{menuType:Me.ZP.MenuType.Popup,minWidth:208},l().createElement(Me.ZP,i,n()(ve.Z,{type:ve.Z.Type.Vertical,initialFocus:void 0,sections:t}))}})}getSections(){const{device:e}=this.environment,t=Fe.CM(this.environment),i="team"===t||"enterprise"===t,o=!we.Z.state.isIntercomEnabled||(0,Fe.t)(this.environment)&&"on"===Le.Z.getGroup(this.environment,"hazelnut"),n="on"===Le.Z.getGroup(this.environment,"csat")&&!this.environment.device.isMobile,s="on"===Le.Z.getGroup(this.environment,"onboarding-checklist");return ue().compact([{key:"guide",render:e=>l().createElement(Se.Z,e),items:ue().compact([{key:"guide",action:this.acceptGuideItem,render:this.renderGuideItem},o?void 0:{key:"message",action:this.acceptMessageItem,render:this.renderMessageItem},i?{key:"sales",action:this.acceptSalesItem,render:this.renderSalesItem}:void 0,n?{key:"csat",action:this.acceptCsatItem,render:this.renderCsatButton}:void 0,s?{key:"onboarding-checklist",action:this.acceptOnboardingChecklistItem,render:this.renderOnboardingChecklistItem}:void 0])},{key:"middle section",render:e=>l().createElement(Se.Z,b()({},e,{topBorder:!0})),items:ue().compact([{key:"keyboardshortcut",action:this.acceptKeyboardShortcutsItem,render:this.renderKeyboardShortcutsItem},{key:"news",action:this.acceptNewsItem,render:this.renderNewsItem},{key:"join-us",action:this.acceptJoinUsItem,render:this.renderJoinUsItem}])},{key:"botttom section",render:e=>l().createElement(Se.Z,b()({},e,{topBorder:!0})),items:ue().compact([{key:"twitter",action:this.acceptTwitterItem,render:this.renderTwitterItem},{key:"terms",action:this.acceptTermsItem,render:this.renderTermsItem},{key:"status",action:this.acceptStatusItem,render:this.renderStatusItem},e.isElectron&&"production"!==ge.Z.env?{key:"devtools",action:ke.d8,render:e=>l().createElement(fe.Z,b()({},e,{caption:"Open Dev Tools"}))}:void 0])},{key:"version",render:e=>l().createElement(Se.Z,b()({},e,{topBorder:!0})),items:ue().compact([{key:"version",action:()=>{},render:e=>l().createElement(_e,e)}])}])}renderIntercomTooltip(){return n()("span",{},void 0,n()(_._H,{defaultMessage:"We use Intercom for messaging.{br}Make sure it's not blocked by your browser.",values:{br:n()("br",{})},id:"helpButton.sendUsAMessage.tooltip"}))}analyticsTrackClickItem(e){W.Vaw(this.environment,{item:e})}closePopup(){Ze.Z.setState({...Ze.Z.state,open:!1})}getIconStyle(){return{width:16,height:16,color:this.theme.regularTextColor,fill:this.theme.regularTextColor}}}const et=(0,_.XN)($e);var tt=i(31792),it=i(70704),ot=i(97880);class nt extends d.Z{constructor(...e){super(...e),r()(this,"storeTypes",{mouseStore:tt.Z,labelMouseStore:tt.Z,outlinerToggleButtonStore:it.Z}),r()(this,"headerRef",l().createRef()),r()(this,"handleHideClick",(()=>{const{isHidden:e}=this.stores.outlinerToggleButtonStore.state,t=!e;v.Eo({spaceViewStore:this.props.spaceViewStore,type:this.props.type,outlinerToggleButtonStore:this.stores.outlinerToggleButtonStore,newValue:t})})),r()(this,"handleCreatePageClick",(()=>{const{type:e,spaceStore:t,spaceViewStore:i}=this.props,{outlinerToggleButtonStore:o}=this.stores;v.kC({environment:this.environment,spaceStore:t,spaceViewStore:i,type:e,outlinerToggleButtonStore:o,prepend:!0})}))}willMount(e){super.willMount(e);const t=X.Z.get({userId:this.environment.currentUser.id,key:v.B8(e.spaceViewStore,e.type)});t&&this.stores.outlinerToggleButtonStore.setState({...this.stores.outlinerToggleButtonStore.state,isHidden:t})}renderComponent(){const{renderSidebar:e}=this.props,{isHidden:t}=this.stores.outlinerToggleButtonStore.state;return l().createElement("div",{ref:this.headerRef,onMouseMove:()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0}),onMouseLeave:()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1}),style:{marginBottom:t?0:nt.marginBottom}},this.renderLabel(),!t&&e(this.headerRef))}renderLabel(){const{showAddPageButton:e}=this.props,{isHidden:t}=this.stores.outlinerToggleButtonStore.state,{labelMouseStore:i}=this.stores,{mouseEntered:o}=i.state,s={bookmarks:se.F4,workspace:se.j3,shared:se.MU,private:se.aL,offline:se.yN}[this.props.type],r=n()(_._H,t?{defaultMessage:"Click to show section",id:"sidebar.sectionHeaderShow.tooltip"}:{defaultMessage:"Click to hide section",id:"sidebar.sectionHeaderHide.tooltip"});return n()(P.Z,{className:s,isMobile:this.props.isMobile,disableMobileBorder:t,shouldShowMobileMarginBotton:t,style:this.getSectionSidebarItemStyle(),childrenStyle:{overflow:"visible"},right:e&&this.renderAddPageButton()},void 0,n()("div",{style:{display:"flex",alignItems:"center"}},void 0,n()(x.Z,{style:nt.tooltipStyle,textWrap:!0,renderTooltip:()=>n()("div",{},void 0,n()("div",{},void 0,r),n()("span",{style:{color:this.theme.mediumInvertedTextColor,whiteSpace:"nowrap"}},void 0,this.props.labelTooltip)),placement:x.Z.Placement.Top,render:e=>{const t={...this.props.isMobile?this.getMobileSectionLabelStyle():this.getSectionLabelStyle(),transition:"color 100ms ease-out"};return o&&Object.assign(t,this.getSectionLabelHoverStyles()),l().createElement(K.Z,b()({mobileFeedback:this.props.isMobile,style:this.getLabelButtonStyle(),onClick:this.handleHideClick},(0,ye.Z)(e,{onMouseMove:()=>i.setState({...i.state,mouseEntered:!0}),onMouseLeave:()=>i.setState({...i.state,mouseEntered:!1})})),n()("span",{style:t},void 0,this.renderLabelContent()))}})))}renderAddPageButton(){return n()(x.Z,{style:nt.tooltipStyle,textWrap:!0,renderTooltip:()=>n()(a.Fragment,{},void 0,n()(_._H,{defaultMessage:"Add a page",id:"sidebar.addAPageButton.tooltip"}),n()("br",{}),n()("span",{style:{color:this.theme.mediumInvertedTextColor}},void 0,this.props.labelTooltip)),placement:x.Z.Placement.Right,render:e=>l().createElement(K.Z,b()({style:this.getPlusButtonStyle(),mobileFeedback:this.props.isMobile,onClick:this.handleCreatePageClick,className:se.Ji},e),h.Z.plus({fill:this.theme.mediumIconColor,width:12,height:12}))})}renderLabelContent(){const{type:e}=this.props;switch(e){case"bookmarks":return n()(_._H,{defaultMessage:"Favorites",id:"sidebar.favoritesSection.header"});case"workspace":return n()(_._H,{defaultMessage:"Workspace",id:"sidebar.workspaceSection.header"});case"private":return n()(_._H,{defaultMessage:"Private",id:"sidebar.privateSection.header"});case"shared":return n()(_._H,{defaultMessage:"Shared",id:"sidebar.sharedSection.header"});case"offline":return n()(_._H,{defaultMessage:"Offline",id:"sidebar.offlineSection.header"});default:(0,ot.t1)(e)}}getSectionSidebarItemStyle(){return{paddingTop:0,paddingBottom:0,paddingRight:14,paddingLeft:15,minHeight:24}}getSectionLabelStyle(){return{letterSpacing:"0.03em",textTransform:"uppercase",fontSize:11.5,lineHeight:1,marginBottom:1,color:this.theme.lightTextColor,fontWeight:R.Z.fontWeight.semibold}}getMobileSectionLabelStyle(){return{textTransform:"uppercase",fontSize:13,lineHeight:1,color:this.theme.lightTextColor,fontWeight:R.Z.fontWeight.semibold}}getSectionLabelHoverStyles(){return{color:this.theme.mediumTextColor}}getLabelButtonStyle(){return{display:"flex",alignItems:"center",borderRadius:3,padding:"2px 4px",marginLeft:-4,...this.props.isMobile&&{marginBottom:8}}}getPlusButtonStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3,height:20,width:20,border:"1px solid ".concat(this.theme.outlineButtonBorder)}}}r()(nt,"tooltipStyle",{minWidth:200}),r()(nt,"marginBottom",20);const st=nt;var rt=i(43339),at=i(72087),lt=i(7765),dt=i(12235),ct=i(92166),ht=i(76668),pt=i(73581),ut=i(66957),mt=i(46034),gt=i(16328),bt=i(24042),yt=i(39865),vt=i(1800),St=i(31299),ft=i(88632),Mt=i(11689),kt=i(42001),Tt=i(83182),Zt=i(46247),wt=i(33929),Ct=i(15282),It=i(17215);const Pt=(0,_.vU)({filterByPlaceholder:{id:"sidebarTrash.filterBy.placeholder",defaultMessage:"Filter by page title…"}});class xt extends d.Z{constructor(...e){super(...e),r()(this,"storeTypes",{requestStore:at.Z}),r()(this,"renderTrashPages",((e,t)=>{const{device:i}=this.environment,o=t?t.results:[],{currentBlockStore:s}=A.Z.state;if(!s)return;const r=o.map((e=>u.Z.createChildStore(s,{table:ae.iU,id:e}))).filter((e=>e.getValue()&&!rt.Z.state.excludePages.has(e.id))).map((e=>({key:e.id,action:({event:t})=>{if(t.metaKey){const t=(0,vt.Z)({baseUrl:ge.Z.domainBaseUrl,pageId:e.id});$.Db({environment:this.environment,url:t})}else $._c({environment:this.environment,store:e}),Mt.Z.setState({...Mt.Z.state,open:!1});i.isMobile&&ht.xv()},render:t=>l().createElement(bt.Z,b()({},t,{dontShrinkRight:!0,store:e,right:n()("div",{style:{display:"flex"}},void 0,n()(x.Z,{placement:x.Z.Placement.Bottom,renderTooltip:()=>n()(_._H,{defaultMessage:"Restore",id:"sidebarTrash.restorePageButton.tooltip"}),render:t=>l().createElement(kt.Z,b()({isGray:!0,onClick:()=>this.handleRestoreClick(e)},t),h.Z.undo({width:18,height:18}))}),n()(x.Z,{placement:x.Z.Placement.Bottom,renderTooltip:()=>n()(_._H,{defaultMessage:"Delete permanently",id:"sidebarTrash.deletePagePermanentlyButton.tooltip"}),render:t=>l().createElement(kt.Z,b()({isGray:!0,onClick:()=>this.handleDeleteClick(e)},t),h.Z.trash({width:18,height:18}))}))}))})));return 0===r.length?n()(Se.Z,{},void 0,i.isMobile?n()(gt.Z,{title:n()(_._H,{defaultMessage:"No matches found.",id:"sidebarTrash.mobileFilterBy.noMatchesPrompt"})}):n()("div",{style:{fontSize:14,color:this.theme.mediumTextColor,textAlign:"center"}},void 0,n()(_._H,{defaultMessage:"No matches found.",id:"sidebarTrash.filterBy.noMatchesPrompt"}))):n()(a.Fragment,{},void 0,n()(ve.Z,{type:ve.Z.Type.Vertical,initialFocus:void 0,sections:[{key:0,items:r,render:e=>l().createElement(Se.Z,e)}]}),n()(ct.Z,{show:this.stores.requestStore.state.loading,showDelay:500,showHold:200,render:e=>{if(e)return n()("div",{style:{height:44,display:"flex",flex:1,alignItems:"center",justifyContent:"center"}},void 0,n()(V.Z,{}))}}),n()(dt.Z,{onChange:this.handleScrollOffsetChange}))})),r()(this,"handleSwipeLeft",(()=>{const e=xt.tabs.indexOf(rt.Z.state.currentTab)+1,t=xt.tabs[e];void 0!==t&&this.changeTab(t)})),r()(this,"handleSwipeRight",(()=>{const e=xt.tabs.indexOf(rt.Z.state.currentTab)-1,t=xt.tabs[e];void 0!==t&&this.changeTab(t)})),r()(this,"handleTabChange",(e=>{const t=xt.tabs[e];this.changeTab(t)})),r()(this,"handleRestoreClick",(e=>{const{currentSpaceStore:t}=A.Z.state;t&&yt.cB({environment:this.environment,block:e,spaceId:e.pointer.spaceId||t.id})})),r()(this,"handleDeleteClick",(e=>{yt.Rn({environment:this.environment,blocks:[e]})})),r()(this,"handleSearchInputChange",(e=>{rt.Z.setState({...rt.Z.state,filter:e.target.value,limit:rt.Z.startLimit})})),r()(this,"handleClose",(()=>{Mt.Z.setState({...Mt.Z.state,open:!1})})),r()(this,"handleScrollOffsetChange",(e=>{const{requestStore:t}=this.stores,{ready:i,loading:o,result:n}=t.state,s=n;e<=rt.Z.loadMoreOffset&&s&&i&&!o&&!s.endOfResultsReached&&rt.Z.setState({...rt.Z.state,limit:rt.Z.state.limit+rt.Z.limitIncrement})})),r()(this,"performSearchRequest",(async e=>{const{currentSpaceStore:t,currentBlockStore:i}=A.Z.state;if(!t||!i)return;const{limit:o,filter:n,currentTab:s}=rt.Z.state;let r;if("in_current_page"===s)if(i.isCollectionView()){const e=i.getValue();if(!e)return;const t=(0,It.kW)(e);if(!t)return;r=t.id}else r=i.id;return await St.bI({environment:this.environment,query:n,limit:o,ancestorId:r,spaceId:t.id})}))}willMount(e){super.willMount(e),rt.Z.setState({...rt.Z.state,filter:"",limit:rt.Z.startLimit,excludePages:new Set})}renderComponent(){const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:Me.ZP.MenuType.Modal,title:n()(_._H,{defaultMessage:"Trash",id:"sidebarTrash.menu.header"}),left:this.renderMobileHelpButton(),right:n()(Ct.DoneMenuText,{}),onClickRight:this.handleClose,header:this.renderHeader()}:{menuType:Me.ZP.MenuType.Popup,height:"50vh",width:414,header:this.renderHeader(),footer:this.renderFooter()},n()(mt.Z,{onSwipeLeft:this.handleSwipeLeft,onSwipeRight:this.handleSwipeRight,render:e=>l().createElement(Me.ZP,b()({},t,e,{className:se.TY}),this.renderPages())})}renderHeader(){const{device:e}=this.environment,t=rt.Z.state.currentTab,i=xt.tabs.indexOf(t);return n()(a.Fragment,{},void 0,n()(ut.Z,{tabs:[n()(_._H,{defaultMessage:"All pages",id:"sidebarTrash.allPages.tabHeader"}),n()(_._H,{defaultMessage:"In current page",id:"sidebarTrash.inCurrentPage.tabHeader"})],selectedIndex:i,onChange:this.handleTabChange}),n()("div",{style:{margin:e.isMobile?0:"10px 0"}},void 0,n()(pt.Z,{left:n()(ct.Z,{show:this.stores.requestStore.state.loading,showDelay:500,showHold:200,render:e=>e?n()(V.Z,{style:this.getSearchIconStyle()}):h.Z.searchThick(this.getSearchIconStyle())}),style:{...e.isAndroid&&{borderBottom:"none"}},showClearButton:!0,placeholder:wt.Z.formatMessage(Pt.filterByPlaceholder),focus:!e.isMobile||void 0,value:rt.Z.state.filter,onChange:this.handleSearchInputChange})))}renderFooter(){return n()(Se.Z,{topBorder:!0,disableDesktopPadding:!0},void 0,n()(Tt.Z,{title:n()(_._H,{defaultMessage:"Learn about deleting and restoring pages",id:"sidebarTrash.learnMore.prompt"}),href:(0,He.U)("guides.trash"),analyticsFrom:"trash"}))}renderMobileHelpButton(){return n()(Zt.Z,{href:(0,He.U)("guides.trash"),analyticsFrom:"trash"})}renderPages(){if(!ft.Z.state.online)return n()(Se.Z,{},void 0,n()(gt.Z,{title:n()(_._H,{defaultMessage:"Please go online to view the Trash.",id:"sidebarTrash.goOnline.prompt"})}));{const{filter:e,limit:t,currentTab:i}=rt.Z.state,o="".concat(e,":").concat(t).concat(i);return n()(lt.Z,{requestStore:this.stores.requestStore,request:o,performRequest:this.performSearchRequest,render:this.renderTrashPages,debounce:St.vp})}}changeTab(e){rt.Z.setState({...rt.Z.state,currentTab:e,limit:rt.Z.startLimit}),this.stores.requestStore.setState({...this.stores.requestStore.state,result:null}),W.vqh(this.environment,{tab:e})}getSearchIconStyle(){return{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,color:this.theme.regularIconColor}}}r()(xt,"tabs",["all_pages","in_current_page"]);const Bt=xt;var At=i(42858);class Rt extends d.Z{constructor(...e){super(...e),r()(this,"renderOrigin",(e=>{const{onClick:t,...i}=(0,ye.Z)(e,{onClick:this.props.onClick});return n()(I.Z,{store:this.clonedStore,canDropOnto:!0,onSelectableDrop:this.handleDrop,analyticsName:"sibebar_trash",shouldShowDropZone:!0},void 0,l().createElement(K.Z,b()({},i,{onClick:t||this.handleClick,mobileFeedback:this.props.isMobile}),n()(P.Z,{left:this.renderIcon(),style:{...Mt.Z.state.open&&{background:this.theme.buttonHoveredBackground}},isMobile:this.props.isMobile,disableMobileBorder:!0},void 0,n()(_._H,{defaultMessage:"Trash",id:"sidebarTrashButton.text"}))))})),r()(this,"renderSidebarTrash",(()=>{const{currentSpaceStore:e}=A.Z.state;if(e)return n()(Bt,{spaceStore:e})})),r()(this,"handleClick",(e=>{rt.Z.setState({...rt.Z.state,currentTab:"all_pages"}),W.YFJ(this.environment)})),r()(this,"handleDrop",(e=>{const{droppedStores:t,duplicate:i}=e;i||N.H5(this.environment,(e=>{At.Cl({environment:this.environment,blocks:t,transaction:e})}))}))}willMount(e){super.willMount(e),this.clonedStore=e.store.clone()}renderComponent(){const{device:e}=this.environment;return n()(be.Z,{popupType:e.isMobile?be.Z.PopupType.SlideUp:be.Z.PopupType.Popup,buttonPopupStore:Mt.Z,alignmentToOrigin:be.Z.Alignment.Start,placementToOrigin:be.Z.Placement.Right,originGap:0,onClick:this.handleClick,isFullWidthOnMobile:!0,render:this.renderSidebarTrash,preventScaleTransition:!0,renderOrigin:this.renderOrigin})}renderIcon(){const{device:e}=this.environment,t=this.theme.mediumIconColor;return e.isMobile?h.Z.sidebarTrash({fill:t,height:16}):h.Z.sidebarTrash({fill:t,width:14})}}const _t=Rt;var Lt=i(47590),Ft=i(61045),Ht=i(376),Et=i(14786),Ot=i(32310),Ut=i(79092),Dt=i(27386),Nt=i(29368),Wt=i(46951),Vt=i(38043),qt=i(78291),zt=i(30045),Gt=i(23189),jt=i(42982),Kt=i(79603);class Yt extends d.Z{constructor(...e){super(...e),r()(this,"storeTypes",{passwordRequestStore:at.Z}),r()(this,"handleClose",(()=>{Et.Z.setState({open:!1})})),r()(this,"handleStartOfWeekToggle",(()=>{1===this.getStartDayOfWeek()?(0,Ke.rx)(this.environment):(0,Ke.Zf)(this.environment)}))}renderComponent(){const{device:e}=this.environment,{data:t}=qt.Z.state,i=Et.Z.state.open,o="on"===Le.Z.getGroup(this.environment,"user-data-consent"),s=e.isIOS&&Fe.wY(t);return n()(be.Z,{popupType:e.isMobile?be.Z.PopupType.SlideUp:be.Z.PopupType.Popup,buttonPopupStore:Et.Z,renderOrigin:e=>l().createElement(K.Z,b()({mobileFeedback:this.props.isMobile},e),n()(P.Z,{left:this.renderIcon(),style:{background:i?this.theme.buttonHoveredBackground:"none"},isMobile:this.props.isMobile,disableMobileBorder:!0},void 0,n()(_._H,{defaultMessage:"Notifications & settings",id:"notificationSettingsButton.mobileSidebar.label"}))),render:()=>{let i;if(i=e.isMobile?{menuType:Me.ZP.MenuType.Modal,title:n()(_._H,{defaultMessage:"Notifications & settings",id:"notificationSettingsButton.mobileSidebar.title"}),right:n()(_._H,{defaultMessage:"Done",id:"notificationSettingsButton.rightActionButton.done"}),onClickRight:this.handleClose,whiteBackground:!0}:{menuType:Me.ZP.MenuType.Popup},ft.Z.state.online){const{passwordRequestStore:e}=this.stores;return l().createElement(Me.ZP,i,e.state.loading?n()(V.Z,{style:{margin:"50% auto"}}):n()(Dt.Z,{disableScroller:!0},void 0,n()(Ht.Z,{}),n()(Nt.Z,{size:48,isHidden:!0}),n()(Gt.Z,{divider:"full"},void 0,n()(_._H,{id:"notificationSettingsButton.generalSection.title",defaultMessage:"General"})),n()(Vt.Z,{requestStore:e,isEducationPlan:Fe.wl(t)}),this.renderAppearanceSettings(),s&&this.renderSubscriptionSettings(),o&&this.renderUserDataConsentSettings(),n()(Nt.Z,{size:32}),n()(Ut.Z,{onClick:this.handleStartOfWeekToggle,startDayOfWeek:this.getStartDayOfWeek()||0}),(0,Kt.mS)(this.environment)&&this.renderExperimentsSettings()))}return n()(Dt.Z,{},void 0,n()(Wt.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,n()(_._H,{defaultMessage:"Please go online to manage settings.",id:"notificationSettingsButton.goOnline.prompt"})))}})}renderUserDataConsentSettings(){return n()(l().Fragment,{},void 0,n()(Nt.Z,{size:32}),n()(zt.Z,{}))}renderAppearanceSettings(){return n()(l().Fragment,{},void 0,n()(Nt.Z,{size:32}),n()(Ot.Z,{}))}renderExperimentsSettings(){return n()(l().Fragment,{},void 0,n()(Nt.Z,{size:32}),n()(Kt.Pp,{}))}renderSubscriptionSettings(){return n()(l().Fragment,{},void 0,n()(Nt.Z,{size:32}),n()(jt.Z,{}))}renderIcon(){return h.Z.sidebarSettings({fill:this.theme.mediumIconColor,width:16})}getStartDayOfWeek(){const{currentUserSettingsStore:e}=A.Z.state;if(e){const t=e.getSettings();if(t)return t.start_day_of_week}}}const Qt=Yt;var Xt=i(90287);class Jt extends d.Z{renderComponent(){const e=n()(_._H,{defaultMessage:"Upgrade to Pro",id:"upgradeMobileButton.upgradeButton.label"});return n()(K.Z,{mobileFeedback:!0,onClick:this.showUpgradeModal(this.environment)},void 0,n()(P.Z,{left:this.renderIcon(),isMobile:!0,disableMobileBorder:!0},void 0,e))}renderIcon(){return h.Z.settingsUpgradeFilled({fill:this.theme.mediumIconColor,width:16})}showUpgradeModal(e){return()=>{(0,W.sA6)(e,{from:"mobile_sidebar",for_subscription_tier:"personal"});const{mobileNative:t}=e;t&&t.openUpgradeModal((0,Xt.Bs)())}}}const $t=Jt;var ei=i(10118);class ti extends d.Z{constructor(...e){super(...e),r()(this,"storeTypes",{buttonPopupStore:Xe.Z}),r()(this,"handleClose",(()=>{this.stores.buttonPopupStore.setState({open:!1})}))}renderComponent(){if(!Fe.lw(this.environment))return;const{store:e}=this.props,{buttonPopupStore:t}=this.stores;return n()(be.Z,{buttonPopupStore:t,popupType:be.Z.PopupType.SlideUp,renderOrigin:e=>l().createElement(K.Z,b()({mobileFeedback:!0},e),n()(P.Z,{left:this.renderIcon(),isMobile:!0,disableMobileBorder:!0},void 0,n()(_._H,{defaultMessage:"Members",id:"memberSettingsButton.mobileSidebar.label"}))),render:()=>{if(ft.Z.state.online){const t={menuType:Me.ZP.MenuType.Modal,title:n()(_._H,{defaultMessage:"Members",id:"memberSettingsButton.mobileMemberSettings.title"}),right:n()(_._H,{defaultMessage:"Done",id:"memberSettingsButton.rightActionButton.done"}),onClickRight:this.handleClose};return l().createElement(Me.ZP,t,n()(ei.Z,{store:e,isMobile:!0}))}this.renderOffline()}})}renderIcon(){return h.Z.teamSize({fill:this.theme.mediumIconColor,width:16})}renderOffline(){return n()(Dt.Z,{},void 0,n()(Wt.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,n()(_._H,{defaultMessage:"Please go online to manage members.",id:"memberSettingsButton.goOnline.prompt"})))}}const ii=ti;var oi=i(89206),ni=i(29477),si=i(7755),ri=i(29337);const ai=200;class li extends d.Z{constructor(...e){super(...e),r()(this,"handleTouchStart",(e=>{const t={x:e.touches[0].clientX,y:e.touches[0].clientY};si.TC.state?t.x>(0,Ve.qG)(this.environment)?ri.Z.setState({touching:!0,swiping:!1,start:t}):this.handleReset():(0,Ve.YR)(this.environment)&&t.x<100?ri.Z.setState({touching:!0,swiping:!1,start:t}):this.handleReset()})),r()(this,"handleTouchMove",(e=>{if(Q.Z.state.isDragging)return void this.handleReset();const t=ri.Z.state;if(!t.touching)return;const i={x:e.touches[0].clientX,y:e.touches[0].clientY};if(t.swiping)ri.Z.setState({touching:!0,swiping:!0,start:t.start,speed:si.TC.state?t.end.x-i.x:i.x-t.end.x,end:i});else{if(Math.abs(i.y-t.start.y)>=25)return void this.handleReset();(!si.TC.state&&i.x-t.start.x>25||si.TC.state&&t.start.x-i.x>25)&&ri.Z.setState({touching:!0,swiping:!0,start:t.start,speed:0,end:i})}this.updateTransform()})),r()(this,"handleTouchEnd",(async()=>{const{ThemeStore:e}=this.environment,t=ri.Z.state;if(!t.swiping)return;const i=(0,Ve.qG)(this.environment),o=document.querySelector((0,Ve.YR)(this.environment)?".".concat(se.yk):".".concat(se.Wi)),n=document.querySelector(".".concat(se.Wi)),s=Math.abs(t.speed)>=8,r=s?"ease-out":"ease-in-out",a="dark"===e.state.mode?", 1px 0 0 ".concat(this.theme.shadowColor.alpha(2*this.theme.shadowOpacity).css()):"",l="\n\t\t\t".concat(this.theme.mediumBoxShadow,"\n\t\t\t").concat(a,"\n\t\t");if(si.TC.state){const e=t.start.x-t.end.x;if(e+25*t.speed>i/2){let t=s?(i-e)/i*ai:ai;t=Math.max(t,1),o.style.transition="transform ".concat(t,"ms ").concat(r),o.style.transform="translateZ(0)translateX(0px)",(0,Ve.YR)(this.environment)&&(o.style.boxShadow=l,n.style.transition="filter ".concat(t,"ms ").concat(r),n.style.filter="brightness(1)"),await ci(o),ht.xv(),this.handleReset()}else o.style.transition="transform ".concat(ai,"ms ").concat(r),o.style.transform="translateZ(0)translateX(".concat(i,"px)"),(0,Ve.YR)(this.environment)&&(o.style.boxShadow=l,n.style.transition="filter ".concat(ai,"ms ").concat(r),n.style.filter="brightness(0.7)"),await ci(o),this.handleReset()}else{const e=t.end.x-t.start.x;if(e+25*t.speed>i/2){let t=s?(i-e)/i*ai:ai;t=Math.max(t,1),o.style.transition="transform ".concat(t,"ms ").concat(r),o.style.transform="translateZ(0)translateX(".concat(i,"px)"),(0,Ve.YR)(this.environment)&&(o.style.boxShadow=l,n.style.transition="filter ".concat(t,"ms ").concat(r),n.style.filter="brightness(0.7)"),await ci(o),ht.bA(),this.handleReset()}else o.style.transition="transform ".concat(ai,"ms ").concat(r),o.style.transform="translateZ(0)translateX(0px)",(0,Ve.YR)(this.environment)&&(o.style.boxShadow=l,n.style.transition="filter ".concat(ai,"ms ").concat(r),n.style.filter="brightness(1)"),await ci(o),this.handleReset()}})),r()(this,"handleSidebarToggle",(()=>{this.updateTransform()})),r()(this,"updateTransform",(()=>{const e=document.querySelector((0,Ve.YR)(this.environment)?".".concat(se.yk):".".concat(se.Wi)),t=document.querySelector(".".concat(se.Wi)),i=(0,Ve.qG)(this.environment),o=ri.Z.state;if(o.swiping)if(si.TC.state){const n=i-(o.start.x-o.end.x)+25,s=Math.min(Math.max(0,n),i);if(e.style.transition="none",e.style.transform="translateZ(0)translateX(".concat(s,"px)"),(0,Ve.YR)(this.environment)){e.style.boxShadow=this.theme.mediumBoxShadow,t.style.transition="none";const o=(1-.3*s/i).toString();t.style.filter="brightness(".concat(o,")")}}else{const n=o.end.x-o.start.x-25,s=Math.min(Math.max(0,n),i);if(e.style.transition="none",e.style.transform="translateZ(0)translateX(".concat(s,"px)"),(0,Ve.YR)(this.environment)){e.style.boxShadow=this.theme.mediumBoxShadow,t.style.transition="none";const o=(1-.3*s/i).toString();t.style.filter="brightness(".concat(o,")")}}else si.TC.state?(e.style.transition="transform 200ms",e.style.transform="translateZ(0)translateX(".concat(i,"px)"),(0,Ve.YR)(this.environment)&&(e.style.transform="translateZ(0)translateX(calc(".concat(i,"px - 1px))"),e.style.boxShadow=this.theme.mediumBoxShadow,t.style.transition="filter 200ms",t.style.filter="brightness(0.7)"),q.ZH(this.environment)):(e.style.transition="transform 200ms",e.style.transform="translateZ(0)translateX(0)",(0,Ve.YR)(this.environment)&&(e.style.boxShadow="none",t.style.transition="filter 200ms",t.style.filter="brightness(1)"))}))}didMount(){const{device:e}=this.environment;e.isMobile&&(window.addEventListener("touchstart",this.handleTouchStart),window.addEventListener("touchmove",this.handleTouchMove),window.addEventListener("touchend",this.handleTouchEnd),si.TC.addListener(this.handleSidebarToggle))}willUnmount(){const{device:e}=this.environment;e.isMobile&&(window.removeEventListener("touchstart",this.handleTouchStart),window.removeEventListener("touchmove",this.handleTouchMove),window.removeEventListener("touchend",this.handleTouchEnd),si.TC.removeListener(this.handleSidebarToggle))}handleReset(){ri.Z.reset(),this.updateTransform()}}const di=li;async function ci(e){const t=ni.UZ();e.addEventListener("transitionend",t.resolve),e.addEventListener("webkitTransitionEnd",t.resolve),await t.promise,e.removeEventListener("transitionend",t.resolve),e.removeEventListener("webkitTransitionEnd",t.resolve)}var hi=i(45589),pi=i(45010),ui=i(8848),mi=i(13548),gi=i(41507),bi=i(37871),yi=i(22872),vi=i(29974),Si=i(39849),fi=i(99064),Mi=i(19757);class ki extends d.Z{renderComponent(){const{device:e}=this.environment,{id:t,onClick:i,focused:o,isAddButton:s,title:r,caption:a,shortcut:d,tooltipMessage:c,disableTooltip:p,disabled:u,showDragHandle:m}=this.props,g=this.environment.device.isMobile,y=this.props.isCheck;return n()(x.Z,{renderTooltip:()=>c,disableTooltip:p,placement:Mi.ug.Bottom,render:t=>l().createElement(K.Z,b()({},t,{mobileFeedback:this.environment.device.isMobile,onClick:i,hovered:o,disabled:u,style:this.getStyle()}),m&&this.renderDragHandle(),s?this.renderAddIcon():this.renderIcon(),n()("div",{style:{marginLeft:12,marginRight:d||y?12:0,minWidth:0}},void 0,n()(Wt.Z,{className:"notranslate",isMobile:e.isMobile},void 0,r),a&&n()(Wt.Z,{isSmall:!0,isMobile:e.isMobile},void 0,a)),y&&h.Z.check({width:16,height:16,marginLeft:"auto"}),d&&!g&&!y&&n()("div",{style:this.getShortcutStyle()},void 0,d))},"sidebarswitchermenuitem-tooltip-".concat(t))}renderDragHandle(){return n()(fi.Z,{iconSize:12,style:{marginLeft:-6,marginRight:4,visibility:this.props.isAddButton?"hidden":"visible"}})}renderIcon(){const e=this.environment.device.isMobile;return n()("div",{style:{display:"flex",alignItems:"center"}},void 0,n()("div",{style:{position:"relative"}},void 0,this.props.id&&n()(C.Z,{disabled:!0,icon:this.props.icon,isEmptyPage:!1,title:this.props.title,size:e?ki.mobileIconSize:ki.desktopIconSize,isLarge:!0}),n()(Si.Z,{color:Si.Z.Color.Red,count:this.props.unreadMentions,style:{position:"absolute",top:-5,right:-5}})))}renderAddIcon(){const e=this.environment.device.isMobile?ki.mobileIconSize:ki.desktopIconSize;return n()("div",{style:{...this.getIconWrapStyle(),width:e,height:e}},void 0,this.getPlusIcon())}getStyle(){const e=this.environment.device.isMobile,{WindowSizeStore:t}=this.environment,{disabled:i}=this.props;return{display:"flex",alignItems:"center",lineHeight:"120%",width:"100%",paddingTop:e?8:4,paddingBottom:e?8:4,paddingLeft:e?t.getSafePaddingLeftCSS(16):14,paddingRight:e?t.getSafePaddingRightCSS(16):14,...e&&{boxShadow:"0 1px 0 ".concat(this.theme.regularDividerColor)},marginBottom:1,fontSize:e?16:14,...e&&{background:this.theme.popoverBackground},height:e?54:48,...this.props.isAddButton&&!e&&{boxShadow:"none",marginBottom:0},...i&&{opacity:.4}}}getPlusIcon(){return h.Z.plus({flexGrow:0,flexShrink:0,width:16,height:16,fill:this.theme.popoverBackground})}getIconWrapStyle(){return{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",background:this.theme.lightIconColor,borderRadius:3,flexShrink:0}}getShortcutStyle(){return{color:this.theme.lightTextColor,fontSize:12,whiteSpace:"nowrap",marginLeft:"auto",flexShrink:0}}}r()(ki,"contextTypes",{...Me.ff}),r()(ki,"mobileIconSize",36),r()(ki,"desktopIconSize",32),r()(ki,"dragHandleEffectiveWidth",16);const Ti=ki;var Zi=i(52858);class wi extends d.Z{constructor(...e){super(...e),r()(this,"storeTypes",{buttonPopupStore:Xe.Z})}renderComponent(){const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:Me.ZP.MenuType.ActionSheet}:{menuType:Me.ZP.MenuType.Popup},n()("div",{style:this.getContainerStyle()},void 0,n()("div",{style:this.getTextStyle()},void 0,this.props.emailAddress),n()(be.Z,{popupType:e.isMobile?be.Z.PopupType.SlideUp:be.Z.PopupType.Popup,buttonPopupStore:this.stores.buttonPopupStore,renderOrigin:e=>{if(!this.props.disabled)return l().createElement(K.Z,b()({},e,{style:this.getButtonStyle()}),h.Z.dots(this.getButtonIconStyle()))},render:()=>l().createElement(Me.ZP,t,n()(Zi.Z,{sections:[{key:"option section",render:e=>l().createElement(Se.Z,e),actions:this.props.accountActions}],context:{environment:this.environment,blocks:[]}}))}))}getButtonStyle(){const{device:e}=this.environment;return{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:e.isMobile?24:20,height:e.isMobile?24:20,borderRadius:3}}getButtonIconStyle(){const{device:e}=this.environment;return{width:e.isMobile?18:12,height:e.isMobile?18:12}}getContainerStyle(){return{marginTop:this.environment.device.isMobile?20:8,marginLeft:12,marginRight:12,display:"flex",alignItems:"center",justifyContent:"space-between",color:this.theme.mediumTextColor}}getTextStyle(){return{fontSize:this.environment.device.isMobile?14:11,lineHeight:R.Z.lineHeight.UISmall.desktop,fontWeight:R.Z.fontWeight.medium}}}const Ci=wi;var Ii=i(98726),Pi=i(62213),xi=i(76487),Bi=i(81236),Ai=i(39153);class Ri extends d.Z{renderComponent(){return n()("div",{style:this.getPlaceholderPageStyle()},void 0,this.props.showIcon&&h.Z.templates({width:16,height:16,fill:this.theme.buttonHoveredBackground}),n()("div",{style:this.getPlaceholderTextWrapStyle()},void 0,n()("div",{style:Ri.getPlaceholderTextStyle(this.theme)})))}getPlaceholderPageStyle(){return{height:28,display:"flex",alignItems:"center",width:"100%",padding:this.props.showIcon?"0 15px":"0 0px"}}getPlaceholderTextWrapStyle(){return{flexGrow:1,marginLeft:this.props.showIcon?10:0,height:28,display:"flex",alignItems:"center"}}static getPlaceholderTextStyle(e){const t=Math.ceil(60),i=Math.floor(85),o=Math.floor(Math.random()*(i-t+1))+t,n="".concat(o,"%");return{height:4,background:e.buttonHoveredBackground,width:n}}}const _i=Ri;var Li=i(38755);class Fi extends d.Z{willMountOrUpdate(){"store"===this.props.type&&this.props.spaceStore.getValue()}renderComponent(){const{device:e}=this.environment,{props:t}=this,{activeUserEmailAddress:i,isMobile:o,style:s,showExpand:r}=t,a="store"===t.type?(0,Li.getSpaceName)(this.environment,t.spaceStore):t.spaceName;return n()(P.Z,{style:{overflow:"hidden",width:"100%",...o&&{fontSize:14,padding:0,marginRight:12},...s||{}},left:a?this.renderRecordIcon(a,"store"===t.type?void 0:t.spaceIcon,o,"store"===t.type?t.spaceStore:void 0):this.renderPlaceholderRecordIcon(),isMobile:o,disableMobileBorder:!0},void 0,!a&&this.renderPlaceholderTitle(),a&&n()("div",{style:{display:"flex",alignItems:"center",justifyContent:i?"space-between":"start"},className:"notranslate"},void 0,n()("div",{style:{display:"flex",flexDirection:"column",marginRight:6,marginTop:e.isAndroid?3:0,...Fi.truncateStyle}},void 0,n()("div",{style:{color:this.theme.regularTextColor,fontWeight:R.Z.fontWeight.medium,...Fi.truncateStyle}},void 0,a),n()("div",{style:{color:this.theme.mediumTextColor,fontSize:11,lineHeight:"12px",fontWeight:R.Z.fontWeight.regular,...Fi.truncateStyle}},void 0,i)),r&&n()("div",{style:{flexGrow:0,flexShrink:0,width:12,height:12,fill:this.theme.mediumIconColor}},void 0,h.Z.expand())))}renderRecordIcon(e,t,i,o){const s=o?(0,Li.getSpaceIcon)(this.environment,o):t?{icon:t,pointer:{table:"space",id:"undefined"}}:void 0,r=o?(0,Li.getSpaceName)(this.environment,o):e;return n()(C.Z,{disabled:!0,icon:s,isEmptyPage:!1,title:r,size:i?24:20,style:{marginTop:1,color:this.theme.regularTextColor}})}renderPlaceholderRecordIcon(){return n()("div",{style:{opacity:.25}},void 0,n()(Ai.Z,{size:20,title:void 0}))}renderPlaceholderTitle(){return n()(_i,{showIcon:!1})}}r()(Fi,"truncateStyle",{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"});const Hi=Fi;var Ei=i(46911),Oi=i(31079),Ui=i(17364);const Di=new Xe.Z,Ni=new Xe.Z;var Wi=i(15102),Vi=(i(73210),i(62727)),qi=i(13490),zi=i(53834);class Gi extends d.Z{renderComponent(){return n()(K.Z,{onClick:this.props.onClick,style:this.getStyle(),hoveredStyle:this.getHoveredStyle()},void 0,h.Z.appleLogo({width:16,height:16,marginRight:6,marginBottom:2}),n()(_._H,{id:"loginForm.loginWithAppleButton.label",defaultMessage:"Continue with Apple"}))}getStyle(){return{display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",height:36,borderRadius:3,color:ui.ZP.regularTextColor,fill:ui.ZP.regularTextColor,background:ui.ZP.white,fontSize:14,lineHeight:1,paddingLeft:12,paddingRight:12,fontWeight:R.Z.fontWeight.medium,border:"light"===this.theme.mode?"1px solid ".concat(this.theme.regularTextColor):"none",width:"100%",...this.props.style,boxShadow:"0 1px 2px rgba(15, 15, 15, 0.1)"}}getHoveredStyle(){return{background:"light"===this.theme.mode?this.theme.buttonHoveredBackground:ui.ZP.whiteWithAlpha(.8)}}}const ji=Gi;var Ki=i(42402),Yi=i(32935),Qi=i(33954);class Xi extends d.Z{constructor(...e){super(...e),r()(this,"emailInputId",ue().uniqueId("notion-email-input-")),r()(this,"passwordInputId",ue().uniqueId("notion-password-input-")),r()(this,"storeTypes",{loginStore:Oi.Z,loginPermissionsStore:Ei.Z}),r()(this,"handleHiddenPasswordInputChange",(e=>{const{loginStore:t}=this.stores,i={...t.state,password:e.currentTarget.value,alert:void 0};t.setState(i)})),r()(this,"handleEmailChange",(e=>{const{loginStore:t}=this.stores,i={...t.state,email:e.target.value,alert:void 0};t.isPassword()||t.isTemporaryPasscode()||t.isReverifying()?t.setState({...i,loginType:"email",password:""}):t.setState(i)})),r()(this,"handleEmailLoginClick",(async()=>{const{disableLoginLink:e}=this.props,{loginStore:t}=this.stores;if(t.isEmail()){const{email:i}=t.state,o=await Yi.JRL(this.environment,{email:i,allowAdminBypass:!0});if("failed"===o.type)return;const n=o.data.samlRedirect;if(n&&n.enforced)return t.setState({...t.state,loginType:"saml",alert:"Redirecting you to use SAML SSO"}),void this.handleSamlLoginClick();o.data.hasPassword?o.data.mustReverify?await yi.cD({environment:this.environment,store:t,reverify:!0,disableLoginLink:e}):t.setState({...t.state,loginType:"password",alert:void 0}):(t.setState({...t.state,hasAccount:Boolean(o.data.hasAccount)}),yi.cD({environment:this.environment,store:t,disableLoginLink:e}))}})),r()(this,"handleTemporaryPasscodeLoginClick",(async()=>{const{redirectURL:e}=this.props,{loginStore:t}=this.stores;if(t.isReverifying()){const{password:e,sentEmailPasscodeState:i}=t.state,o=await yi.lm({environment:this.environment,state:i,password:e});o?t.setState({...t.state,alert:o}):t.setState({...t.state,loginType:"password",password:"",reverified:!0,alert:void 0})}if(t.isTemporaryPasscode()){const{password:i,sentEmailPasscodeState:o}=t.state,n=await yi.ax({environment:this.environment,state:o,password:i,redirectURL:e});n&&t.setState({...t.state,alert:n})}})),r()(this,"handlePasswordLoginClick",(async()=>{const{redirectURL:e}=this.props,{loginStore:t}=this.stores,{email:i,password:o}=t.state,n=await yi.fZ({environment:this.environment,email:i,password:o,redirectURL:e});t.setState({...t.state,alert:n})})),r()(this,"handleResetPasswordClick",(()=>{yi.CA({environment:this.environment,store:this.stores.loginStore})})),r()(this,"handleSamlLoginClick",(async()=>{const{device:e}=this.environment,{loginStore:t}=this.stores;if(t.isSaml()){const{email:i}=t.state;if(i){const o=e.isElectron?"nativeredirect":e.isNative?"native":void 0,n=await Yi.QjN(this.environment,{email:i,callbackType:o});if("failed"===n.type)return void t.setState({...t.state,alert:(0,Qi.wf)(this.props.intl,n)});t.setState({...t.state,alert:void 0});const s=n.data.redirectUrl;s&&yi.N(this.environment,s)}}})),r()(this,"handleLoginWithAppleClick",(()=>{yi.mJ({environment:this.environment,store:this.stores.loginStore})}))}renderComponent(){const{loginStore:e}=this.stores,{isSignup:t}=this.props;return n()("div",{className:se.x4,style:{...Xi.wrapStyle,...this.props.style}},void 0,this.renderLoginWithGoogleButton(),this.renderLoginWithAppleButton(),n()("div",{style:{width:"100%"}},void 0,this.renderLoginForm(),this.renderAlert(),!t&&this.renderForgotPassword(),!ge.Z.isAdminMode&&this.renderLoginOptions({email:!(e.isEmail()||e.isTemporaryPasscode()||e.isPassword()||e.isReverifying()),saml:!e.isSaml()})),this.renderDisclaimer())}renderLoginForm(){const{loginStore:e}=this.stores,{email:t,password:i}=e.state;return e.isEmail()?n()("form",{onSubmit:this.onFormSubmit},void 0,this.renderEmailInput({email:t,onSubmit:this.handleEmailLoginClick}),n()(Vi.Z,{type:"password",autoComplete:"current-password",style:{opacity:0,height:0,padding:0,pointerEvents:"none"},inputElementAttributes:{tabIndex:-1,"aria-hidden":!0},onChange:this.handleHiddenPasswordInputChange}),n()(zi.Z,{variant:"secondary",style:{marginTop:6,marginBottom:12},isFullWidth:!0,onClick:this.handleEmailLoginClick},void 0,n()(_._H,{id:"loginForm.continueWithEmailButton.label",defaultMessage:"Continue with email"}))):e.isPassword()?n()("form",{onSubmit:this.onFormSubmit},void 0,this.renderEmailInput({email:t,onSubmit:this.handlePasswordLoginClick}),e.state.reverified&&n()("div",{style:this.getEmailSentCaptionStyle()},void 0,n()("span",{style:{paddingRight:4}},void 0,this.renderCheck()),n()(_._H,{id:"loginForm.reverifyPasswordLabel",defaultMessage:"<emailverifiedtext>Email verified</emailverifiedtext>. You can continue logging in with your password.",values:{emailverifiedtext:(...e)=>n()("span",{style:{color:this.theme.regularTextColor}},void 0,e)}})),n()(qi.Z,{forId:this.passwordInputId},void 0,n()(_._H,{id:"loginForm.passwordInput.label",defaultMessage:"Password"})),this.renderPasswordInput({password:i,inputType:"password",placeholderType:"enter_password",onSubmit:this.handlePasswordLoginClick,intl:this.props.intl}),n()(zi.Z,{variant:"secondary",style:{marginTop:6,marginBottom:12},isFullWidth:!0,onClick:this.handlePasswordLoginClick},void 0,n()(_._H,{id:"loginForm.continueWithPasswordButton.label",defaultMessage:"Continue with password"}))):e.isPasswordResetSent()?n()(a.Fragment,{},void 0,n()(Nt.Z,{size:42}),n()("div",{style:this.getEmailSentCaptionStyle()},void 0,n()(_._H,{id:"loginForm.passwordResetSentMessage",defaultMessage:"Check your inbox for the link to reset your password."}))):e.isForgotPassword()?n()("form",{onSubmit:this.onFormSubmit},void 0,this.renderEmailInput({email:t,onSubmit:this.handleResetPasswordClick}),n()(zi.Z,{variant:"secondary",style:{marginTop:6,marginBottom:12},isFullWidth:!0,onClick:this.handleResetPasswordClick},void 0,n()(_._H,{id:"loginForm.sendResetLink",defaultMessage:"Send reset link"}))):e.isReverifying()?n()("form",{onSubmit:this.onFormSubmit},void 0,this.renderEmailInput({email:t,onSubmit:this.handleTemporaryPasscodeLoginClick}),n()("div",{style:this.getEmailSentCaptionStyle()},void 0,n()(_._H,{id:"loginForm.reverifySentMessage",defaultMessage:"This account requires email verification. Please check your inbox and paste in the verification code."})),n()(qi.Z,{forId:this.passwordInputId},void 0,n()(_._H,{id:"loginForm.verificationCodeInput.label",defaultMessage:"Verification code"})),this.renderPasswordInput({password:i,inputType:"text",placeholderType:"reverify",onSubmit:this.handleTemporaryPasscodeLoginClick,intl:this.props.intl}),n()(zi.Z,{variant:"secondary",style:{marginTop:6,marginBottom:12},isFullWidth:!0,onClick:this.handleTemporaryPasscodeLoginClick},void 0,n()(_._H,{id:"loginForm.continueWithReverifyButton.label",defaultMessage:"Verify email"}))):e.isTemporaryPasscode()?n()("form",{onSubmit:this.onFormSubmit},void 0,this.renderEmailInput({email:t,onSubmit:this.handleTemporaryPasscodeLoginClick}),n()("div",{style:this.getEmailSentCaptionStyle()},void 0,this.stores.loginStore.state.hasAccount||!bi.N(this.environment)?n()(_._H,{id:"loginForm.temporaryPasscodeSentMessage",defaultMessage:"We just sent you a temporary login code.{br}Please check your inbox.",values:{br:n()("br",{})}}):n()(_._H,{id:"loginForm.temporaryPasscodeSentMessageNoAccount",defaultMessage:"We just sent you a temporary sign up code. Please check your inbox and paste the sign up code below."})),n()(qi.Z,{forId:this.passwordInputId},void 0,this.stores.loginStore.state.hasAccount||!bi.N(this.environment)?n()(_._H,{id:"loginForm.loginCodeInput.label",defaultMessage:"Login code"}):n()(_._H,{id:"loginForm.signUpCodeInput.label",defaultMessage:"Sign up code"})),this.renderPasswordInput({password:i,inputType:"text",placeholderType:this.props.emailPasscodePlaceholderType,onSubmit:this.handleTemporaryPasscodeLoginClick,intl:this.props.intl}),n()(zi.Z,{variant:"secondary",style:{marginTop:6,marginBottom:12},isFullWidth:!0,onClick:this.handleTemporaryPasscodeLoginClick},void 0,this.stores.loginStore.state.hasAccount||!bi.N(this.environment)?n()(_._H,{id:"loginForm.continueWithLoginCodeButton.label",defaultMessage:"Continue with login code"}):n()(_._H,{id:"loginForm.createNewAccountButton.label",defaultMessage:"Create new account"}))):e.isSaml()?n()("form",{onSubmit:this.onFormSubmit},void 0,this.renderEmailInput({email:e.state.email,onSubmit:this.handleSamlLoginClick}),n()(zi.Z,{variant:"secondary",style:{marginTop:6,marginBottom:12},isFullWidth:!0,onClick:this.handleSamlLoginClick},void 0,n()(_._H,{id:"loginForm.continueWithSAMLButton.label",defaultMessage:"Continue with SAML"}))):void 0}renderLoginWithGoogleButton(){return n()(zi.Z,{variant:"primary",isFullWidth:!0,style:{marginBottom:4},onClick:e=>{yi.Pn({environment:this.environment,store:this.stores.loginStore,permissionsStore:this.stores.loginPermissionsStore})}},void 0,h.Z.googleLogo({fill:"currentColor",width:14,height:14,marginRight:6}),n()(_._H,{id:"loginForm.loginWithGoogleButton.label",defaultMessage:"Continue with Google"}))}renderLoginWithAppleButton(){if(!ge.Z.isAdminMode)return n()(ji,{style:{marginTop:10},onClick:this.handleLoginWithAppleClick})}renderCheck(){return h.Z.thinCheck({display:"inline",height:12,width:12,color:this.theme.regularTextColor})}renderLoginOptions(e){const{email:t,saml:i}=e;if(t||i)return n()("div",{style:this.getCaptionStyle()},void 0,t&&i?this.renderContinueWithEmailOrSaml():t?this.renderContinueWithEmail():this.renderContinueWithSaml())}renderContinueWithEmailOrSaml(){return n()(_._H,{id:"loginForm.otherLoginOptions.continueWithEmailOrSAML",defaultMessage:"You can also <emailloginlink>continue with email</emailloginlink> or <samlloginlink>continue with SAML SSO</samlloginlink>",values:{emailloginlink:(...e)=>n()(Ki.Z,{onClick:()=>{this.stores.loginStore.setState({...this.stores.loginStore.state,loginType:"email",alert:void 0})}},void 0,e),samlloginlink:(...e)=>n()(Ki.Z,{onClick:()=>{this.stores.loginStore.setState({...this.stores.loginStore.state,loginType:"saml",alert:void 0})}},void 0,e)}})}renderContinueWithEmail(){return n()(_._H,{id:"loginForm.otherLoginOptions.continueWithEmail",defaultMessage:"You can also <emailloginlink>continue with email</emailloginlink>",values:{emailloginlink:(...e)=>n()(Ki.Z,{onClick:()=>{this.stores.loginStore.setState({...this.stores.loginStore.state,loginType:"email",alert:void 0})}},void 0,e)}})}renderContinueWithSaml(){return n()(_._H,{id:"loginForm.otherLoginOptions.continueWithSAML",defaultMessage:"You can also <samlloginlink>continue with SAML SSO</samlloginlink>",values:{samlloginlink:(...e)=>n()(Ki.Z,{onClick:()=>{this.stores.loginStore.setState({...this.stores.loginStore.state,loginType:"saml",alert:void 0})}},void 0,e)}})}renderEmailInput(e){const{email:t,onSubmit:i}=e,o="email"===this.props.emailLabelType?n()(_._H,{id:"loginForm.emailInput.label",defaultMessage:"Email",description:"Label for email input field if user is logging in with a normal email address"}):n()(_._H,{id:"loginForm.workEmailInput.label",defaultMessage:"Work email",description:"Label for email input field if user is logging in with a company email address"});return n()(a.Fragment,{},void 0,n()(Nt.Z,{size:42}),n()(qi.Z,{forId:this.emailInputId},void 0,o),n()(Vi.Z,{id:this.emailInputId,value:t,type:"email",format:Vi.Z.Format.Large,style:this.getInputStyle(),placeholder:this.props.intl.formatMessage({id:"loginForm.emailInput.placeholder",defaultMessage:"Enter your email address..."}),onSubmit:i,autoComplete:"username",showClearButton:!0,autoFocus:this.props.emailInputAutoFocus,onChange:this.handleEmailChange}))}renderPasswordInput(e){const{password:t,inputType:i,placeholderType:o,intl:s,onSubmit:r}=e;let a="";const l=this.stores.loginStore.state.hasAccount,d=!bi.N(this.environment);switch(o){case"enter_password":a=s.formatMessage({id:"loginForm.passcodeInput.enterPasswordPlaceholder",defaultMessage:"Enter your password..."});break;case"enter_code":a=l||!d?s.formatMessage({id:"loginForm.passcodeInput.enterCodePlaceholder",defaultMessage:"Enter login code"}):s.formatMessage({id:"loginForm.passcodeInput.enterSignupCodePlaceholder",defaultMessage:"Enter sign up code"});break;case"paste_code":a=l||!d?s.formatMessage({id:"loginForm.passcodeInput.pasteCodePlaceholder",defaultMessage:"Paste login code"}):s.formatMessage({id:"loginForm.passcodeInput.pasteSignupCodePlaceholder",defaultMessage:"Paste sign up code"});break;case"reverify":a=s.formatMessage({id:"loginForm.passcodeInput.reverifyPlaceholder",defaultMessage:"Paste verification code"})}return n()(Vi.Z,{id:this.passwordInputId,type:i,value:t,style:this.getInputStyle(),format:Vi.Z.Format.Large,placeholder:a,onSubmit:r,autoFocus:!0,autoComplete:"text"===i?"one-time-code":"current-password",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,onChange:e=>{this.stores.loginStore.setState({...this.stores.loginStore.state,password:"text"===i?e.target.value.trim():e.target.value,alert:void 0})}})}renderForgotPassword(){const{loginStore:e}=this.stores;if(e.isPassword()||e.isEmail())return n()("div",{style:this.getCaptionStyle()},void 0,n()(Ki.Z,{onClick:()=>{e.setState({...e.state,loginType:"forgot",password:"",alert:void 0})}},void 0,n()(_._H,{id:"loginForm.forgotPasswordLink",defaultMessage:"Forgot password?"})))}renderAlert(){const{alert:e}=this.stores.loginStore.state,t=e&&e.split("User:")[1]||e;return n()("div",{style:{fontSize:14,color:ui.ZP.redWithAlpha(1),textAlign:"center",display:t?"block":"none",width:"100%"}},void 0,t)}renderDisclaimer(){const{device:e}=this.environment;return this.props.disableDisclaimer?null:n()("div",{style:{width:e.isMobile?"100%":500,marginTop:64,fontSize:12,color:this.theme.lightTextColor,textAlign:e.isMobile?"left":"center"}},void 0,n()("p",{style:{marginBottom:0}},void 0,n()(_._H,{id:"loginForm.disclaimer",description:"Terms and conditions for using the app",defaultMessage:"By clicking “Continue with Google/Email/SAML” above, you acknowledge that you have read and understood, and agree to Notion's <termsandconditionslink>Terms & Conditions</termsandconditionslink> and <privacypolicylink>Privacy Policy</privacypolicylink>.",values:{termsandconditionslink:(...e)=>n()(Ki.Z,{href:Te._j.termsAndConditions},void 0,e),privacypolicylink:(...e)=>n()(Ki.Z,{href:Te._j.privacyPolicy},void 0,e)}})))}onFormSubmit(e){e.preventDefault()}getInputStyle(){const{device:e}=this.environment;return{marginTop:4,marginBottom:8,boxShadow:this.theme.inputBoxShadow,...e.isMobile&&{lineHeight:"30px"}}}getCaptionStyle(){return{color:this.theme.mediumTextColor,fontSize:14,lineHeight:1.6,marginTop:8,textAlign:"center",...this.props.captionStyle}}getEmailSentCaptionStyle(){return{fontSize:14,textAlign:"center",marginTop:8,marginBottom:8,width:"100%",color:this.theme.mediumTextColor,...this.props.emailPasswordSentPromptStyle}}}r()(Xi,"wrapStyle",{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"});const Ji=(0,_.XN)(Xi);class $i extends d.Z{constructor(...e){super(...e),r()(this,"storeTypes",{loginStore:Oi.Z,loginPermissionsStore:Ei.Z}),r()(this,"renderLoginAction",(e=>{const{redirectURL:t}=this.props,{device:i}=this.environment;return n()("div",{style:{height:"100%"}},void 0,!i.isMobile&&n()("div",{style:this.getCancelStyle(),onClick:()=>Ui.Z.setState({...Ui.Z.getState(),open:!1})},void 0,n()(_._H,{defaultMessage:"Cancel",id:"sidebarSwitcherMultiAccount.addAccountModal.cancelButton.label"})),n()("div",{style:this.getLoginActionWrapperStyle()},void 0,!i.isMobile&&n()("div",{style:this.getTitleStyle()},void 0,l().createElement(_._H,(0,Ve.Om)(this.props.intl,e))),n()("div",{style:this.getDescriptionStyle()},void 0,this.renderDescription(e)),n()(oi.Z,{capture:!0,onBackspace:ue().identity,onLeft:ue().identity,onRight:ue().identity,onSelectAll:ue().identity,onRedo:ue().identity,onUndo:ue().identity,onCut:ue().identity,onCopy:ue().identity,onPaste:ue().identity,onKeypress:ue().identity,onDelete:ue().identity,onTab:ue().identity},void 0,l().createElement(Ji,b()({style:this.getLoginActionStyle(),emailPasscodePlaceholderType:"enter_code",emailLabelType:"email",emailInputAutoFocus:!0,disableDisclaimer:!0,redirectURL:t,disableLoginLink:this.props.disableLoginLink},this.stores)))))})),r()(this,"renderAccountActionModal",(()=>{const{open:e,createType:t}=Ui.Z.state;return n()(Wi.Z,{open:e,innerStyle:this.getModalStyle(),onDismiss:()=>{Ui.Z.reset(),this.stores.loginStore.reset()},render:()=>{if(t)return this.renderLoginAction(t)},className:se.zY})})),r()(this,"getAccountActionStyle",(()=>{const{device:e}=this.environment;return{display:"flex",color:this.theme.mediumTextColor,whiteSpace:"nowrap",fontSize:e.isMobile?16:12}}))}willMount(e){super.willMount(e);const{loginStore:t}=this.stores;"email"===t.state.loginType&&this.environment.device.isMobile&&t.setState({...t.state,loginType:"google"})}renderComponent(){const{online:e}=ft.Z.state,{device:t}=this.environment,{createType:i}=this.props;return t.isMobile?n()(be.Z,{popupType:be.Z.PopupType.SlideUp,buttonPopupStore:"add-account"===i?Ni:Di,alignmentToOrigin:be.Z.Alignment.Start,placementToOrigin:be.Z.Placement.Top,originGap:0,isFullWidthOnMobile:!0,render:e=>this.renderAccountActionMenu(i,e),preventScaleTransition:!0,renderOrigin:t=>l().createElement(fe.Z,b()({focused:!1,disabled:!e,title:this.renderMenuButtonLoginTitle(i)},t))}):n()("div",{onClick:()=>{e&&(W.D6i(this.environment,{createType:i}),Ui.Z.setState({...Ui.Z.getState(),open:!0,createType:i}))}},void 0,n()(fe.Z,{focused:!1,disabled:!e,title:this.renderMenuButtonLoginTitle(i)}),this.renderAccountActionModal())}renderMenuButtonLoginTitle(e){switch(e){case"create-work":return n()("div",{style:this.getAccountActionStyle()},void 0,n()(_._H,{defaultMessage:"Create work account",id:"sidebarSwitcherMultiAccount.menuItem.createWorkAccountButton.label"}));case"add-account":return n()("div",{style:this.getAccountActionStyle()},void 0,n()(_._H,{defaultMessage:"Add another account",id:"sidebarSwitcherMultiAccount.addAccountButton.label"}))}}renderAccountActionMenu(e,t){const i={menuType:Me.ZP.MenuType.Modal,left:n()(Ct.CancelMenuText,{}),onClickLeft:t.close,whiteBackground:!0,title:l().createElement(_._H,(0,Ve.Om)(this.props.intl,e))};return l().createElement(Me.ZP,i,this.renderLoginAction(e))}renderDescription(e){switch(e){case"add-account":return n()(_._H,{id:"sidebarSwitcherMultiAccount.addAccount.description",defaultMessage:"Use an existing account, or sign up with a new email. Your current account will remain logged in.",description:"Description when adding an account"});case"create-work":return n()(_._H,{id:"sidebarSwitcherMultiAccount.createWork.description",defaultMessage:"We’ll check if your teammates are already on Notion. If not, we’ll create a new home for you and your team.",description:"Description when creating a work account"})}}getBaseMobileStyle(){return this.environment.device.isMobile?{maxWidth:343}:{}}getModalStyle(){return{width:480,maxWidth:"calc(100vw - 100px)",borderRadius:3}}getTitleStyle(){return{fontSize:28,fontWeight:R.Z.fontWeight.semibold,marginTop:90,textAlign:"center",lineHeight:1.1,...this.getBaseMobileStyle()}}getDescriptionStyle(){return{fontSize:14,color:this.theme.mediumTextColor,width:350,marginTop:12,marginBottom:20,textAlign:"center",lineHeight:1.3,...this.getBaseMobileStyle()}}getCancelStyle(){return{fontSize:14,color:this.theme.mediumTextColor,position:"absolute",right:0,marginTop:16,marginRight:16,cursor:"pointer"}}getLoginActionWrapperStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none"}}getLoginActionStyle(){return{width:320,marginTop:24,marginBottom:64,...this.getBaseMobileStyle()}}}const eo=(0,_.XN)($i);var to=i(19662),io=i(86512),oo=i(83217),no=i(65452),so=i(16691),ro=i(45953),ao=i(18978),lo=i(98459),co=i(29538);let ho;!function(e){e[e.Regular=0]="Regular",e[e.DesktopMac=1]="DesktopMac",e[e.Mobile=2]="Mobile"}(ho||(ho={}));class po extends d.Z{constructor(...e){super(...e),r()(this,"storeTypes",{loginStore:Oi.Z,loginPermissionsStore:Ei.Z}),r()(this,"height",{[ho.Regular]:Ge.Z.defaultHeight,[ho.DesktopMac]:Ge.Z.desktopMacHeight,[ho.Mobile]:"auto"}),r()(this,"handleDesktopAppClick",(()=>{const{device:e}=this.environment;this.close(),e.isWindows?W.dyr(this.environment,{from:"sidebar",platform:"windows"}):W.dyr(this.environment,{from:"sidebar",platform:"mac"})})),r()(this,"handleMobileAppClick",(()=>{this.close(),W.YY6(this.environment,{from:"sidebar"})})),r()(this,"handleClick",(()=>{Pi.Z.setState({...Pi.Z.state,open:!0}),W.air(this.environment),Ui.Z.getUserIds(this.environment).forEach((e=>{Ui.Z.getSpaceViewStores(this.environment,e).forEach((t=>{const i=t.getSpaceId();i&&(0,no.hp)({environment:this.environment,spaceId:i,userId:e})}))}))})),r()(this,"logout",(()=>{const{online:e}=ft.Z.state;e&&(Pi.Z.setState({...Pi.Z.state,open:!1}),W.HYP(this.environment),yi.kS(this.environment))})),r()(this,"handleDraggableListDrop",(e=>t=>{const i=t.map(so.Vg).map((e=>ro.dr.fromSpaceShardRecordId(e,ao.z))),o=new to.Z(this.environment,{table:oo.dx,id:e},{userId:e});N.H5(this.environment,(e=>{vi._Q({userRootStore:o,transaction:e,spaceViewIds:i.map((e=>e.id)),spaceViewPointers:i})}),e),W.Q4L(this.environment,{workspace_count:t.length})})),r()(this,"getAccountActionStyle",(()=>({display:"flex",color:this.theme.mediumTextColor,whiteSpace:"nowrap",fontSize:this.isMobile?16:12,paddingLeft:this.isMobile||this.isOnlySpace()?0:Ti.dragHandleEffectiveWidth}))),r()(this,"getFooterStyle",(()=>this.environment.device.isMobile?{}:{backgroundColor:this.theme.sidebarSwitcherFooterBackground}))}renderComponent(){const{device:e}=this.environment,{shouldShowUnexpandButton:t}=this.props,{currentSpaceStore:i,currentUserStore:o}=A.Z.state,s=Ui.Z.getUserIds(this.environment);if(!i||!o)return;const r=s.length>1?o.getEmail():void 0,d=this.getUnreadCountForOtherSpaces();return n()(be.Z,{popupType:e.isMobile?be.Z.PopupType.SlideUp:be.Z.PopupType.Popup,buttonPopupStore:Pi.Z,renderOrigin:()=>n()(K.Z,{style:{...po.buttonStyle,height:this.height[this.props.format],marginBottom:r?e.isMobile?0:8:0,...this.props.buttonStyle},mobileFeedback:e.isMobile,onClick:this.handleClick,className:se.rl},void 0,n()(Hi,{isMobile:this.isMobile,spaceStore:i,activeUserEmailAddress:r,showExpand:!0,type:"store"}),t&&n()("div",{className:se.Ji,style:{display:"flex",alignItems:"center",height:"100%",marginLeft:"auto",marginRight:d?0:12}},void 0,n()(co.V,{})),n()(Si.Z,{color:Si.Z.Color.Red,count:d,style:{marginLeft:6,marginRight:14}})),originGap:0,disableMutationObserver:!0,render:t=>{let i;return i=e.isMobile?{menuType:Me.ZP.MenuType.Modal,title:n()(_._H,{defaultMessage:"Accounts & Workspaces",id:"sidebarSwitcherMultiAccount.mobileMenu.title"}),right:n()(Ct.DoneMenuText,{}),onClickRight:t.close}:{menuType:Me.ZP.MenuType.Popup,minWidth:270,maxWidth:360,footer:this.renderFooter()},l().createElement(Me.ZP,i,s.map(((t,i)=>n()(a.Fragment,{},t,this.renderAccountHeader(t),n()("div",{style:e.isMobile?{paddingTop:10}:i!==s.length-1?{borderBottom:"1px solid ".concat(this.theme.lightDividerColor)}:{}},void 0,n()(ve.Z,{type:ve.Z.Type.Vertical,sections:this.getMenuListSections(t),initialFocus:void 0}))))),e.isMobile&&this.renderFooter())}})}renderAccountHeader(e){const{online:t}=ft.Z.state,i=Ui.Z.getUserEmailAddress(this.environment,e);return i&&n()(Ci,{emailAddress:i,userId:e,disabled:!t,accountActions:[(0,G.qu)(e),(0,G.pD)(e)]})}renderFooter(){const{redirectURL:e,disableLoginLink:t}=this.props,i=l().createElement(l().Fragment,null,!this.hasAtLeastOneTeamPlan()&&l().createElement(eo,b()({createType:"create-work",redirectURL:e,disableLoginLink:t},this.stores)),l().createElement(eo,b()({createType:"add-account",redirectURL:e,disableLoginLink:t},this.stores)));return n()("div",{style:this.getFooterStyle()},void 0,n()(Se.Z,{topBorder:!0},void 0,bi.k(this.environment)&&i,this.renderLogoutAll()),!this.isMobile&&n()(Se.Z,{topBorder:!0},void 0,this.renderDownloadApps()))}renderDownloadApps(){const{device:e}=this.environment;return e.isElectron?n()(io.Z,{external:!0,href:Te.AR.mobile,onClick:this.handleMobileAppClick},void 0,n()(fe.Z,{focused:!1,title:n()("div",{style:{color:this.theme.mediumTextColor,fontSize:12}},void 0,n()(_._H,{defaultMessage:"Get iOS & Android app",id:"sidebarMultiSwitcher.desktopAppGetMobileApp.prompt"}))})):n()(io.Z,{external:!0,href:Te.AR.desktop,onClick:this.handleDesktopAppClick},void 0,n()(fe.Z,{focused:!1,title:n()("div",{style:{color:this.theme.mediumTextColor,fontSize:12}},void 0,e.isWindows?n()(_._H,{defaultMessage:"Get Windows app",id:"sidebarMultiSwitcher.windowsAppButton.text"}):n()(_._H,{defaultMessage:"Get Mac app",id:"sidebarMultiSwitcher.macAppButton.text"}))}))}renderLogoutAll(){const{online:e}=ft.Z.state;return n()(fe.Z,{onClick:this.logout,focused:!1,disabled:!e,title:n()("div",{style:{...this.getAccountActionStyle(),paddingLeft:0}},void 0,n()(_._H,{defaultMessage:"Log out all",id:"sidebarSwitcherMultiAccount.menuItem.logoutAllButton.label"}))})}getMenuListSections(e){const{device:t}=this.environment,i=Ui.Z.getSpaceViewStores(this.environment,e).map((e=>e.pointer)).map((e=>({id:e.id,spaceId:(0,lo.CG)(e.spaceId)}))).map(so.vY);return[{key:"spaces",render:o=>l().createElement(Se.Z,b()({},o,{disableMobilePadding:!0,topBorder:t.isMobile,children:t.isMobile?o.children:n()(a.Fragment,{},void 0,n()(Ii.Z,{direction:Ii.K.Vertical,keys:i,renderKey:e=>o.children[i.indexOf(e)],onDrop:this.handleDraggableListDrop(e),isSidebarSwitcher:!0}))})),items:this.getSpaceMenuListItems(e)}]}renderSpaceMenuItem(e){const{device:t}=this.environment,{online:i}=ft.Z.state,o=!this.isOnlySpace(e.userId)&&!t.isMobile;return l().createElement(Ti,b()({},e.props,{id:e.id,icon:e.icon,title:e.title,caption:e.subtitle,isCheck:e.isCurrentSpace,unreadMentions:e.unreadMentions,showDragHandle:o,shortcut:void 0!==e.shortcutIndex&&e.shortcutIndex<=9?t.isElectronMac?"⌘".concat(e.shortcutIndex):"ctrl+".concat(e.shortcutIndex):void 0,disabled:!i&&this.environment.currentUser.id!==e.userId,disableTooltip:!0}))}getSpaceMenuListItems(e){const{onSpaceClick:t}=this.props,{device:i}=this.environment,o=[],{currentUserRootStore:n,currentSpaceStore:s}=A.Z.state,r=Ui.Z.getSpaceViewStores(this.environment,e),a=Ui.Z.getAllSpaceViewStores(this.environment);if(!n||!s)return[];for(const[l,d]of r.entries()){const r=d.getSpaceStore();if(r){const l=e===n.id&&r.id===s.id,{results:c}=xi.Z.state,h=c.find((e=>e.spaceId===r.id)),p=(0,Li.getSpaceName)(this.environment,r);let u;const m=Bi.Z.getPublicSpaceData(this.environment,r.id);if(m){const e=m.productId?this.props.intl.formatMessage((0,Ve.em)(m.productId)):this.props.intl.formatMessage("team"===r.getPlanType()?Ve.js.teamTrialPlan:Ve.js.personalPlan);u=this.props.intl.formatMessage("personal"===r.getPlanType()?Ve.js.workspaceSubtitleWithoutMembers:Ve.js.workspaceSubtitleWithMembers,{numberOfWorkspaceMembers:this.props.intl.formatNumber(m.memberCount),planType:e})}const g=ue().findIndex(a,(e=>e.id===d.id))+1;o.push({key:d.id,render:t=>this.renderSpaceMenuItem({id:r.id,props:t,title:p,subtitle:u,shortcutIndex:i.isElectron?g:void 0,icon:(0,Li.getSpaceIcon)(this.environment,r),isCurrentSpace:l,userId:e,unreadMentions:h&&h.spaceId!==s.id&&h.unread.mentions>0?h.unread.mentions:void 0}),action:async({event:e})=>{this.close(),l||await t({event:e,spaceViewStore:d}),W.sos(this.environment)}})}}return o}close(){Pi.Z.setState({...Pi.Z.state,open:!1})}get isMobile(){return this.props.format===ho.Mobile}isOnlySpace(e){return 1===(e?Ui.Z.getSpaceViewStores(this.environment,e):Ui.Z.getAllSpaceViewStores(this.environment)).length}hasAtLeastOneTeamPlan(){return Ui.Z.hasAtLeastOneTeamPlan(this.environment)}getUnreadCountForOtherSpaces(){return xi.Z.getUnreadMentionsCountForOtherSpaces()}}r()(po,"Format",ho),r()(po,"buttonStyle",{display:"flex",alignItems:"center",minWidth:0,height:"100%",width:"100%"});const uo=(0,_.XN)(po);var mo=i(30381),go=i.n(mo),bo=i(32918);let yo;!function(e){e.Relevance="Relevance",e.LastEditedNewest="LastEditedNewest"}(yo||(yo={}));var vo=i(58879),So=i(79689),fo=i(83420),Mo=i(66897),ko=i(89940),To=i(66055),Zo=i(64215);function wo(e){const{actorPointer:t,timestamp:i,store:o}=e,s=(0,_.YB)(),r=(0,Ae.Z)(Math.min(i,Date.now())).calendar(),a=(0,ko.VK)((()=>t?(0,fo.u)({parentStore:o,pointer:t}):void 0),[t,o]),l=a&&(0,Mo.$4)(s,a);return n()("div",{},void 0,l?n()(_._H,{id:"sharedWithMePage.menuItem.caption",defaultMessage:"Edited by {actorName} · {time}",values:{time:r,actorName:l},description:"Caption for a shared page that shows the time the page was last edited or the time at which the user was invited, and by whom (e.g. 'Today at 11:00am • Ivan Zhao'"}):r)}function Co(e){const{store:t,type:i}=e,[o,s]=l().useState(!1),r=(0,vo.O7)(),a=(0,vo.MO)(),d=n()(_._H,o?{defaultMessage:"Link copied",id:"sharedWithMePageMenuItem.linkCopied.tooltip",description:"Tooltip shown when user copied link to a shared page"}:{defaultMessage:"Copy link",id:"sharedWithMePageMenuItem.copylinkToPage.tooltip",description:"Shortcut for copying a link to a shared page from the 'Shared With Me' pop-up"});return n()(x.Z,{placement:x.Z.Placement.Bottom,renderTooltip:()=>d,forceVisibleState:o||void 0,render:e=>l().createElement(kt.Z,b()({isGray:!0,style:{marginRight:2},onClick:e=>{To.Hs({environment:r,blocks:[t],event:e}),a&&(So.S.update((e=>({...e,[i]:!1}))),ht.xv()),W.buA(r,{type:i}),s(!0),setTimeout((()=>{s(!1)}),1e3)}},e,{onMouseLeave:t=>{s(!1),e.onMouseLeave(t)}}),h.Z.link({width:a?18:16,height:a?18:16}))})}function Io(e){const{isPinned:t,store:i,spaceViewStore:o,type:s}=e,r=(0,vo.O7)(),a=(0,vo.MO)(),[{online:d}]=(0,ko.oR)(ft.Z),[{currentUserSettingsStore:c}]=(0,ko.oR)(A.Z),p=(0,Zo.y)((e=>({pinned:{width:a?18:16,height:a?18:16,fill:e.regularIconColor},unpinned:{width:a?18:16,height:a?18:16}})),[a]);return n()(x.Z,{disableTooltip:!d,placement:x.Z.Placement.Bottom,renderTooltip:()=>n()(_._H,t?{defaultMessage:"Remove from sidebar",id:"outlinerViewAllMenuList.removeFromSidebar.tooltip",description:"Tooltip displayed when user can remove a pinned page from the sidebar"}:{defaultMessage:"Add to sidebar",id:"outlinerViewAllMenuList.addToSidebar.tooltip",description:"Tooltip displayed when user can pin a page to the sidebar"}),render:e=>l().createElement(kt.Z,b()({},e,{isGray:!0,onClick:()=>{c&&(0,N.H5)(r,(e=>{t?(ht.tP({environment:r,store:i,spaceViewStore:o,userSettingsStore:c,transaction:e}),W.An9(r,{type:s,from:"sidebar_dropdown_menu"})):(ht.kJ({environment:r,store:i,spaceViewStore:o,userSettingsStore:c,transaction:e}),W.qYb(r,{type:s}))}))},disabled:!d,style:d?void 0:{cursor:"default"}}),t?h.Z.pinFilled(p.unpinned):h.Z.pin(p.pinned))})}const Po=l().forwardRef(((e,t)=>{const{store:i,timestamp:o,actorPointer:s,type:r,...a}=e,d=(0,ko.VK)((()=>i.getIcon()),[i]),c=(0,ko.VK)((()=>i.isEmptyPage()),[i]);return l().createElement(fe.Z,b()({},a,{ref:t,title:n()(B.Z,{store:i}),icon:n()(C.Z,{disabled:!0,icon:d,isEmptyPage:c,size:19}),caption:n()(wo,{actorPointer:s,store:i,timestamp:o}),right:n()("div",{style:{display:"flex"}},void 0,n()(Co,{store:i,type:r}),l().createElement(Io,e))}))}));function xo(e){const{sections:t}=e,i=1===t.length;return t.map((({key:t,pages:o},n)=>({key:t,items:Bo({...e,pages:o}),render:e=>l().createElement(Se.Z,b()({},e,{topBorder:0!==n,title:i?void 0:Ao(t)}))})))}function Bo(e){const{environment:t,spaceStore:i,pages:o,visiblePageIds:n,closePopover:s,type:r,query:a,sortBy:d}=e,c=n.length;return o.map((({blockId:o,timestamp:h,authorId:p,authorTable:m,index:g})=>{const y=u.Z.createChildStore(i,{table:ae.iU,id:o}),v=p&&m?{table:m,id:p}:void 0,S=n.includes(o);return{key:o,action:({event:e})=>{s(),$._c({environment:t,store:y,metaClick:e.metaKey}),t.device.isPhone&&ht.xv(),W._fo(t,{type:r,sortBy:d,queryStringLength:a.length,selectedItemIndex:g})},render:t=>l().createElement(Po,b()({},t,e,{store:y,timestamp:h,actorPointer:v,isPinned:S,spaceId:i.id,pinnedAmount:c}))}}))}function Ao(e){switch(e){case"today":return n()(_._H,{id:"sharedWithMePopover.todaySection.label",defaultMessage:"Today"});case"past-week":return n()(_._H,{id:"sharedWithMePopover.pastWeekSection.label",defaultMessage:"Past week"});case"earlier":return n()(_._H,{id:"sharedWithMePopover.earlierSection.label",defaultMessage:"Earlier"});default:throw ot.t1(e)}}const Ro=function(e){const t=(0,vo.O7)(),[i,o]=(0,ko.oR)(So.S);return n()(ve.Z,{type:ve.Z.Type.Vertical,initialFocus:void 0,sections:xo({...e,environment:t,closePopover:()=>{o({...i,[e.type]:!1})}})})};var _o=i(78092),Lo=i(33058),Fo=i(47966);function Ho(e){const{userSettingsStore:t,helpDocsHref:i}=e,o=(0,vo.O7)(),{WindowSizeStore:s}=o,r=(0,vo.MO)(),a=(0,ko.VK)((()=>t.getSettings().completed_enhanced_sidebar_intro),[t]),l=(0,Zo.y)((e=>({banner:{boxShadow:"0 1px 0 ".concat(e.regularDividerColor),width:"100%",minHeight:52,paddingTop:r?16:14,paddingBottom:r?18:10,paddingLeft:r?s.getSafePaddingLeftCSS(18):s.getSafePaddingLeftCSS(16),paddingRight:r?s.getSafePaddingRightCSS(20):s.getSafePaddingRightCSS(12),backgroundColor:r?e.darkBannerBackground:e.sidebarSecondaryBackground,display:"flex",alignItems:"center",justifyContent:"space-between",position:"relative"},dismissButton:{backgroundColor:e.buttonBackground},learnMoreText:{color:e.mediumTextColor},learnMoreMobile:{marginTop:10,width:110}})),[s,r]);return a?null:n()("div",{style:l.banner},void 0,n()("div",{style:{display:"flex",flexDirection:"column",fontSize:r?14:12,lineHeight:r?"24px":"20px",marginLeft:r?22:20}},void 0,n()("div",{style:{fontWeight:R.Z.fontWeight.medium,position:"relative"}},void 0,n()("div",{style:{position:"absolute",top:r?5:3,left:r?-22:-20}},void 0,h.Z.pinFilled({width:10,opacity:"65%"})),n()("div",{},void 0,n()(_._H,{id:"enhancedSidebarFeatureTour.pinPages.primaryText",defaultMessage:"Organize your shared pages here"}))),n()("div",{},void 0,n()(_._H,{id:"enhancedSidebarFeatureTour.pinPages.secondaryText",defaultMessage:"Pin frequently visited pages to the sidebar"})),r?n()(Fo.Z,{style:l.learnMoreMobile,onClick:e=>{e.preventDefault(),(0,$.Db)({environment:o,url:i})}},void 0,n()(_._H,{id:"enhancedSidebarFeatureTour.pinPages.actionButton",defaultMessage:"Learn more"})):n()(w.Z,{underline:!0,style:l.learnMoreText,inline:!0,external:!0,href:(0,He.U)("guides.sharing")},void 0,n()(_._H,{id:"enhancedSidebarFeatureTour.pinPages.actionText",defaultMessage:"Learn more"}))),n()(Lo.Z,{style:{position:"absolute",top:r?12:7,right:r?12:8},onClick:e=>{e.stopPropagation(),Ke.hx({environment:o,userSettingsStore:t})}},void 0,h.Z.closeThick({width:r?12:10,opacity:"65%"})))}const Eo=(0,_.vU)({searchPlaceholder:{id:"outlinerViewAllPopover.search.placeholder",defaultMessage:"Search for shared pages",description:"Search placeholder text in 'Shared' overflow popover menu"}});function Oo(e){const t=(0,vo.Fy)(),{isMobile:i}=t,{isLoading:o,query:s,onInputChange:r}=e,a=(0,Zo.y)((e=>({iconStyle:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,color:e.regularIconColor},headerContainer:{marginTop:i?0:14,backgroundColor:e.popoverBackground,borderBottom:"1px solid ".concat(e.regularDividerColor)},sortContainer:{margin:i?"4px 14px":"4px 14px 0"}})),[i]),[{currentUserSettingsStore:d}]=(0,ko.oR)(A.Z);return l().createElement(l().Fragment,null,d&&n()(Ho,{userSettingsStore:d,helpDocsHref:(0,He.U)("guides.sharing")}),n()("div",{style:a.headerContainer},void 0,n()(pt.Z,{style:{...t.isAndroid&&{borderBottom:"none"}},left:n()(ct.Z,{show:o,showDelay:500,showHold:300,render:e=>e?n()(V.Z,{style:a.iconStyle}):h.Z.searchThick(a.iconStyle)}),showClearButton:!0,placeholder:wt.Z.formatMessage(Eo.searchPlaceholder),focus:!t.isMobile||void 0,value:s,onChange:e=>{r(e.target.value)}}),n()("div",{style:a.sortContainer},void 0,n()(_o.Z,{currentSortBy:e.sortBy,setSortBy:e.setSortBy,sortOptions:Vo}))))}function Uo(){return n()(Se.Z,{topBorder:!0,disableDesktopPadding:!0},void 0,n()(Tt.Z,{title:n()(_._H,{defaultMessage:"Learn about shared pages",id:"sharedWithMePopover.learnMore.prompt",description:"Link to a guide to learn more about 'Shared with Me' in popover menu"}),href:(0,He.U)("guides.sharing"),analyticsFrom:"sharing"}))}function Do(){return n()(Zt.Z,{href:(0,He.U)("guides.sharing"),analyticsFrom:"sharing"})}function No(e){const{pages:t,sortBy:i}=e,o=function(e,t){const i="today",o="past-week",n="earlier",s=bo.bU(bo.x7).startOf("day").valueOf(),r=go()(s).subtract(1,"week").valueOf(),a=ue().groupBy(e,(({timestamp:e})=>t===yo.Relevance?n:e>s?i:e>r?o:n));let l=-1;return ue().compact([i,o,n].map((e=>{const t=a[e];if(t&&0!==t.length)return{key:e,pages:t.map((e=>(l+=1,{...e,index:l})))}})))}(t,i);return 0===o.length?n()(Wo,{}):l().createElement(Ro,b()({},e,{sections:o}))}function Wo(){const e=(0,vo.Fy)(),{isMobile:t}=e,i=(0,Zo.y)((e=>({placeHolderStyle:{textAlign:"center",padding:"".concat(t?64:0,"px 20px 0"),display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:t?void 0:"100%",minHeight:t?void 0:200},iconStyle:{width:36,fill:e.lightIconColor},contentStyle:{fontSize:14,color:e.mediumTextColor,maxWidth:260}})),[t]),o=n()(_._H,{defaultMessage:"No pages found",id:"outlinerViewAllPopover.search.noMatchesPrompt",description:"Message when 'View all' popover query results are empty"});return n()("div",{style:i.placeHolderStyle},void 0,n()("div",{style:{paddingBottom:12}},void 0,h.Z.paperAirplane(i.iconStyle)),n()("div",{style:{...i.contentStyle,fontWeight:500}},void 0,o))}const Vo=[{key:yo.Relevance,formattedName:n()(_._H,{id:"sharedWithMePopover.sortOrder.relevance",defaultMessage:"Relevance"})},{key:yo.LastEditedNewest,formattedName:n()(_._H,{id:"sharedWithMePopover.sortOrder.lastEditedNewest",defaultMessage:"Last edited"})}],qo=function(e){const t=(0,vo.O7)(),{device:i}=t,[o,s]=(0,ko.oR)(So.S),r=l().createElement(Oo,e);let a;return a=i.isMobile?{menuType:Me.ZP.MenuType.Modal,title:n()(_._H,{defaultMessage:"Shared",id:"outlinerViewAllPopover.menu.header",description:"Label for mobile popover menu that displays overflow of shared pages"}),left:n()(Do,{}),right:n()(Ct.DoneMenuText,{}),onClickRight:()=>{s({...o,[e.type]:!1})},header:r}:{menuType:Me.ZP.MenuType.Popup,width:400,header:r,footer:n()(Uo,{})},l().createElement(Me.ZP,a,l().createElement(No,b()({},e,{pages:e.sharedPages})))};var zo=i(15692),Go=i(63143),jo=(i(65069),i(46735));function Ko(e){const{allSharedPages:t,query:i,intl:o}=e;return t.map((e=>{const t=e.getValue();if(!t)return;const n=t.last_edited_time||t.created_time;if(!n)return;const{id:s,last_edited_by_id:r,last_edited_by_table:a,created_by_id:l,created_by_table:d}=t;let c,h;return r&&a?(c=r,h=a):(c=l,h=d),function(e){const{block:t,query:i,getRecordValue:o,userTimeZone:n,intl:s}=e;if(!i)return!0;const r=t?It.T5({table:ae.iU,value:t,getRecordValue:o,userTimeZone:n,intl:s}):void 0;return!!r&&r.toLowerCase().indexOf(i.trim().toLowerCase())>=0}({block:t,query:i,getRecordValue:e.getRecordValue,userTimeZone:bo.x7,intl:o})?{blockId:s,timestamp:n,authorId:c,authorTable:h}:void 0})).filter(ot.$K)}var Yo=i(79828),Qo=i(59054);function Xo(e){const{isPopoverOpen:t,isMobile:i,onClick:o,total:s,userSettingsStore:r}=e,a=(0,Zo.y)((e=>({item:{background:t?e.buttonHoveredBackground:void 0,marginBottom:i?16:void 0},flexRow:{display:"flex",alignItems:"center",fontSize:i?16:12}})),[t,i]),l=(0,ko.VK)((()=>r.getSettings().completed_enhanced_sidebar_intro),[r]);return n()(K.Z,{mobileFeedback:i,onClick:o},void 0,n()(P.Z,{style:a.item,isMobile:i,disableMobileBorder:!0},void 0,n()("div",{style:a.flexRow},void 0,n()(_._H,{defaultMessage:"View all ({total})",id:"viewMoreOutlinerButton.label",description:"Label for popover menu that displays all pages for an overflowing section in the sidebar. The count represents total number of pages  (e.g. View all (8))",values:{total:s}}),!l&&n()("div",{style:{marginLeft:8}},void 0,n()(Yo.Z,{margin:!1})))))}const Jo=function(e){const{isMobile:t,allSharedPages:i,type:o,originRef:s,userSettingsStore:r,spaceStore:a}=e,d=(0,vo.O7)(),c=(0,_.YB)(),h=a.id,p=r.id,[u,m]=l().useState(void 0),[g,y]=(0,ko.oR)(So.S),v=Boolean(g[o]),[{status:S}]=(0,Qo.r5)((async()=>{await(0,no.lO)({environment:d,spaceId:h,userId:p})}),[d,h,p],{debounce:St.vp,interval:v?30*Go.C0:5*Go.hM}),f=l().useCallback((()=>{y((e=>({...e,[o]:!0}))),m(s.current?s.current.getBoundingClientRect():void 0),W.kVp(d,{type:o,from:t?"sidebar_mobile":"sidebar"})}),[d,y,o,s,t]),M=l().useCallback((()=>{y((e=>({...e,[o]:!1})))}),[y,o]),[k,T]=l().useState(""),Z=l().useRef(void 0);l().useEffect((()=>(v?Z.current&&(clearTimeout(Z.current),Z.current=void 0):Z.current=setTimeout((()=>{T("")}),2*Go.hM),()=>{Z.current&&(clearTimeout(Z.current),Z.current=void 0)})),[v]);const w=l().useMemo((()=>function(e){const{spaceId:t,type:i}=e;return"".concat(t,"-").concat(i,"-outliner-sort")}({spaceId:h,type:o})),[h,o]),[C,I]=l().useState((()=>X.Z.get({userId:p,key:w})||yo.Relevance)),P=(0,ko.VK)((()=>Ko({allSharedPages:i,query:k,intl:c})),[i,k,c]),x=l().useMemo((()=>function(e){const{sharedPageItems:t,sortBy:i,currentUserId:o}=e;switch(i){case yo.Relevance:return jo.Z.sortFrecencyHighToLow({items:t.map((e=>({...e,id:e.blockId,score:e.timestamp}))),now:Date.now(),currentUserId:o});case yo.LastEditedNewest:return ue().sortBy(t,(({timestamp:e})=>e)).reverse();default:return t}}({sharedPageItems:P,sortBy:C,currentUserId:p})),[P,C,p]);return n()(zo.ZP,{popupType:t?zo.ZP.PopupType.SlideUp:zo.ZP.PopupType.Popup,originRect:u,alignmentToOrigin:zo.ZP.Alignment.Start,placementToOrigin:zo.ZP.Placement.Right,originGap:0,isFullWidthOnMobile:!0,preventScaleTransition:!0,open:v,onDismiss:M,render:()=>l().createElement(qo,b()({},e,{isLoading:"pending"===S,query:k,onInputChange:T,sortBy:C,setSortBy:e=>{X.Z.set({userId:p,key:w,value:e}),I(e),W.Sz4(d,{type:o,from:C,to:e})},sharedPages:x,allSharedPageIds:i.map((({id:e})=>e))})),origin:n()(Xo,{isPopoverOpen:v,isMobile:t,onClick:f,total:i.length,userSettingsStore:r})})};var $o=i(52533);class en extends d.Z{constructor(...e){super(...e),r()(this,"sidebarState",this.createComputedStore((()=>(0,ze.vK)(this.environment)))),r()(this,"storeTypes",{scrollerStore:hi.Z}),r()(this,"handleScrollerMount",(e=>{pi.Z.SidebarMobileScroller=e})),r()(this,"handleCloseSidebar",(()=>{ht.xv()})),r()(this,"handleClickFind",(()=>ce.Kf({environment:this.environment,analyticsFrom:"sidebar-mobile"}))),r()(this,"handleOrientationChange",(()=>{ht.xv()})),r()(this,"isScrolledToTop",this.createComputedStore((()=>0===this.stores.scrollerStore.state.scrollTop))),r()(this,"isCurrentIAPSubscriber",(()=>{const{currentUserRootStore:e}=A.Z.state,t=(0,Fe.xR)({environment:this.environment,userRootStore:e});return!(!t||!t.includes(ge.Z.revenueCat.productIDs.personal.monthly)&&!t.includes(ge.Z.revenueCat.productIDs.personal.yearly))}))}willMount(){window.addEventListener("resize",this.handleOrientationChange)}willUnmount(){window.removeEventListener("resize",this.handleOrientationChange)}renderComponent(){const e=Ve.Jr(this.environment);return e?n()(mi.Z,{render:()=>n()("div",{className:se.yk,style:this.getWrapStyle()},void 0,!e&&n()(di,{}),this.renderSidebar()),isVisible:!0,animationStyle:{width:e?Ve.Wk(this.environment):"100vw"}}):n()("div",{className:se.yk,style:{...this.getWrapStyle(),width:"100vw"}},void 0,!e&&n()(di,{}),this.renderSidebar())}renderSidebar(){return n()(oi.Z,{capture:!Ve.Jr(this.environment)&&si.TC.get(),onBackButton:this.handleCloseSidebar},void 0,n()("div",{style:this.getStyle()},void 0,this.renderTopbar(),this.renderOutliner()))}renderTopbar(){const{device:e}=this.environment,t=e.isMobileNative&&e.isTablet&&Ve.Jr(this.environment);return n()("div",{style:this.getTopbarStyle()},void 0,n()(uo,{shouldShowUnexpandButton:t,format:ho.Mobile,onSpaceClick:async({event:e,spaceViewStore:t})=>{await vi.y3({environment:this.environment,spaceViewStore:t,userSettingsStore:A.Z.state.currentUserSettingsStore,userRootStore:A.Z.state.currentUserRootStore,metaClick:e.ctrlKey||e.metaKey})}}),!e.isMobileNative&&n()(K.Z,{onClick:this.handleClickFind,mobileFeedback:!0,style:en.actionButtonStyle},void 0,h.Z.mobileBottomBarSearch({width:26})))}renderOutliner(){const{currentSpaceStore:e,currentSpaceViewStore:t,currentUserRootStore:i,currentUserStore:o,currentUserSettingsStore:s,currentBlockStore:r}=A.Z.state,a=this.sidebarState.state;if(!(a&&r&&t&&i&&e&&o&&s))return;const d=e.canEdit(),c=(0,$o.S)({environment:this.environment})&&"personal_free"===(0,Fe.CM)(this.environment)&&qt.Z.state.data&&"unsubscribed_admin"===qt.Z.state.data.type&&qt.Z.state.data.revenueCatEnabled&&!this.isCurrentIAPSubscriber();return n()(Lt.Z,{store:e,disableEditNearestBlock:!0,render:i=>l().createElement(he.ZP,{store:this.stores.scrollerStore,ref:this.handleScrollerMount,style:en.outlinerStyle,disableScroll:Ft.H6(this.environment),type:he.xm.Y},a.showBookmarksSection&&n()(st,{isMobile:!0,type:"bookmarks",spaceStore:e,spaceViewStore:t,showAddPageButton:!1,renderSidebar:()=>n()(de,{isMobile:!0,type:"bookmarks",isTopLevel:!0,spaceStore:e,spaceViewStore:t,parentStore:t.getBookmarkedPagesStore(),childStores:t.getBookmarkedPages(),showAddPageButton:!1,onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,disabled:!d})}),a.showWorkspaceSection&&n()(st,{isMobile:!0,type:"workspace",spaceStore:e,spaceViewStore:t,showAddPageButton:!1,renderSidebar:()=>n()(de,{isMobile:!0,type:"workspace",isTopLevel:!0,spaceStore:e,spaceViewStore:t,parentStore:e.getPagesStore(),childStores:t.getWorkspacePages(),addPageTitle:n()(_._H,{defaultMessage:"Add a page",id:"sidebarMobile.addPageToWorkspace.title"}),onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,showAddPageButton:!0,disabled:!d})}),a.showSharedSection&&n()(st,{isMobile:!0,type:"shared",spaceStore:e,spaceViewStore:t,showAddPageButton:!1,renderSidebar:i=>l().createElement(l().Fragment,null,n()(de,{isMobile:!0,type:"shared",isTopLevel:!0,spaceStore:e,spaceViewStore:t,parentStore:t.getSharedPagesStore(),childStores:a.visibleSharedPagesStores,showAddPageButton:!1,onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,disabled:!d}),a.showSharedOverflowButton&&n()(Jo,{originRef:i,isMobile:!0,type:"shared",spaceStore:e,spaceViewStore:t,userSettingsStore:s,allSharedPages:a.allSharedPagesStores,visiblePageIds:a.visibleSharedPagesStores.map((({id:e})=>e))}))}),a.showPrivateSection&&!a.showOnlyPrivateSection&&n()(st,{isMobile:!0,type:"private",spaceStore:e,spaceViewStore:t,showAddPageButton:!1,renderSidebar:()=>n()(de,{isMobile:!0,type:"private",isTopLevel:!0,spaceStore:e,spaceViewStore:t,parentStore:e.getPagesStore(),childStores:t.getPrivatePages(this.environment),addPageTitle:n()(_._H,{defaultMessage:"Add a page",id:"sidebarMobile.addAPrivatePage.title"}),showAddPageButton:!0,onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,disabled:!d})}),a.showOnlyPrivateSection&&n()(de,{isMobile:!0,type:"private",isTopLevel:!0,spaceStore:e,spaceViewStore:t,parentStore:e.getPagesStore(),childStores:t.getPrivatePages(this.environment),addPageTitle:n()(_._H,{defaultMessage:"Add a page",id:"sidebarMobile.addAPageToOnlyPrivateSection.title"}),showAddPageButton:!0,onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,disabled:!d}),a.showOnlyPrivateSection&&n()("div",{style:{height:20}}),n()(ii,{store:e}),n()(Qt,{isMobile:!0}),e.canEdit()&&n()(_t,{store:r,isMobile:!0}),c&&n()($t,{}),n()(et,{isMobile:!0}),n()("div",{style:{height:128}}))})}getWrapStyle(){return Ve.Jr(this.environment)?{display:"block",height:"100vh",position:"relative",zIndex:3}:Ve.YR(this.environment)?{display:"block",height:"100vh",position:"fixed",top:0,right:"100%",zIndex:3}:{display:"block",height:"100vh",position:"fixed",top:0,left:0}}getStyle(){return{display:"flex",flexDirection:"column",width:Ve.qG(this.environment),height:"100%",background:Ve.YR(this.environment)?this.theme.mobileSidebarAndroidBackground:this.theme.mobileSidebarIOSBackground,willChange:"transform",color:this.theme.mediumTextColor,...Ve.YR(this.environment)&&{marginLeft:"auto"},...Ve.Jr(this.environment)&&{position:"absolute",right:0},cursor:"pointer"}}getTopbarStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",alignItems:"center",justifyContent:"space-between",flex:"none",height:gi.g,marginTop:e.state.paddingTopCSS,paddingLeft:12,boxShadow:Ve.YR(this.environment)&&!Ve.Jr(this.environment)&&si.TC.state?this.isScrolledToTop.state?this.theme.topbarAndroidShadowCollapsed:this.theme.topbarAndroidShadow:"0 1px 0 ".concat(this.theme.darkDividerColor),background:Ve.YR(this.environment)?this.theme.androidSidebarBackground:ui.ZP.transparent,transition:"box-shadow 300ms",width:"100%",zIndex:1}}}r()(en,"outlinerStyle",{flexGrow:1,paddingTop:12,userSelect:"none",WebkitUserSelect:"none"}),r()(en,"actionButtonStyle",{display:"flex",alignItems:"center",justifyContent:"center",flex:"none",height:"100%",width:44,paddingRight:6});const tn=en},47589:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ge});var o=i(67154),n=i.n(o),s=i(98135),r=i.n(s),a=i(59713),l=i.n(a),d=(i(33948),i(67294)),c=i.n(d),h=i(51454),p=i(50906),u=i(3779),m=i(26435),g=i(64442),b=i(61766),y=i(1449),v=i(46167),S=i(66832),f=i(48601),M=i(43803),k=i(87953),T=i(53786),Z=i(39849),w=i(21325),C=i(76668),I=i(24677),P=i(22789),x=i(52258),B=i(76487),A=i(14947),R=i(43250),_=i(67669),L=i(42001),F=i(13612),H=i(87531),E=i(27832),O=i(29974),U=i(82990),D=i(11302),N=i(40515),W=i(79029),V=i(15517),q=i(70951),z=i(8848),G=i(2107),j=i(39865),K=i(8646),Y=i(20088),Q=i(85404),X=i(42330),J=i(64581),$=i(71802),ee=i(7755),te=i(45094),ie=i(11819),oe=i(5366),ne=i(62442),se=i(41507),re=i(38755),ae=i(84122),le=i(77907),de=i(24666),ce=i(98104),he=i(69454),pe=i(3750),ue=i(30366);class me extends S.Z{constructor(...e){super(...e),l()(this,"storeTypes",{shareButtonPopupStore:b.Z}),l()(this,"handleOpenQuickFind",(()=>{H.UT({environment:this.environment,analyticsFrom:"public-page-topbar"})})),l()(this,"handleShareClick",(()=>{p.DB2(this.environment),w.bi(this.environment)})),l()(this,"handleTopbarClick",(()=>{I.ZH(this.environment)})),l()(this,"navigateToFirstSpace",(()=>{const{currentUserRootStore:e,currentUserSettingsStore:t}=E.Z.state;e&&t&&O.L5({environment:this.environment,userRootStore:e,userSettingsStore:t})})),l()(this,"handleMoveToClick",(e=>{D.bA({blocks:[this.props.store],analyticsFrom:"quick_add",onAccept:this.handleMoveToAccept,isAddTo:!0})})),l()(this,"handleMoveToAccept",(e=>{const{currentSpaceStore:t}=E.Z.state;t&&this.props.saveParent&&V.rq({currentUserId:this.environment.currentUser.id,spaceId:t.id,value:e}),p.xx2(this.environment)})),l()(this,"handleCancelQuickAdd",(e=>{const t=E.Z.state.currentBlockStore,i=X.Z.state.lastPageId;t&&i&&(G._c({environment:this.environment,store:m.Z.createChildStore(t,{table:Q.iU,id:i}),showMoveTo:!1,saveParent:!1}),K.H5(this.environment,(e=>{j.y8({environment:this.environment,blocks:[t],transaction:e})})))}))}renderComponent(){const{store:e}=this.props,{WindowSizeStore:t,device:i}=this.environment,o=(0,_.IJ)(this.environment,this.props.store);return r()(k.Z,{capture:!0,render:s=>c().createElement("div",n()({},s,{style:this.getWrapStyle()}),o?this.renderPublicPageTopbar():this.renderNormalTopbar(),e.canEdit()&&i.isPhone&&r()(P.Z,{store:this.props.store,isMobile:!0},this.props.store.id),this.props.isOffline&&r()(Y.Z,{type:Y.$.White,isMobile:!0},void 0,r()("div",{style:{display:"flex",alignItems:"center",width:"100%",paddingLeft:t.getSafePaddingLeftCSS(10),paddingRight:t.getSafePaddingRightCSS(14)}},void 0,u.Z.mobileOffline({width:26,marginRight:12}),r()("div",{},void 0,r()(oe._H,{defaultMessage:"You're offline",id:"topbarMobile.offline.message"})))),r()(f.Z,{banners:this.props.banners,isMobile:!0}))})}renderPublicPageTopbar(){const{store:e}=this.props;return r()("div",{onClick:this.handleTopbarClick,style:this.getStyle(),className:R.ZH},void 0,this.environment.currentUser.isLoggedIn()&&r()(d.Fragment,{},void 0,r()(A.Z,{style:{display:"flex",alignItems:"center",height:"100%",paddingLeft:14,paddingRight:14,fontWeight:U.Z.fontWeight.medium,color:this.theme.regularTextColor},mobileFeedback:!0,onClick:this.navigateToFirstSpace},void 0,r()(oe._H,{defaultMessage:"Back",id:"topbarMobile.backButton.label"})),r()("div",{style:{height:18,width:1,flexShrink:0,marginRight:6,background:this.theme.darkDividerColor}})),r()(y.Z,{store:this.props.store,style:this.getBreadcrumbsStyle(),maxAncestorCount:1,showCurrentPageControls:!1,ancestorMaxWidth:100,currentPageMaxWidth:220,isMobile:!0}),r()("div",{style:{flexGrow:1,flexShrink:1}}),r()(L.Z,{onClick:this.handleOpenQuickFind},void 0,u.Z.searchThick({width:20,height:20})),r()(F.Z,{store:e,buttonPopupStore:x.Z}))}renderNormalTopbar(){const{store:e,pageVisitStore:t,presenceStore:i}=this.props,{isTablet:o}=this.environment.device,n=this.props.isInvalidPage;return r()("div",{onClick:this.handleTopbarClick,style:this.getStyle(),className:R.ZH},void 0,this.renderHamburgerButton(),o&&r()(ne.Z,{}),!n&&this.renderBreadcrumbs(),e.canEdit()&&o&&r()(P.Z,{store:e,isMobile:!1},e.id),r()(T.Z,{}),e.isRestricted()&&r()(ae.Z,{style:{marginRight:8},onClick:()=>{this.stores.shareButtonPopupStore.setState({open:!0})}}),o&&e.canEdit()&&t&&i&&r()(ie.Z,{rootStore:e,pageVisitStore:t,presenceStore:i}),this.props.shouldShowMoveTo?this.renderCancelQuickAdd():this.renderRightButtons())}renderHamburgerButton(){const e=B.Z.getUnreadMentionsCountForOtherSpaces();return r()(A.Z,{mobileFeedback:!0,style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,height:"100%",width:36,marginLeft:4},onClick:()=>{if((0,te.Jr)(this.environment))C.lE({environment:this.environment,isExpanded:!ee.gV.get()});else{const{NativeMobileActionBarStore:e}=this.environment,t=e?e.state.menuType:null;"editing"===de.Z.state.mode||null!==t?(ce.ZH(this.environment),null==e||e.clear(!1),he.Z.onHide((()=>{pe.Z.afterNextFlush((()=>C.bA()))}))):C.bA()}p.jDo(this.environment)}},void 0,u.Z.hamburgerMenu({width:18,height:18}),r()(Z.Z,{color:Z.Z.Color.Red,count:e,style:{position:"absolute",top:9,right:1}}))}renderBreadcrumbs(){const{isTablet:e}=this.environment.device;return this.props.shouldShowMoveTo?this.renderMoveTo():r()(y.Z,{store:this.props.store,style:this.getBreadcrumbsStyle(),maxAncestorCount:e?2:1,showCurrentPageControls:!1,ancestorMaxWidth:e?160:100,currentPageMaxWidth:e?240:220,isMobile:!0})}renderMoveTo(){const{store:e}=this.props,t=e.getParentStore(),{currentSpaceStore:i}=E.Z.state,o=t instanceof g.Z&&i&&t.id===i.id;if(!(t instanceof ue.Z)&&t){if(o)return r()(A.Z,{mobileFeedback:!0,style:me.moveToButtonStyle,onClick:this.handleMoveToClick},void 0,r()(oe._H,{defaultMessage:"<mediumcolor>Add to</mediumcolor>{userAvatar}<mediumweight>Private pages</mediumweight>",id:"topbarMobile.addToPrivateSectionButton.label",values:{mediumcolor:(...e)=>r()("span",{style:{color:this.theme.mediumTextColor,marginRight:8}},void 0,e),mediumweight:(...e)=>r()("span",{style:{fontWeight:U.Z.fontWeight.medium,marginLeft:4}},void 0,e),userAvatar:r()(J.Z,{size:22,avatarShouldShowShadow:!0,userValue:(0,$.S4)(this.environment)})}}),this.renderChevron());{const i=e instanceof g.Z?(0,re.getSpaceIcon)(this.environment,e):e.getIcon();return r()(A.Z,{mobileFeedback:!0,style:me.moveToButtonStyle,onClick:this.handleMoveToClick},void 0,r()("span",{style:{color:this.theme.mediumTextColor}},void 0,r()(oe._H,{defaultMessage:"Add to",id:"topbarMobile.addToPageOrWorkspaceSectionButton.label",description:"Displayed to the user in front of a page or space, like 'Add to Page', where 'Page' is an existing page."})," "),r()(N.Z,{disabled:!0,icon:i,isEmptyPage:t.table===Q.iU&&t.isEmptyPage(),title:t instanceof g.Z?(0,re.getSpaceName)(this.environment,t):void 0,size:24,style:{marginLeft:8,marginRight:4}}),r()(W.Z,{style:{fontWeight:U.Z.fontWeight.semibold},store:t}),this.renderChevron())}}}renderChevron(){return u.Z.chevronDown({marginLeft:4,width:10,fill:this.theme.lightTextColor})}renderRightButtons(){const{device:e}=this.environment;if(!this.props.isInvalidPage)return e.isMobileNative?r()(d.Fragment,{},void 0,this.renderShare(),this.renderShowMore()):r()(d.Fragment,{},void 0,this.renderShowMore(),this.renderShare(),this.renderUpdatesButton())}renderCancelQuickAdd(){return r()(A.Z,{mobileFeedback:!0,style:{display:"flex",alignItems:"center",height:"100%",paddingLeft:16,paddingRight:16,fontWeight:U.Z.fontWeight.medium,color:z.ZP.blue},onClick:this.handleCancelQuickAdd},void 0,r()(oe._H,{defaultMessage:"Cancel",id:"topbarMobile.cancelQuickAddButton.label"}))}renderShowMore(){return r()(M.Z,{store:this.props.store,collectionViewStore:this.props.collectionViewStore,buttonPopupStore:x.Z})}renderShare(){const{device:e}=this.environment;return r()(v.Z,{popupType:e.isMobile?v.Z.PopupType.SlideUp:v.Z.PopupType.Popup,style:{width:460},buttonPopupStore:this.stores.shareButtonPopupStore,onClick:this.handleShareClick,renderOrigin:t=>c().createElement(A.Z,n()({mobileFeedback:!0,style:me.actionButtonStyle},t),e.isAndroid?u.Z.androidShare({width:16,height:16}):u.Z.iOSShare({width:26})),render:()=>r()(le.L_,{buttonPopupStore:this.stores.shareButtonPopupStore,store:this.props.store,onClose:()=>{this.stores.shareButtonPopupStore.setState({...this.stores.shareButtonPopupStore.state,open:!1})}})})}renderUpdatesButton(){return r()(q.Z,{format:q.Z.Format.TopbarMobile})}getWrapStyle(){return{width:"100%",maxWidth:"100vw",zIndex:h.lI}}getStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",maxWidth:"100vw",height:se.g,marginTop:e.state.paddingTopCSS,paddingLeft:e.getSafePaddingLeftCSS(0),paddingRight:this.props.shouldShowMoveTo?e.getSafePaddingRightCSS(0):e.getSafePaddingRightCSS(7),boxShadow:"0 1px 0 ".concat(this.theme.darkDividerColor),background:this.theme.contentBackground,transition:"box-shadow 300ms",WebkitUserSelect:"none",cursor:"pointer"}}getBreadcrumbsStyle(){const{isTablet:e}=this.environment.device;return{flexGrow:0,marginLeft:2,overflow:"auto",WebkitOverflowScrolling:"touch",marginRight:e?16:8,height:"100%"}}}l()(me,"actionButtonStyle",{display:"flex",alignItems:"center",height:"100%",paddingLeft:6,paddingRight:6}),l()(me,"moveToButtonStyle",{display:"flex",alignItems:"center",paddingLeft:8,paddingRight:12,fontSize:U.Z.fontSize.UIRegular.mobile,lineHeight:U.Z.lineHeight.UIRegular.mobile,whiteSpace:"nowrap",minWidth:0});const ge=me},70951:(e,t,i)=>{i.d(t,{Z:()=>ce});var o=i(67154),n=i.n(o),s=i(98135),r=i.n(s),a=i(59713),l=i.n(a),d=(i(33948),i(67294)),c=i.n(d),h=i(19757),p=i(46167),u=i(66832),m=i(14694),g=i(98742),b=i(37235),y=i(82990),v=i(3779),S=i(96486),f=i.n(S),M=i(8522),k=i(63143),T=i(7765),Z=i(32935),w=i(12318),C=i(12235),I=i(65598),P=i(90031),x=i(27832),B=i(88632),A=i(6650),R=i(44615),_=i(8015),L=i(4761),F=i(5366),H=i(70268);const E={mentions:!0,following:!0,archive:!1};class O extends u.Z{constructor(...e){super(...e),l()(this,"storeTypes",{size:w.Z.of(20),checkpoint:w.Z.of(Math.random())}),l()(this,"renderRequest",((e,t,i)=>{const o=x.Z.state.currentSpaceStore;if(!o||e)return r()("div",{style:this.getPlaceholderContentStyle()},void 0,r()(F._H,{defaultMessage:"Something went wrong.",id:"notificationUpdates.unknownErrorMessage"}));if(!t)return r()("div",{style:this.getContentStyle()},void 0,r()(H.B,{areaHeight:window.innerHeight}));const n=t.map((e=>(0,P.Kv)(o,{table:_.uX,id:e}))),s=f().compact(n.map((e=>{const t=e.getValue();if(!t)return;if(t.invalid)return;if(t.visited&&E[this.props.type]||!t.visited&&"archive"===this.props.type)return;const i=I.sl(e);if(!i)return;const o=i.getValue();return o&&!o.invalid?{activity:o,notification:t}:void 0}))),a=this.stores.size.get(),l=0===s.length;return L.Z.setState({...L.Z.state,isCurrentTabEmpty:l}),r()("div",{style:l?this.getPlaceholderContentStyle():this.getContentStyle()},void 0,l&&this.props.empty,r()("div",{className:"notranslate"},void 0,s.map((({activity:e,notification:t},i,n)=>{const s=n.length-1===i;return r()(M.Z,{activity:e,rootStore:o,isLast:s,notification:t,analyticsContext:this.props.analyticsContext,isTopbarUpdatesMenu:!1,source:"notifications"},e.id)}))),r()(C.Z,{onChange:e=>{e<200&&i&&t&&t.length>=a&&this.stores.size.set(t.length+20)}},void 0,!i&&r()(H.B,{areaHeight:window.innerHeight})))})),l()(this,"handleActivityEmit",(()=>{this.stores.checkpoint.set(Math.random())})),l()(this,"handleActivityEmitThrottled",f().throttle(this.handleActivityEmit,1e3)),l()(this,"handleNotificationEmit",k.YX(this.handleActivityEmitThrottled)),l()(this,"notificationListenerReference",void 0)}willMount(){this.startMessageListeners()}willUnmount(){this.stopMessageListeners()}renderComponent(){return B.Z.state.online?this.renderOnline():this.renderOffline()}renderOffline(){return r()("div",{style:this.getPlaceholderContentStyle()},void 0,r()("div",{},void 0,r()(F._H,{defaultMessage:"Please go online to view updates.",id:"notificationUpdates.offline.message"})))}renderOnline(){const{currentUserStore:e,currentSpaceStore:t}=x.Z.state;if(!e||!t)return;const i=t.id,o=this.stores.size.get(),n=this.stores.checkpoint.get(),s=this.props.type;return r()(T.Z,{throttle:1e3,request:{spaceId:i,size:o,type:s,checkpoint:n},performRequest:async({spaceId:e,size:t,type:i})=>{const o=await Z.BOq(this.environment,{spaceId:e,size:t,type:i});if("failed"===o.type)throw o.error;return o.data.notificationIds},render:this.renderRequest})}startMessageListeners(){const{currentUserStore:e}=x.Z.state;if(e){const t=(0,R.Lp)(e.id);this.notificationListenerReference=A.Z.addListener(t,this.handleNotificationEmit,void 0)}}stopMessageListeners(){this.notificationListenerReference&&(A.Z.removeListener(this.notificationListenerReference),this.notificationListenerReference=void 0)}getContentStyle(){const{device:e}=this.environment;return{minHeight:e.isMobile||"mentions"===this.props.type?void 0:"75vh",paddingBottom:e.isMobile?44:0}}getPlaceholderContentStyle(){const{device:e}=this.environment;return{...this.getContentStyle(),paddingTop:e.isMobile?64:void 0,minHeight:e.isMobile?void 0:220,display:"flex",textAlign:"center",alignItems:"center",justifyContent:"center",fontSize:14,color:this.theme.mediumTextColor,overflow:"hidden"}}getSpinnerStyle(e){return{...this.getPlaceholderContentStyle(),minHeight:e?64:220}}}const U=O;var D,N=i(42496),W=i(39849),V=i(95009),q=i(17659),z=i(50906),G=i(17215),j=i(66957),K=i(46034),Y=i(62820),Q=i(14786),X=i(54153),J=i(92083),$=i(76487),ee=i(8848),te=i(80527),ie=i(14947),oe=i(43250),ne=i(42001),se=i(15282),re=i(67669),ae=i(97880),le=i(69972);!function(e){e[e.Sidebar=0]="Sidebar",e[e.SidebarMobile=1]="SidebarMobile",e[e.MobileBottomBarPhone=2]="MobileBottomBarPhone",e[e.MobileBottomBarTablet=3]="MobileBottomBarTablet",e[e.TopbarMobile=4]="TopbarMobile"}(D||(D={}));class de extends u.Z{constructor(...e){super(...e),l()(this,"renderSpaceUpdates",(()=>{const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:V.ZP.MenuType.Modal,title:r()(F._H,{defaultMessage:"All Updates",id:"updatesModal.mobileMenu.title"}),right:r()(se.DoneMenuText,{}),onClickRight:this.closeMenu,left:v.Z.settings({fill:ee.ZP.blue,width:18,height:18}),onClickLeft:this.handleOpenSettings,header:this.renderHeader(),whiteBackground:!0,footer:this.renderFooter()}:{menuType:V.ZP.MenuType.Popup,header:this.renderHeader(),maxHeight:"80vh",height:"auto",footer:this.renderFooter()},r()(K.Z,{onSwipeLeft:this.handleSwipeLeft,onSwipeRight:this.handleSwipeRight,render:e=>c().createElement(V.ZP,n()({},t,e,{className:oe.C1}),r()(le.Z,{capture:!0,allowUndo:!0,allowEsc:!0,render:()=>this.renderContent()}))})})),l()(this,"closeMenu",(()=>{Y.Z.setState({...Y.Z.state,open:!1}),this.setCurrentTabAsRead()})),l()(this,"handleDismiss",(()=>{this.setCurrentTabAsRead()})),l()(this,"handleClick",(()=>{this.handleTrackTab()})),l()(this,"handleSwipeLeft",(()=>{const e=this.tabs.indexOf(L.Z.state.currentTab)+1,t=this.tabs[e];void 0!==t&&this.changeTab(t)})),l()(this,"handleSwipeRight",(()=>{const e=this.tabs.indexOf(L.Z.state.currentTab)-1,t=this.tabs[e];void 0!==t&&this.changeTab(t)})),l()(this,"handleTabClick",(e=>{const t=this.tabs[e];L.Z.state.currentTab!==t&&this.changeTab(t)})),l()(this,"handleOpenSettings",(()=>{const{device:e}=this.environment;z.FRk(this.environment),e.isMobile?Q.Z.setState({open:!0}):(Y.Z.setState({...Y.Z.state,open:!1}),J.ZP.setState({...J.ZP.state,currentTab:"notifications"}),J.ZP.setState({...J.ZP.state,open:!0}))})),l()(this,"handleArchiveAll",(()=>{const e=L.Z.state.currentTab;(0,L.g)(e)&&q.rG(this.environment,e)})),l()(this,"setCurrentTabAsRead",(()=>{q.go(this.environment)}))}willMount(){const e=X.Z.get(de.lastUpdatesTabKey);e&&this.tabs.includes(e)&&this.setTabState(e)}renderComponent(){const{device:e}=this.environment;return r()(b.Z,{renderTooltip:()=>r()(F._H,{defaultMessage:"Updates for all pages in this space",id:"updatesButton.tooltip"}),originGap:6,placement:h.ug.Right,render:t=>r()(p.Z,{popupType:e.isMobile?p.Z.PopupType.SlideUp:p.Z.PopupType.Popup,alignmentToOrigin:h.v2.Start,placementToOrigin:h.ug.Right,onClick:this.handleClick,originGap:0,style:{...!e.isMobile&&{width:500,overflow:"hidden"}},isWideTabletWidth:!0,render:this.renderSpaceUpdates,onClose:this.handleDismiss,isFullWidthOnMobile:!0,preventScaleTransition:!0,buttonPopupStore:Y.Z,renderOrigin:e=>this.renderButton(t,e)})})}renderButton(e,t){const i=this.props.format,o=$.Z.getUnreadCountForCurrentSpace(),s=o.mentions>0||o.following>0,a=Y.Z.state.open,l=o.mentions;return i===D.MobileBottomBarPhone?c().createElement(ie.Z,n()({style:de.mobileBottomBarPhoneButtonStyle,mobileFeedback:!0},t),r()("div",{style:{position:"relative"}},void 0,v.Z.mobileBottomBarUpdates({width:26,fill:this.theme.regularTextColor}),r()(W.Z,{color:W.Z.Color.Red,count:l,style:{position:"absolute",top:-3,right:l<99?-5:-8}}))):i===D.MobileBottomBarTablet?c().createElement(ie.Z,n()({style:de.mobileBottomBarTabletButtonStyle,mobileFeedback:!0},t),r()("div",{style:{position:"relative"}},void 0,v.Z.mobileBottomBarUpdates({width:26,fill:this.theme.regularTextColor}),r()(W.Z,{color:W.Z.Color.Red,count:l,style:{position:"absolute",top:-3,right:l<99?-5:-8}}))):i===D.TopbarMobile?c().createElement(ie.Z,n()({style:{...de.actionButtonStyle,marginLeft:2,marginRight:2},mobileFeedback:!0},t),v.Z.mobileBottomBarUpdates({width:26}),r()(W.Z,{color:W.Z.Color.Red,count:l,style:{position:"absolute",top:8,right:0}})):i===D.SidebarMobile?c().createElement(ie.Z,n()({style:de.actionButtonStyle,mobileFeedback:!0},t),v.Z.mobileBottomBarUpdates({width:26}),r()(W.Z,{color:W.Z.Color.Red,count:l,style:{position:"absolute",top:8,right:0}})):i===D.Sidebar?c().createElement(ie.Z,n()({style:{...s&&{fontWeight:y.Z.fontWeight.medium,color:this.theme.regularTextColor}}},(0,g.Z)(e,t)),r()(m.Z,{isMobile:!1,left:r()("div",{style:{color:s?this.theme.regularTextColor:"inherit"}},void 0,v.Z.typesCreatedAt({fill:s?this.theme.regularIconColor:this.theme.mediumIconColor,width:14})),right:r()(W.Z,{color:W.Z.Color.Red,count:l,style:{marginBottom:2,marginLeft:6}}),style:{background:a?this.theme.buttonHoveredBackground:"none"}},void 0,r()(F._H,{defaultMessage:"All Updates",id:"updatesButton.allUpdates.sidebarButton"}))):void 0}renderHeader(){const{device:e}=this.environment,{currentTab:t}=L.Z.state,i=this.tabs.indexOf(t),o=$.Z.getUnreadCountForCurrentSpace(),n={mentions:r()("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:o.mentions>0?y.Z.fontWeight.medium:void 0},className:oe.I2},void 0,r()("div",{},void 0,r()(F._H,{defaultMessage:"Inbox",id:"updatesModal.mentionsTab.title"})),r()(W.Z,{color:W.Z.Color.Red,count:o.mentions,style:{marginLeft:6},numberStyle:{marginBottom:e.isMobile?0:2}})),following:r()("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:o.following>0?y.Z.fontWeight.medium:void 0}},void 0,r()("div",{},void 0,r()(F._H,{defaultMessage:"Following",id:"updatesModal.followedUpdatesTab.title"})),r()(W.Z,{color:W.Z.Color.Gray,count:o.following,style:{marginLeft:6},numberStyle:{marginBottom:e.isMobile?0:2}})),allPages:r()("div",{className:oe.gj},void 0,r()(F._H,{defaultMessage:"All",id:"updatesModal.allUpdatesTab.title"})),archive:r()("div",{className:oe.HK},void 0,r()(F._H,{defaultMessage:"Archived",id:"updatesModal.archiveTab.title"})),currentPage:e.isMobile&&r()("div",{},void 0,r()(F._H,{defaultMessage:"This page",id:"updatesModal.mobileThisPage.title"}))},s=this.tabs.map((e=>n[e]));return r()(d.Fragment,{},void 0,r()(j.Z,{tabs:s,selectedIndex:i,onChange:this.handleTabClick,separatorIndexes:[this.tabs.indexOf("archive")-1],right:!e.isMobile&&this.renderNotificationSettingsButton()}))}renderNotificationSettingsButton(){return r()(b.Z,{renderTooltip:()=>r()(F._H,{defaultMessage:"Open notifications settings",id:"updatesModal.openNotifications.tooltip"}),render:e=>c().createElement(te.Z,n()({icon:v.Z.sidebarSettings,onClick:this.handleOpenSettings},e))})}renderContent(){const e=L.Z.state.currentTab;if("following"===e)return r()(U,{type:"following",empty:this.renderEmptyState(r()(F._H,{defaultMessage:"Turn on “Follow this page” in the Updates menu on any page to receive updates here.",id:"updatesModal.followedUpdatesTab.allArchived"}),r()(F._H,{defaultMessage:"No new updates",id:"updatesModal.followedUpdatesTab.allArchivedTitle"})),analyticsContext:"click_followed_pages"},"following");if("allPages"===e){const{currentSpaceStore:e}=x.Z.state;return e?r()(N.Z,{spaceId:e.id,empty:()=>this.renderEmptyState(r()(F._H,{defaultMessage:"Updates on pages in your workspace will appear here.",id:"updatesModal.allPagesTab.emptyPrompt"}),r()(F._H,{defaultMessage:"No new updates",id:"updatesModal.allPagesTab.emptyPromptTitle"})),source:"all_updates",analyticsContext:"click_all_updates",isTopbarUpdatesMenu:!1},"all-pages"):null}if("mentions"===e)return r()(U,{type:"mentions",empty:this.renderEmptyState((0,re.uT)(this.environment)?r()(F._H,{defaultMessage:"When someone @mentions you, replies to your comments, sends you a request, or invites you to a page, you’ll be notified here.",id:"updatesModal.spaceUpdatesTab.allArchivedRequests"}):r()(F._H,{defaultMessage:"When someone @mentions you, replies to your comments, or invites you to a page, you’ll be notified here.",id:"updatesModal.spaceUpdatesTab.allArchived"}),r()(F._H,{defaultMessage:"You're all caught up",id:"updatesModal.spaceUpdatesTab.allArchivedTitle"})),analyticsContext:"click_comments_and_mentions"},"mentions");if("archive"===e)return r()(U,{type:"archive",empty:this.renderEmptyState(r()(F._H,{defaultMessage:"Any Inbox updates you archived will show up here.",id:"updatesModal.archiveTab.emptyPrompt"}),r()(F._H,{defaultMessage:"No archived updates",id:"updatesModal.archiveTab.emptyPromptTitle"})),analyticsContext:"click_followed_pages"},"archive");if("currentPage"===e){const{currentSpaceStore:e,currentBlockStore:t}=x.Z.state;if(!e||!t)return null;const i=t.getValue();let o;if(i&&G.YG(i)){const e=(0,G.kW)(i);e&&(o=e.id)}return r()(N.Z,{navigableBlockId:t.id,collectionId:o,spaceId:e.id,empty:()=>this.renderEmptyState(r()(F._H,{defaultMessage:"Any changes to this page will show up here.",id:"updatesModal.currentPageTab.emptyPrompt"}),r()(F._H,{defaultMessage:"No page updates",id:"updatesModal.currentPageTab.emptyPromptTitle"})),analyticsContext:"click_all_updates",isTopbarUpdatesMenu:!0,source:"notifications"},"current-page")}(0,ae.t1)(e)}renderEmptyState(e,t){const{device:i}=this.environment;return r()("div",{style:{textAlign:"center",paddingLeft:20,paddingRight:20,paddingTop:i.isMobile?64:void 0,height:i.isMobile?void 0:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",overflow:"hidden",minHeight:i.isMobile?void 0:220}},void 0,r()("div",{style:{paddingBottom:12}},void 0,v.Z.inbox({width:48,fill:this.theme.lightIconColor})),r()("div",{style:{fontSize:14,fontWeight:500,color:this.theme.mediumTextColor,maxWidth:380}},void 0,t),r()("div",{style:{fontSize:14,color:this.theme.mediumTextColor,marginTop:2,marginBottom:4,maxWidth:380}},void 0,e))}renderFooter(){const{currentTab:e,isCurrentTabEmpty:t}=L.Z.state;if("mentions"!==e)return;if(t)return;const{device:i}=this.environment;return r()("div",{style:this.getInboxActionsStyle()},void 0,r()(ne.Z,{onClick:this.handleArchiveAll,style:this.getArchiveButtonStyle(),mobileFeedback:i.isMobile},void 0,v.Z.archive({width:i.isMobile?16:14,fill:"inherit",marginLeft:i.isMobile?6:0,marginRight:i.isMobile?8:6}),r()(F._H,{defaultMessage:"Archive all",id:"updatesModal.spaceUpdatesTab.archiveAllButtonTitle"})))}setTabState(e){X.Z.get(de.lastUpdatesTabKey)!==e&&X.Z.set(de.lastUpdatesTabKey,e),L.Z.state.currentTab!==e&&L.Z.setState({...L.Z.state,currentTab:e})}handleTrackTab(){let e;switch(L.Z.state.currentTab){case"mentions":e="mentions_comments";break;case"following":e="followed_pages";break;default:e="all_updates"}z.tmQ(this.environment,{tab:e}),z.nBz(this.environment,{itemName:"updates"})}changeTab(e){this.setCurrentTabAsRead(),this.setTabState(e),this.handleTrackTab()}get tabs(){return this.environment.device.isMobile?["mentions","following","allPages","currentPage","archive"]:["mentions","following","allPages","archive"]}getInboxActionsStyle(){const{device:e}=this.environment;return{display:"flex",alignItems:e.isMobile?"flex-start":"center",background:e.isMobile?this.theme.contentBackground:this.theme.sidebarBackground,boxShadow:"0 -1px 0 ".concat(this.theme.regularDividerColor),marginTop:1,position:e.isMobile?"relative":"sticky",left:0,right:0,bottom:0}}getArchiveButtonStyle(){const{device:e}=this.environment;return{paddingLeft:e.isMobile?0:14,paddingRight:e.isMobile?8:12,marginRight:"auto",width:"100%",color:e.isMobile?this.theme.blueColor:this.theme.mediumTextColor,fill:e.isMobile?this.theme.blueColor:this.theme.mediumTextColor,height:e.isMobile?44:36,borderRadius:0,fontSize:e.isMobile?16:12,fontWeight:e.isMobile?500:400,justifyContent:e.isMobile?"center":void 0}}}l()(de,"Format",D),l()(de,"lastUpdatesTabKey","LastUpdatesTab"),l()(de,"actionButtonStyle",{display:"flex",alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0,height:"100%",minWidth:34,position:"relative"}),l()(de,"mobileBottomBarPhoneButtonStyle",{display:"flex",alignItems:"center",justifyContent:"center",flex:1}),l()(de,"mobileBottomBarTabletButtonStyle",{display:"flex",alignItems:"center",justifyContent:"center",width:62,flex:"none"});const ce=de},2768:(e,t,i)=>{i.r(t),i.d(t,{default:()=>re});var o=i(98135),n=i.n(o),s=i(59713),r=i.n(s),a=(i(33948),i(58879)),l=i(96486),d=i.n(l),c=i(67294),h=i.n(c);function p(e,t){const i=(0,c.useRef)(Math.random().toString(36).substr(2,9)),o=t,n=(0,c.useRef)();return(0,c.useEffect)((()=>{if(n&&n.current&&d().isEqual(n.current,o))return;const t=i.current;e&&(e({type:"mount",id:t,props:o}),n.current=o)}),[e,o]),e?i.current:void 0}var u=i(66832),m=i(5366),g=(i(85827),i(74487)),b=i(36054);function y(e,t,i){const{content:o,apiRequestValue:n}=i;return{id:e,content:o,action:{type:t,apiRequestValue:n}}}const v=["insertBlock","turnInto","textColor","textSelectionColor"],S=["textFormatting"];function f(e,t){return{type:e,apiRequestValue:t}}function M(e,t){const i={type:e,data:t};return JSON.stringify(i)}const k={showActionBarMenu:g.Ry({required:{type:g.i0("showActionBarMenu"),data:g.Ry({required:{actionBarMenuId:g.eR("textColor","insertBlock","turnInto","template")},optional:{}})},optional:{}}),blockAction:g.Ry({required:{type:g.eR("blockAction"),data:g.Ry({required:{action:g.eR("bold","italic","underline","strikethrough","link","code","equation","mention","trash","comment","filePicker","indent","unindent","moveUp","moveDown","undo","redo","dismissKeyboard","more")},optional:{}})},optional:{}})},T=Object.keys(k);let Z;!function(e){e[e.InvalidActionType=0]="InvalidActionType",e[e.MissingPayload=1]="MissingPayload",e[e.InvalidRequestType=2]="InvalidRequestType",e[e.InvalidData=3]="InvalidData"}(Z||(Z={}));class w{constructor(e,t){this.type=e,this.message=t}}function C(e){return 0===e.reduce(((e,t)=>e+t.items.length),0)}function I(e){const{disableBlockActions:t,disableCommentAction:i,disableMentionAction:o,selectedMenuType:n,disableInsertBlockAction:s,disableTurnIntoAction:r,disableTextFormatting:a,disableDeleteBlock:l,accessibilityTexts:d}=e;return{id:"mab.buttonSection.main",buttons:[y("mab.button.insert","nativeAction_setMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"plus",localImageIdentifier:"insertBlock"},accessibilityText:d.insert,disabled:t||s,selected:"insertBlock"===n},apiRequestValue:{menuType:"insertBlock"}}),y("mab.button.turnInto","nativeAction_setMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.2.squarepath",localImageIdentifier:"turnInto"},disabled:t||r,selected:"turnInto"===n,accessibilityText:d.turnInto},apiRequestValue:{menuType:"turnInto"}}),y("mab.button.filePicker","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"photo.on.rectangle.angled",localImageIdentifier:"filePicker"},disabled:t,accessibilityText:d.filePicker},apiRequestValue:{jsonPayload:M("blockAction",{action:"filePicker"})}}),y("mab.button.mention","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"at",localImageIdentifier:"mention"},disabled:o,accessibilityText:d.mention},apiRequestValue:{jsonPayload:M("blockAction",{action:"mention"})}}),y("mab.button.comment","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"bubble.left",localImageIdentifier:"comment"},disabled:i,accessibilityText:d.comment},apiRequestValue:{jsonPayload:M("blockAction",{action:"comment"})}}),y("bold.italic.underline","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"bold.italic.underline",localImageIdentifier:"boldItalicUnderline"},disabled:a,accessibilityText:d.textFormatting},apiRequestValue:{subMenuType:"textFormatting"}}),y("mab.button.delete","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"trash",localImageIdentifier:"trash"},disabled:l,accessibilityText:d.trash},apiRequestValue:{jsonPayload:M("blockAction",{action:"trash"})}})]}}function P(e){return[y("mab.button.moveUp","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.up.to.line.alt",localImageIdentifier:"moveUp"},accessibilityText:e.accessibilityTexts.moveUp,disabled:e.disableBlockActions},apiRequestValue:{jsonPayload:M("blockAction",{action:"moveUp"})}}),y("mab.button.moveDown","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.down.to.line.alt",localImageIdentifier:"moveDown"},accessibilityText:e.accessibilityTexts.moveDown,disabled:e.disableBlockActions},apiRequestValue:{jsonPayload:M("blockAction",{action:"moveDown"})}})]}function x(e){const{id:t,disableBlockActions:i,disableIndent:o,disableUnindent:n,shouldFadeIn:s,includeUpAndDown:r,accessibilityTexts:a}=e;if(!(i||o&&n)){var l={id:t,shouldFadeIn:s,buttons:[y("mab.button.indent","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"decrease.indent",localImageIdentifier:"unindent"},accessibilityText:a.dedent,disabled:i||n},apiRequestValue:{jsonPayload:M("blockAction",{action:"unindent"})}}),y("mab.button.unindent","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"increase.indent",localImageIdentifier:"indent"},accessibilityText:a.indent,disabled:i||o},apiRequestValue:{jsonPayload:M("blockAction",{action:"indent"})}})]};if(r){var d=P({disableBlockActions:i,accessibilityTexts:{moveUp:a.moveUp,moveDown:a.moveDown}});l.buttons=l.buttons.concat(d)}return l}}function B(e){const{disableUndo:t,disableRedo:i,disableTextActions:o,disableTextColorAction:n,textColorImageReference:s,selectedMenuType:r,accessibilityTexts:a}=e;return{id:"mab.buttonSection.block",buttons:[y("mab.button.undo","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.uturn.backward",localImageIdentifier:"undo"},accessibilityText:a.undo,disabled:t},apiRequestValue:{jsonPayload:M("blockAction",{action:"undo"})}}),y("mab.button.redo","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.uturn.forward",localImageIdentifier:"redo"},accessibilityText:a.redo,disabled:i},apiRequestValue:{jsonPayload:M("blockAction",{action:"redo"})}}),y("mab.button.textColor.native","nativeAction_setMenuType",{content:{type:"icon",imageReference:s,disabled:o||n,selected:"textColor"===r,accessibilityText:a.blockColor},apiRequestValue:{menuType:"textColor"}}),y("mab.button.more","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"ellipsis",localImageIdentifier:"more"},accessibilityText:a.more},apiRequestValue:{jsonPayload:M("blockAction",{action:"more"})}})]}}var A=i(67074),R=i(27724);function _(e){const{disableTextActions:t,boldSelected:i,italicSelected:o,underlineSelected:n,strikeSelected:s,codeSelected:r,linkSelected:a,equationSelected:l,selectedMenuType:d,disableTextColorAction:c,disableCommentAction:h,disableLinkAction:p,disableEquationAction:u,textColorImageReference:m,accessibilityTexts:g}=e;return{id:"mab.buttonSection.textFormatting",shouldFadeIn:!0,buttons:[y("mab.button.back","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"chevron.backward.2",localImageIdentifier:"back"},accessibilityText:g.close},apiRequestValue:{subMenuType:null}}),y("mab.button.bold","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"bold",localImageIdentifier:"bold"},accessibilityText:g.bold,disabled:t,selected:i},apiRequestValue:{jsonPayload:M("blockAction",{action:"bold"})}}),y("mab.button.italic","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"italic",localImageIdentifier:"italic"},disabled:t,selected:o,accessibilityText:g.italics},apiRequestValue:{jsonPayload:M("blockAction",{action:"italic"})}}),y("mab.button.underline","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"underline",localImageIdentifier:"underline"},disabled:t,selected:n,accessibilityText:g.underline},apiRequestValue:{jsonPayload:M("blockAction",{action:"underline"})}}),y("mab.button.strikethrough","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"strikethrough",localImageIdentifier:"strikethrough"},disabled:t,selected:s,accessibilityText:g.strikethrough},apiRequestValue:{jsonPayload:M("blockAction",{action:"strikethrough"})}}),y("mab.button.textFormatting.textSelectionColor.native","nativeAction_setMenuType",{content:{type:"icon",imageReference:m,disabled:t||c,selected:"textSelectionColor"===d,accessibilityText:g.textColor},apiRequestValue:{menuType:"textSelectionColor"}}),y("mab.button.textFormatting.comment","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"bubble.left",localImageIdentifier:"comment"},disabled:t||h,accessibilityText:g.comment},apiRequestValue:{jsonPayload:M("blockAction",{action:"comment"})}}),y("mab.button.link","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"link",localImageIdentifier:"link"},accessibilityText:g.link,disabled:t||p,selected:a},apiRequestValue:{jsonPayload:M("blockAction",{action:"link"})}}),y("mab.button.code","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"chevron.left.slash.chevron.right",localImageIdentifier:"code"},accessibilityText:g.code,disabled:t,selected:r},apiRequestValue:{jsonPayload:M("blockAction",{action:"code"})}}),y("mab.button.equation","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"x.squareroot",localImageIdentifier:"equation"},accessibilityText:g.equation,disabled:t||u,selected:l},apiRequestValue:{jsonPayload:M("blockAction",{action:"equation"})}}),y("mab.button.cancel","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"xmark.circle.fill",localImageIdentifier:"cancel",imageTintColor:"#72706B64"},accessibilityText:g.close},apiRequestValue:{subMenuType:null}})]}}var L=i(17215),F=i(44886),H=i(60165),E=i(89086),O=i(70203),U=i(24677),D=i(98104),N=i(8848),W=i(7313),V=i(33929),q=i(95477),z=i(68204),G=i(47853),j=i(25666);function K(e){const{type:t,actionSections:i,closeParentMenu:o,context:n}=e,s={},r=[];for(const a of i){const e={id:"".concat(a.key),title:a.title,items:a.actions.map((e=>{const i="".concat(e.key,"-").concat(e.displayName||""),r=e.nativeRender&&e.nativeRender(n),a=null!=r&&r.thumbnail?(0,G.D)(null==r?void 0:r.thumbnail):j.T;return s[i]={...e,thumbnail:a,closeParentMenu:o},{id:i,title:e.displayName||"",icon:{...r,remoteImageUrl:a?"".concat(q.Z.domainBaseUrl).concat(a):void 0,localAssetBundleImagePath:a},action:f("webAction_genericAction",{menuType:t,actionId:i}),checked:!1}}))};r.push(e)}return{actions:s,sections:r}}function Y(e){const{key:t,displayName:i,thumbnail:o,analyticsName:n,closeParentMenu:s,action:r}=e,a=i?V.Z.formatMessage(i):void 0,l=i,d=l?"".concat(V.Z.formatMessage(l)," ").concat(l.defaultMessage):void 0;return{key:"action ".concat(t),displayName:a,thumbnail:o,analyticsName:n||"textformatting_action_".concat(t),searchName:d,validators:[],action:r,closeParentMenu:Boolean(s)}}const Q={bold:Y({key:"bold",closeParentMenu:!1,action:({environment:e})=>{A.pk(e,["b"])}}),italic:Y({key:"italic",closeParentMenu:!1,action:({environment:e})=>{A.pk(e,["i"])}}),underline:Y({key:"underline",closeParentMenu:!1,action:({environment:e})=>{A.pk(e,["_"])}}),strikethrough:Y({key:"strikethrough",closeParentMenu:!1,action:({environment:e})=>{A.pk(e,["s"])}}),code:Y({key:"code",closeParentMenu:!1,action:({environment:e})=>{A.pk(e,["c"])}}),comment:Y({key:"comment",closeParentMenu:!0,action:async({environment:e})=>{var t;await(null===(t=e.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),A.ol(e,!0)}}),equation:Y({key:"equation",closeParentMenu:!0,action:async({environment:e})=>{var t;await(null===(t=e.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),A._W(e)}}),filePicker:Y({key:"filePicker",closeParentMenu:!0,action:async({environment:e})=>{var t;await(null===(t=e.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),A.vs(e)}}),indent:Y({key:"indent",closeParentMenu:!1,action:({environment:e})=>{A.O2(e)}}),unindent:Y({key:"unindent",closeParentMenu:!1,action:({environment:e})=>{A.$$(e)}}),moveDown:Y({key:"moveDown",closeParentMenu:!1,action:({environment:e})=>{A.rZ(e)}}),moveUp:Y({key:"moveUp",closeParentMenu:!1,action:({environment:e})=>{A.s0(e)}}),undo:Y({key:"undo",closeParentMenu:!1,action:({environment:e})=>{A.i2(e)}}),redo:Y({key:"redo",closeParentMenu:!1,action:({environment:e})=>{A.GH(e)}}),trash:Y({key:"trash",closeParentMenu:!1,action:({environment:e})=>{A.fn(e)}}),mention:Y({key:"mention",closeParentMenu:!0,action:async({environment:e})=>{var t;await(null===(t=e.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),A.Z3(e)}}),link:Y({key:"link",closeParentMenu:!0,action:async({environment:e})=>{var t;await(null===(t=e.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),A.UF(e)}}),more:Y({key:"more",closeParentMenu:!1,action:({environment:e})=>{A.w1(e,void 0,void 0)}}),dismissKeyboard:Y({key:"dismissKeyboard",closeParentMenu:!0,action:({environment:e})=>{}})};var X=i(27832),J=i(24666),$=i(68056),ee=i(45162),te=i(71802);const ie=(0,m.vU)({templatesButtonTitle:{defaultMessage:"Choose a template...",id:"mobileActionBar.templateButtonTitle"},actionMenuInsertBlockTitle:{defaultMessage:"Insert Block",id:"mobileActionBar.actionMenuTitle.insertBlock"},actionMenuTurnIntoTitle:{defaultMessage:"Turn Into",id:"mobileActionBar.actionMenuTitle.turnInto"},actionMenuColorTitle:{defaultMessage:"Color",id:"mobileActionBar.actionMenuTitle.blockColor"},accessibilityInsert:{defaultMessage:"Add block",id:"mobileActionBar.accessibility.insertBlock",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityTurnInto:{defaultMessage:"Turn into block",id:"mobileActionBar.accessibility.turnInto",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityFilePicker:{defaultMessage:"Add image",id:"mobileActionBar.accessibility.filePicker",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityMention:{defaultMessage:"Add mention",id:"mobileActionBar.accessibility.mention",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityBlockColor:{defaultMessage:"Change block color",id:"mobileActionBar.accessibility.blockColor",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityTextFormatting:{defaultMessage:"Open text formatting menu",id:"mobileActionBar.accessibility.textFormatting",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityComment:{defaultMessage:"Add comment",id:"mobileActionBar.accessibility.comment",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityTrash:{defaultMessage:"Delete block",id:"mobileActionBar.accessibility.trash",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityIndent:{defaultMessage:"Indent block",id:"mobileActionBar.accessibility.indent",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityDedent:{defaultMessage:"Unindent block",id:"mobileActionBar.accessibility.unindent",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityMoveUp:{defaultMessage:"Move a block up",id:"mobileActionBar.accessibility.moveUp",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityMoveDown:{defaultMessage:"Move a block down",id:"mobileActionBar.accessibility.moveDown",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityUndo:{defaultMessage:"Undo edit",id:"mobileActionBar.accessibility.udno",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityRedo:{defaultMessage:"Redo edit",id:"mobileActionBar.accessibility.redo",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityMore:{defaultMessage:"More block actions",id:"mobileActionBar.accessibility.more",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityBold:{defaultMessage:"Bold",id:"mobileActionBar.accessibility.bold",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityItalics:{defaultMessage:"Italicize",id:"mobileActionBar.accessibility.italics",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityUnderline:{defaultMessage:"Underline",id:"mobileActionBar.accessibility.underline",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityStrikethrough:{defaultMessage:"Strikethrough",id:"mobileActionBar.accessibility.strikethrough",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityTextColor:{defaultMessage:"Text color",id:"mobileActionBar.accessibility.textColor",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityCode:{defaultMessage:"Code",id:"mobileActionBar.accessibility.code",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityLink:{defaultMessage:"Add link",id:"mobileActionBar.accessibility.link",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityEquation:{defaultMessage:"Add equation",id:"mobileActionBar.accessibility.equation",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityCloseTextFormattingMenu:{defaultMessage:"Close text formatting menu",id:"mobileActionBar.accessibility.close",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityDismissKeyboard:{defaultMessage:"End editing",id:"mobileActionBar.accessibility.endEditing",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityCloseActionMenu:{defaultMessage:"Close menu",id:"mobileActionBar.accessibility.closeMenu",description:"Accessibility text, this will be read aloud by the screen reader"}}),oe={text:!1,to_do:!0,bulleted_list:!0,numbered_list:!0,toggle:!0,column:!1,transclusion_container:!1,callout:!1,quote:!1};function ne(e){var t;const{onAction:i,fallbackRenderer:o,...n}=e,s=p(null===(t=(0,a.O7)().mobileNative)||void 0===t?void 0:t.api.renderMobileActionBar,n);return function(e,t,i,o){var n;const s=null===(n=(0,a.O7)().mobileNative)||void 0===n?void 0:n.componentEvents;(0,c.useEffect)((()=>{if(s&&o&&t)return s.addListener(e,t,i,o)}),[e,t,i,o,s])}("MobileActionBar",s,"onAction",i),!s&&o?h().createElement(h().Fragment,null,o()):null}class se extends u.Z{constructor(...e){super(...e),r()(this,"handleTextSelectionCompositeStoreChanged",(()=>{if(!this.textSelectionCompositeStore.state)return;const{source:e}=this.textSelectionCompositeStore.state,{NativeMobileActionBarStore:t,device:i}=this.environment;"TextSelectionStore"!==e||null===(null==t?void 0:t.state.menuType)||i.isTablet||this.setCurrentMenuType(null,!0)})),r()(this,"handleTextSelectionStoreChanged",(()=>{if(!this.textSelectionPositionsStore.state)return;const{NativeMobileActionBarStore:e}=this.environment;e&&null===e.state.subMenuType&&e.state.isSubMenuOverridden&&this.setCurrentSubMenuType(null,!1)})),r()(this,"getCurrentActionBarSchema",this.createComputedStore((()=>{const{NativeMobileActionBarStore:e}=this.environment,t=Boolean(this.renderStore.state.disableAnnotation),i=e?e.state.menuType:null;var o=null;const n=A.Tz({environment:this.environment,store:this.props.currentBlockStore}),s=!!e&&e.state.isSubMenuOverridden,r=this.shouldShowTextActions.state,a=e?e.state.subMenuType:null;s?o=a:r&&!t&&(o="textFormatting",null==e||e.update((e=>({...e,isSubMenuOverridden:!1,subMenuType:null}))));const l="editing"===J.Z.state.mode&&J.Z.state.multiSelection,d=this.props.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState,c=d&&"editing"===d.mode&&d.multiSelection,h=l||c,p=Boolean(h&&(0,$.qS)(h)),u=!this.canTriggerTextActions.state,m=!this.canTriggerBlockActions.state,g=this.props.currentBlockStore.getValue(),b=this.commentActionDisabled(g)||Boolean(this.renderStore.state.disableComment),v=this.mentionActionDisabled(g),S=R.Z.state.stores,f=!S.every(F.nt),k=!S.every(F.gq),T=!H.L0(),Z=!H.AZ(),w=(0,te.JE)(),L=this.memoizedNativeMenus({environment:this.environment,blocks:R.Z.state.stores}),E=C(L.textColor.sections);var O,U,D;if(n)O=[(D=V.Z.formatMessage(ie.templatesButtonTitle),{id:"mab.buttonSection.template",buttons:[y("mab.button.choose_template","webAction_generic",{content:{type:"text_and_icon",imageReference:{localImageIdentifier:"template"},text:D},apiRequestValue:{jsonPayload:M("showActionBarMenu",{actionBarMenuId:"template"})}})]})];else{var N;const e={main:I({disableBlockActions:m,disableCommentAction:b,disableMentionAction:v,selectedMenuType:i,disableInsertBlockAction:C(L.insertBlock.sections),disableTurnIntoAction:C(L.turnInto.sections),disableTextFormatting:t,disableDeleteBlock:w,accessibilityTexts:{insert:V.Z.formatMessage(ie.accessibilityInsert),turnInto:V.Z.formatMessage(ie.accessibilityTurnInto),filePicker:V.Z.formatMessage(ie.accessibilityFilePicker),mention:V.Z.formatMessage(ie.accessibilityMention),comment:V.Z.formatMessage(ie.accessibilityComment),textFormatting:V.Z.formatMessage(ie.accessibilityTextFormatting),trash:V.Z.formatMessage(ie.accessibilityTrash)}}),listPrioritized:x({id:"mab.list.prioritized",disableBlockActions:m,disableIndent:f,disableUnindent:k,shouldFadeIn:!1,includeUpAndDown:!1,accessibilityTexts:{indent:V.Z.formatMessage(ie.accessibilityIndent),dedent:V.Z.formatMessage(ie.accessibilityDedent),moveUp:V.Z.formatMessage(ie.accessibilityMoveUp),moveDown:V.Z.formatMessage(ie.accessibilityMoveDown)}}),listDeprioritized:x({id:"mab.list.deprioritized",disableBlockActions:m,disableIndent:f,disableUnindent:k,shouldFadeIn:!0,includeUpAndDown:!0,accessibilityTexts:{indent:V.Z.formatMessage(ie.accessibilityIndent),dedent:V.Z.formatMessage(ie.accessibilityDedent),moveUp:V.Z.formatMessage(ie.accessibilityMoveUp),moveDown:V.Z.formatMessage(ie.accessibilityMoveDown)}}),block:B({disableUndo:T,disableRedo:Z,textColorImageReference:this.textColorImageReference(),disableTextActions:u,disableTextColorAction:E,selectedMenuType:i,accessibilityTexts:{undo:V.Z.formatMessage(ie.accessibilityUndo),redo:V.Z.formatMessage(ie.accessibilityRedo),blockColor:V.Z.formatMessage(ie.accessibilityBlockColor),more:V.Z.formatMessage(ie.accessibilityMore)}}),moveUpAndDown:(U={disableBlockActions:m,accessibilityTexts:{moveUp:V.Z.formatMessage(ie.accessibilityMoveUp),moveDown:V.Z.formatMessage(ie.accessibilityMoveDown)}},{id:"mab.buttonSection.last",shouldFadeIn:!0,buttons:P(U)})},o=h&&(null===(N=(0,ee.tp)({multiSelection:h,focus:void 0,filterCommonAncestors:!1}))||void 0===N?void 0:N.stores),n=o&&o.some((e=>{const t=e.getType();return t&&oe[t]}));O=e.listPrioritized&&n?[e.listPrioritized,e.main,e.block,e.moveUpAndDown]:e.listDeprioritized&&o&&o.every((e=>F.nt(e)||F.gq(e)))?[e.main,e.block,e.listDeprioritized]:w?[e.main,e.block]:[e.main,e.block,e.moveUpAndDown]}const W=[_({disableTextActions:u,disableCommentAction:b,disableLinkAction:!p,disableEquationAction:!p,selectedMenuType:i,disableTextColorAction:E,textColorImageReference:this.textSelectionColorImageReference(),accessibilityTexts:{bold:V.Z.formatMessage(ie.accessibilityBold),italics:V.Z.formatMessage(ie.accessibilityItalics),underline:V.Z.formatMessage(ie.accessibilityUnderline),strikethrough:V.Z.formatMessage(ie.accessibilityStrikethrough),textColor:V.Z.formatMessage(ie.accessibilityTextColor),comment:V.Z.formatMessage(ie.accessibilityComment),code:V.Z.formatMessage(ie.accessibilityCode),link:V.Z.formatMessage(ie.accessibilityLink),equation:V.Z.formatMessage(ie.accessibilityEquation),close:V.Z.formatMessage(ie.accessibilityCloseTextFormattingMenu)},...this.getTextFormattingSelections()})];return function(e){const{selectedMenu:t,selectedSubMenu:i,nativeMenus:o,buttonSections:n,nativeSubMenus:s,accessibilityTexts:r}=e;return{nativeMenus:o,nativeSubMenus:s,state:{buttonSections:n,selectedMenu:t,selectedSubMenu:i,dismissKeyboardButton:null!==t?y("mab.dismissKeyboard","nativeAction_setMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"xmark.circle.fill",localImageIdentifier:"cancel",imageTintColor:"#72706B64"},accessibilityText:r.closeActionMenu},apiRequestValue:{menuType:null}}):y("mab.dismissKeyboard","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"keyboard.chevron.compact.down",localImageIdentifier:"keyboardDown"},accessibilityText:r.dismissKeyboard},apiRequestValue:{jsonPayload:M("blockAction",{action:"dismissKeyboard"})}}),mutatedNativeMenus:{},localizedMessages:{}}}}({selectedMenu:i,selectedSubMenu:o,nativeMenus:{textColor:{id:"textColor",title:V.Z.formatMessage(ie.actionMenuColorTitle),sections:L.textColor.sections},textSelectionColor:{id:"textSelectionColor",title:V.Z.formatMessage(ie.actionMenuColorTitle),sections:L.textSelectionColor.sections},insertBlock:{id:"insertBlock",title:V.Z.formatMessage(ie.actionMenuInsertBlockTitle),sections:L.insertBlock.sections},turnInto:{id:"turnInto",title:V.Z.formatMessage(ie.actionMenuTurnIntoTitle),sections:L.turnInto.sections}},nativeSubMenus:{textFormatting:W},buttonSections:O,accessibilityTexts:{dismissKeyboard:V.Z.formatMessage(ie.accessibilityDismissKeyboard),closeActionMenu:V.Z.formatMessage(ie.accessibilityCloseActionMenu)}})}))),r()(this,"textSelectionPositionsStore",this.createComputedStore((()=>{const e=this.textSelectionCompositeStore.state;if(!e)return;const{source:t,...i}=e;return i}),!0)),r()(this,"textSelectionCompositeStore",this.createComputedStore((()=>{const e=(e,t)=>{if(!e||"editing"!==e.mode)return;const{multiSelection:i}=e;return{startRecord:i.start.store.pointer,startIndex:i.start.index,endRecord:i.end.store.pointer,endIndex:i.end.index,source:t}};return e(J.Z.state,"TextSelectionStore")||e(this.props.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState,"IgnoreSelectionAreaStore")}),!0)),r()(this,"renderStore",this.createComputedStore((()=>{var e;const t=A.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state);if(!t){const e=this.environment.NativeMobileActionBarStore;null!==(null==e?void 0:e.state.menuType)&&d().delay((()=>{var e;A.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state)||this.setCurrentMenuType(null,!1)}),500),null!==(null==e?void 0:e.state.subMenuType)&&d().delay((()=>{var e;A.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state)||this.setCurrentSubMenuType(null,!1)}),500)}return t}))),r()(this,"shouldShowTextActions",this.createComputedStore((()=>A.oQ(this.props.stores.ignoreSelectionAreaStore)))),r()(this,"canTriggerBlockActions",this.createComputedStore((()=>A.Bo(this.pageContext&&this.pageContext.publicEditModeStore.state)))),r()(this,"canTriggerTextActions",this.createComputedStore((()=>A.eQ(this.pageContext&&this.pageContext.publicEditModeStore.state,this.props.currentBlockStore)))),r()(this,"memoizedNativeMenus",d().memoize((e=>{const{blocks:t,environment:i}=e;return o={environment:i,blocks:t},{insertBlock:K({type:"insertBlock",actionSections:z.L1(W.kR,o),context:o,closeParentMenu:!0}),turnInto:K({type:"turnInto",actionSections:z.L1([W.gH],o),context:o,closeParentMenu:!0}),textColor:K({type:"textColor",actionSections:z.L1([W.rz,W.Vm],o),context:o,closeParentMenu:!1}),textSelectionColor:K({type:"textSelectionColor",actionSections:z.L1([W.b4,W.Sw],o),context:o,closeParentMenu:!1})};var o})))}didMount(){this.textSelectionCompositeStore.addListener(this.handleTextSelectionCompositeStoreChanged),this.textSelectionPositionsStore.addListener(this.handleTextSelectionStoreChanged)}willUnmount(){this.textSelectionCompositeStore.removeListener(this.handleTextSelectionCompositeStoreChanged),this.textSelectionPositionsStore.removeListener(this.handleTextSelectionStoreChanged),this.props.renderApi&&this.props.renderApi({type:"unmount",id:""})}renderComponent(){return n()(ne,{isOpen:this.renderStore.state.shouldShow,canShow:this.renderStore.state.canShowNativeBar,schema:this.getCurrentActionBarSchema.state,onAction:e=>{const{action:t}=e;switch(t.type){case"nativeAction_hideKeyboard":break;case"nativeAction_setMenuType":this.handleSetMenuTypeAction(t);break;case"nativeAction_setSubMenuType":this.handleSetSubMenuTypeAction(t);break;case"webAction_generic":this.handleGenericWebAction(t);break;case"webAction_genericAction":this.handleActionRegistryAction(t)}},fallbackRenderer:this.props.fallbackRenderer})}commentActionDisabled(e){return!(!e||!(0,L._T)(e))}mentionActionDisabled(e){return!(!e||!(0,L.lQ)(e))}handleSetMenuTypeAction(e){const t=function(e){if("nativeAction_setMenuType"!==e.type)return new w(Z.InvalidActionType,void 0);const t=e.apiRequestValue;if(!t||!("menuType"in t))return new w(Z.MissingPayload,void 0);const i=g.Ry({required:{menuType:g.eR(...v,null)},optional:{}}),o=(0,b.Gu)(i,t);return o?new w(Z.InvalidRequestType,JSON.stringify(o)):t.menuType}(e);if(t instanceof w)return void console.error(JSON.stringify(t));if((this.environment.NativeMobileActionBarStore?this.environment.NativeMobileActionBarStore.state.menuType:null)===t)this.setCurrentMenuType(null,!0);else switch(this.setCurrentMenuType(t,!0),t){case"insertBlock":A.Oh(this.environment,"insert");break;case"turnInto":A.Oh(this.environment,"turn_into");break;case"textColor":case"textSelectionColor":A.Oh(this.environment,"color")}}handleSetSubMenuTypeAction(e){const t=function(e){if("nativeAction_setSubMenuType"!==e.type)return new w(Z.InvalidActionType,void 0);const t=e.apiRequestValue;if(!t||!("subMenuType"in t))return new w(Z.MissingPayload,void 0);const i=g.Ry({required:{subMenuType:g.eR(...S,null)},optional:{}}),o=(0,b.Gu)(i,t);return o?new w(Z.InvalidRequestType,JSON.stringify(o)):t.subMenuType}(e);t instanceof w?console.error(JSON.stringify(t)):this.setCurrentSubMenuType(t,!0)}handleGenericWebAction(e){const t=function(e){if("webAction_generic"!==e.type)return new w(Z.InvalidActionType,void 0);const t=e.apiRequestValue;if(!t||!("jsonPayload"in t))return new w(Z.MissingPayload,void 0);const i=JSON.parse(t.jsonPayload),o=g.Ry({required:{type:g.eR(...T)},optional:{}}),n=(0,b.Gu)(o,i);if(n)return new w(Z.InvalidRequestType,JSON.stringify(n));const s=i,r=k[s.type],a=(0,b.Gu)(r,s);return a?new w(Z.InvalidData,JSON.stringify(a)):s}(e);if(t instanceof w)console.error(JSON.stringify(t));else switch(t.type){case"blockAction":if("dismissKeyboard"===t.data.action){this.handleDismissKeyboard();break}const e=Q[t.data.action];if(!e)break;const i=e.action;if(i){const{currentBlockStore:t}=X.Z.state;if(!t)break;const{device:o}=this.environment;e.closeParentMenu&&!o.isTablet&&this.setCurrentMenuType(null,!0),i({environment:this.environment,blocks:[t]})}break;case"showActionBarMenu":switch(t.data.actionBarMenuId){case"insertBlock":this.handleInsert();break;case"textColor":this.handleTextColor();break;case"turnInto":this.handleTurnInto();break;case"template":this.handleTemplate()}}}handleActionRegistryAction(e){var t,i;const o=null===(t=e.apiRequestValue)||void 0===t?void 0:t.menuType,n=null===(i=e.apiRequestValue)||void 0===i?void 0:i.actionId;if(!o||!n)return;const s=this.memoizedNativeMenus({environment:this.environment,blocks:R.Z.state.stores})[o].actions[n];if(!s)return;const r=s.action;r&&(s.closeParentMenu&&this.setCurrentMenuType(null,!0),r({environment:this.environment,blocks:R.Z.state.stores}))}handleDismissKeyboard(){U.ZH(this.environment),this.props.stores.store.update((e=>({...e,isInsertOpen:!1}))),this.setCurrentMenuType(null,!1),this.setCurrentSubMenuType(null,!1),A.Oh(this.environment,"hide_keyboard"),D.sD()}getTextFormattingSelections(){return{boldSelected:Boolean((0,E.Ld)(O.GK.Bold)),italicSelected:Boolean((0,E.Ld)(O.GK.Italic)),underlineSelected:Boolean((0,E.Ld)(O.GK.Underline)),strikeSelected:Boolean((0,E.Ld)(O.GK.Strike)),codeSelected:Boolean((0,E.Ld)(O.GK.Code)),linkSelected:Boolean((0,E.Ld)(O.GK.Link)),equationSelected:Boolean((0,E.Ld)(O.GK.Equation))}}imageReferenceForBlockColor(e){let t="textColor";const i=Object.keys(this.theme.blockColors).find((t=>t===e));let o;"default"===e||i&&(i.includes("background")?(o="background",t="textBackgroundColor"):o="color");const n=o&&i?this.theme.blockColors[i][o]:void 0;return{localImageIdentifier:t,imageTintColor:n?(0,N.J1)(n):void 0}}textSelectionColorImageReference(){const{NativeMobileActionBarStore:e}=this.environment,t=e&&null!==e.state.menuType?this.props.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState:void 0,i=(0,E.a6)("h",t||J.Z.state),o=i?(0,O.zI)(i):void 0;return this.imageReferenceForBlockColor(o)}textColorImageReference(){const e=R.Z.state.stores.length>0?R.Z.state.stores[0].getFormat().block_color:void 0;return this.imageReferenceForBlockColor(e)}handleInsert(){this.props.stores.store.update((e=>({...e,isInsertOpen:!0}))),A.Oh(this.environment,"insert")}handleTurnInto(){this.props.stores.store.update((e=>({...e,isTurnIntoOpen:!0}))),A.Oh(this.environment,"turn_into")}handleTemplate(){this.props.stores.store.update((e=>({...e,isTemplatesOpen:!0}))),A.Oh(this.environment,"templates")}handleTextColor(){this.props.stores.store.update((e=>({...e,isColorOpen:!0}))),A.Oh(this.environment,"color")}setCurrentMenuType(e,t){var i;null===(i=this.environment.NativeMobileActionBarStore)||void 0===i||i.update((i=>({...i,menuType:e,shouldRestoreSelectionForMenu:t})))}setCurrentSubMenuType(e,t){const{NativeMobileActionBarStore:i}=this.environment;null==i||i.update((i=>({...i,isSubMenuOverridden:t,subMenuType:e})))}}const re=(0,m.XN)(se)},72653:(e,t,i)=>{i.d(t,{Z:()=>a});var o=i(59488),n=i(49164),s=i(69454),r=i(55320);const a=new n.Z((()=>{const{phase:e}=s.Z.state;if(r.Z.state.open)return!0;return(0,o.de)()||e===s.i.hidden||e===s.i.willHide}))}}]);