(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};((e,t,n)=>{const a=React;var s=n.n(a);const r=ReactDOM;var i=n.n(r);new class{getItem(e){return new URL(location.href).searchParams.get(e)}setItem(e,t){const n=new URL(location.href);n.searchParams.set(e,t),history.replaceState(null,"",n.toString())}removeItem(e){const t=new URL(location.href);t.searchParams.delete(e),history.replaceState(null,"",t.toString())}clear(){const e=new URL(location.href),t=Array.from(e.searchParams.keys());for(const n of t)e.searchParams.delete(n);history.replaceState(null,"",e.toString())}key(e){const t=new URL(location.href);return Array.from(t.searchParams.keys())[e]??null}get length(){const e=new URL(location.href);return Array.from(e.searchParams.keys()).length}};let o=0;const l=(e,t)=>"appearance"===e||"text-stroke"===e||"user-select"===e?((e,t)=>{for(const n of["","-webkit-","-moz-"]){const a=`${n}${e}`;if(CSS.supports(a,t))return[a,t]}return[e,t]})(e,t):"fit-content"===t?((e,t)=>{for(const n of["","-webkit-","-moz-"]){const a=`${n}${t}`;if(CSS.supports(e,a))return[e,a]}return[e,t]})(e,t):[e,t];class c{constructor(e){this.style=e,this.entries=[];for(const[e,t]of Object.entries(this.style))this.entries.push(this.createEntry(e,t));this.classes={};for(const e of this.entries)""!==e.className&&(this.classes[e.styleKey]=e.className);this.text=this.entries.map((e=>e.styleText)).join("\n"),this.node=document.createElement("style"),this.node.textContent=this.text}createEntry(e,t){let n,a;"@global"===e?(n="",a=""):(o+=1,n=`jss-${o}-${e}`,a=`.${n}`);const s=[];this.createRuleItem(a,t,s);const r=[];for(const[e,t]of s)Object.keys(t).length>0&&r.push(this.createRuleText(e,t));return{styleKey:e,styleValue:t,styleText:r.join("\n"),className:n}}createRuleItem(e,t,n){const a=e,s={};n.push([a,s]);for(const[e,r]of Object.entries(t))if("object"!=typeof r||Array.isArray(r))s[e]=r;else{const t=e.replace(/&/g,a);this.createRuleItem(t,r,n)}}createRuleText(e,t){const n=[`${e} {`];for(let[e,a]of Object.entries(t))e=e.replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`)),Array.isArray(a)&&(a=a.join(", ")),[e,a]=l(e,String(a)),n.push(`    ${e}: ${a};`);return n.push("}"),n.join("\n")}attach(){return this.node.isConnected||document.head.appendChild(this.node),this}remove(){this.node.isConnected&&this.node.remove()}toString(){return this.text}}const p=CSS.supports("-moz-appearance","none"),d=CSS.supports("-webkit-appearance","-apple-pay-button"),h=void 0!==navigator.standalone,u=e=>new c(e),m=p,g=d,f=h;function y({name:e,size:t,className:n}){n=["material-icons-outlined",n].join(" ").trim();const a={fontSize:t=`${t}px`,width:t,height:t};return s().createElement("i",{className:n,style:a},e)}const{classes:b}=u({ul:{margin:0,padding:"0 8px",borderBottom:"1px solid #ccc"},li:{display:"inline-block",marginBottom:"-1px"},label:{background:"#fff",borderBottom:"1px solid #ccc",borderLeft:"1px solid #fff",borderRight:"1px solid #fff",borderTop:"1px solid #fff",cursor:"default",fontSize:"14px",lineHeight:"16px",padding:"6px 12px",userSelect:"none"},value:{borderBottom:"1px solid #fff",borderLeft:"1px solid #ccc",borderRight:"1px solid #ccc",borderTop:"1px solid #333"},icon:{float:"left",marginRight:"6px"}}).attach(),{classes:x}=u({ul:{margin:0,padding:"0 8px",borderTop:"1px solid #ccc"},li:{display:"inline-block",marginTop:"-1px"},label:{background:"#fff",borderBottom:"1px solid #fff",borderLeft:"1px solid #fff",borderRight:"1px solid #fff",borderTop:"1px solid #ccc",cursor:"default",fontSize:"14px",lineHeight:"16px",padding:"6px 12px",userSelect:"none"},value:{borderBottom:"1px solid #333",borderLeft:"1px solid #ccc",borderRight:"1px solid #ccc",borderTop:"1px solid #fff"},icon:{float:"left",marginRight:"6px"}}).attach(),{classes:v}=u({ul:{margin:0,padding:"8px 0",width:"max-content",borderRight:"1px solid #ccc"},li:{display:"block",marginRight:"-1px"},label:{background:"#fff",borderBottom:"1px solid #fff",borderLeft:"1px solid #fff",borderRight:"1px solid #ccc",borderTop:"1px solid #fff",cursor:"default",fontSize:"14px",lineHeight:"16px",padding:"6px 12px",textAlign:"right",userSelect:"none"},value:{borderBottom:"1px solid #ccc",borderLeft:"1px solid #333",borderRight:"1px solid #fff",borderTop:"1px solid #ccc"},icon:{float:"left",marginRight:"6px"}}).attach(),C={bottom:x,left:v,top:b};class E extends s().PureComponent{handleOnClick=e=>()=>{this.props.onChange&&this.props.onChange(e.value)};getClasses(){return C[this.props.position??"top"]}renderChild=(e,t)=>{const n=this.getClasses();let a=n.label;return e.value===this.props.value&&(a=`${a} ${n.value}`),s().createElement("li",{className:n.li,key:t},s().createElement("div",{className:a,onClick:this.handleOnClick(e)},e.icon&&s().createElement(y,{className:n.icon,name:e.icon,size:"16"}),s().createElement("span",null,e.label)))};renderChildren=()=>this.props.schema.items.map(this.renderChild);render(){const e=this.getClasses();let t=this.props.className;return t=[e.ul,t].join(" ").trim(),s().createElement("ul",{className:t},this.renderChildren())}}const{classes:k}=u({root:{position:"absolute",top:"8px",right:"8px",fontSize:"14px",lineHeight:"30px"}}).attach();class w extends s().PureComponent{renderLink(e,t){return s().createElement("a",{href:e,rel:"noreferrer",target:"_blank"},t)}renderLinkSettings(){const e=this.props.i18ns.popup;return s().createElement("a",{href:"",onClick:e=>{e.preventDefault(),this.props.agent.settings()}},e.settings)}render(){const e=this.props.i18ns.popup;return s().createElement("div",{className:k.root},this.renderLink("https://www.dualsub.xyz/quickstart.html",e.tutorial),s().createElement("span",null," "),this.renderLinkSettings())}}const{classes:N}=u({root:(S={boxSizing:"border-box",fontSize:"14px",height:"28px",padding:"2px 4px"},m?(S.border="1px solid #8f8f9d",S.borderRadius="2px",S.backgroundColor="#fff",S):g?(f?(S.borderRadius="5px",S.border="1px solid -apple-system-secondary-label",S.color="#000",S.backgroundColor="#fff"):S.border="1px solid #c0c0c0",S):S)}).attach();var S;class O extends s().PureComponent{handleOnChange=e=>{const t=e.target,n=parseInt(t.value),a=this.props.schema.items[n].value;this.props.onChange&&this.props.onChange(a)};renderChild=(e,t)=>{const{label:n,title:a}=e;return s().createElement("option",{key:t,value:t,title:a},n)};renderChildren=()=>{const{items:e,groups:t}=this.props.schema;if(void 0===t||0===t.length)return e.map(this.renderChild);let n=0;const a=[];for(const[r,i]of t.entries()){const{label:t,count:o}=i,l=o>0?n+o:e.length,c=[];for(;n<l;)c.push(this.renderChild(e[n],n)),n+=1;""===t?a.push(s().createElement(s().Fragment,{key:r},c)):a.push(s().createElement("optgroup",{key:r,label:t},c))}return a};render(){let e=this.props.className;e=[N.root,e].join(" ").trim();const t=this.props.style,{schema:n,value:a}=this.props;let r=n.items.findIndex((e=>e.value===a)),i=null;-1===r?r=0:i=n.items[r].title;const o=this.props.disabled;return s().createElement("select",{className:e,style:t,value:r,disabled:o,title:i,onChange:this.handleOnChange},this.renderChildren())}}class T extends s().PureComponent{onChange=e=>t=>{const n={...this.props.value};n[e]=t,this.props.onChange(n,e)};renderSelectFile(){const e=this.props.i18n,{value:t,schema:n}=this.props,a={items:[{label:`${e.close} (${n.files.length})`,value:""},...n.files]},r=t.file;return s().createElement(O,{schema:a,value:r,onChange:this.onChange("file")})}renderSelectTranslate(){const e=this.props.i18n,{value:t,schema:n}=this.props,a={items:[{label:`${e.close} (${n.translates.length})`,value:""},...n.translates]},r=t.translate;return s().createElement(O,{schema:a,value:r,onChange:this.onChange("translate")})}renderSelectLegend(){const e=this.props.i18n,{value:t,schema:n}=this.props,a={items:[{label:`${e.close} (${n.legends.length})`,value:""},...n.legends]},r=t.legend;return s().createElement(O,{schema:a,value:r,onChange:this.onChange("legend")})}render(){return s().createElement(s().Fragment,null,this.renderSelectFile(),this.renderSelectTranslate(),this.renderSelectLegend())}}const{classes:j}=u({root:{display:"grid",gridAutoFlow:"row",gridColumnGap:"4px",gridRowGap:"4px","& > label":{fontSize:"14px",fontWeight:"bold",lineHeight:"20px",padding:"0 2px",whiteSpace:"nowrap"}},index:{fontSize:"14px",fontWeight:"bold",lineHeight:"28px",padding:"0 2px"},hideTranslate:{"& > *:nth-child(4n+3)":{display:"none"}},hideLegend:{"& > *:nth-child(4n+4)":{display:"none"}}}).attach();class L extends s().PureComponent{onChange=e=>(t,n)=>{const a=[...this.props.value];a[e]=t,this.props.onChange(a,[String(e),n])};render(){const e=[j.root],t=["min-content","minmax(0, 1fr)","minmax(0, 1fr)","minmax(0, 1fr)"];this.props.hideTranslate&&(e.push(j.hideTranslate),t.pop()),this.props.hideLegend&&(e.push(j.hideLegend),t.pop());const n=e.join(" "),a={gridTemplateColumns:t.join(" ")},r=this.props.i18n,i=this.props.schema,o=this.props.value.map(((e,t)=>s().createElement(s().Fragment,{key:t},s().createElement("span",{className:j.index},t+1),s().createElement(T,{i18n:r,schema:i,value:e,onChange:this.onChange(t)}))));return s().createElement("div",{className:n,style:a},s().createElement("label",null),s().createElement("label",null,r.subtitleLanguage),s().createElement("label",null,r.machineTranslation),s().createElement("label",null,r.themeStyle),o)}}const{classes:A}=u({notice:{fontSize:"14px",padding:"8px",border:"1px solid #ccc",borderLeftWidth:"4px",borderRadius:"4px",lineHeight:"20px","& .title":{fontWeight:"bold"}}}).attach();class R extends s().PureComponent{constructor(e){super(e),this.state={context:null}}componentDidMount(){this.load()}async load(){const e=await this.props.agent.initial();this.setState({context:e})}onChange=(e,t)=>{const n={menus:e},a={data:{schema:this.state.context.data.schema,value:n}};this.setState({context:a}),this.props.agent.change(n)};renderNoticeNodata(){const e=this.props.i18ns.popup;return s().createElement("div",{className:A.notice},s().createElement("div",{className:"title"},e.nodataTitle),s().createElement("div",null,s().createElement("div",null,e.nodataLine0Tip),s().createElement("div",null,e.nodataLine1ModeStandard),s().createElement("div",null,e.nodataLine2Loading),s().createElement("div",null,e.nodataLine3Permission)))}render(){if(null===this.state.context)return null;const e=this.state.context.data;if(!e)return this.renderNoticeNodata();const t=this.props.i18ns.popup;return s().createElement(L,{i18n:t,schema:e.schema.menus,value:e.value.menus,onChange:this.onChange,hideTranslate:!1,hideLegend:!1})}}const{classes:z}=u({notice:{fontSize:"14px",padding:"8px",border:"1px solid #ccc",borderLeftWidth:"4px",borderRadius:"4px",lineHeight:"20px","& .title":{fontWeight:"bold"}}}).attach();class q extends s().PureComponent{constructor(e){super(e),this.state={context:null}}componentDidMount(){this.load()}async load(){const e=await this.props.agent.initial();this.setState({context:e})}onChange=(e,t)=>{const n={menus:e},a={data:{schema:this.state.context.data.schema,value:n}};this.setState({context:a}),this.props.agent.change(n)};renderNoticeNodata(){const e=this.props.i18ns.popup;return s().createElement("div",{className:z.notice},s().createElement("div",{className:"title"},e.nodataTitle),s().createElement("div",null,s().createElement("div",null,e.nodataLine0Tip),s().createElement("div",null,e.nodataLine1ModeSimple),s().createElement("div",null,e.nodataLine2Loading),s().createElement("div",null,e.nodataLine3Permission)))}render(){if(null===this.state.context)return null;const e=this.state.context.data;if(!e)return this.renderNoticeNodata();const t=this.props.i18ns.popup;return s().createElement(L,{i18n:t,schema:e.schema.menus,value:e.value.menus,onChange:this.onChange,hideTranslate:!1,hideLegend:!0})}}const M=(e,t)=>{const n=e.type;if("string"===n||"number"===n||"boolean"===n)return typeof t===n;if("null"===n)return null===t;if("array"===n)return Array.isArray(t);if("object"===n)return"object"==typeof t&&null!==t&&!Array.isArray(t);throw`invalid schema type: ${n}`},P=(e,t)=>{const n=e.type;if("string"===n||"number"===n||"boolean"===n){e=e,void 0!==t&&void 0!==e.enum&&(e.enum.includes(t)||(t=void 0));let a=!1;if(void 0!==t&&(a=M(e,t)),a||void 0!==(t=e.default)&&(a=M(e,t)),"string"===n)return a?t:"";if("number"===n)return a?t:0;if("boolean"===n)return!!a&&t}if("null"===n)return null;if("array"===n)return[];if("object"===n)return{};throw`invalid schema type: ${n}`},$=(e,t)=>{const n=e.type;if("string"===n||"number"===n||"boolean"===n)return P(e)===t;if("null"===n)return!0;if("array"===n)return 0===t.length;if("object"===n)return 0===Object.keys(t).length;throw`invalid schema type: ${n}`};function H(e,t,n){const a=t.type;if("string"===a||"number"===a||"boolean"===a)return P(t,n);if("null"===a)return null;if("array"===a){if(void 0===(t=t).items)return[];M(t,n)||(n=[]);const a=t.items,s=[];for(const t of n)s.push(H(e,a,t));return s}if("object"===a){if(void 0===(t=t).properties)return{};M(t,n)||(n={});const a=t.properties,s=t.required??[],r={};for(const[t,i]of Object.entries(a)){const a=n[t];if("expand"!==e)if("shrink"!==e){if("inject"!==e)throw`invalid mode: ${e}`;{const n=void 0!==a,o=s.includes(t);if(n||o){const n=H(e,i,a);r[t]=n}}}else{const n=H(e,i,a);$(i,n)||(r[t]=n)}else{const n=H(e,i,a);r[t]=n}}return r}throw`invalid schema type: ${a}`}const G=(e,t)=>H("inject",e,t);function F(e,t){t=t??new WeakMap;const n=typeof e;if("string"===n||"number"===n||"boolean"===n||"function"===n||null===e)return e;if("object"!==n)throw`invalid type: ${n}`;if(t.has(e))throw"circular reference";if(Array.isArray(e)){t.set(e,!0);const n=e.map((e=>F(e,t)));return t.delete(e),n}t.set(e,!0);const a={};for(const[n,s]of Object.entries(e))a[n]=F(s,t);return t.delete(e),a}function D(e){const t=typeof e;if("string"===t||"number"===t||"boolean"===t||"function"===t||null===e)return e;if("object"!==t)throw`invalid type: ${t}`;return Array.isArray(e)?e.slice():Object.assign({},e)}function B(e){const t=typeof e;if("string"===t||"number"===t||"boolean"===t)return{type:t,default:e};if(null===e)return{type:"null"};if(Array.isArray(e))return{type:typeof e[0],default:e[0],enum:e};if("object"!==t)throw`invalid value type: ${t}`;const n=e,a=n.type;if("string"!==a&&"number"!==a&&"boolean"!==a&&"null"!==a){if("array"!==a){if("object"===a){const e=n.properties??{};for(const[t,n]of Object.entries(e)){const a=B(n);void 0!==a&&(e[t]=a)}return!0===n.required&&(n.required=Object.keys(e)),void(!1===n.required&&(n.required=[]))}throw`invalid schema type: ${a}`}{const e=B(n.items);void 0!==e&&(n.items=e)}}}const{classes:I}=u({root:{display:"inline-block"},wrap:{alignItems:"center",display:"flex"},label:{fontSize:"14px",lineHeight:"1em"},input:(e=>m?(e.height="16px",e):e)({fontSize:"14px",lineHeight:"16px",width:"100%",margin:"0 4px 0 0",padding:"4px","&:last-child":{marginRight:0}})}).attach();class _ extends s().PureComponent{handleOnChange=e=>{const t=e.target;let n;n="number"===this.props.schema.type?parseInt(t.value):t.value,this.props.onChange&&this.props.onChange(n)};render(){let e=this.props.className;e=[I.root,e].join(" ").trim();const t=this.props.style,n=this.props.schema,a=this.props.value,r=this.props.disabled;return s().createElement("span",{className:e,style:t},s().createElement("span",{className:I.wrap},s().createElement("input",{className:I.input,type:n.type,placeholder:n.placeholder,spellCheck:n.spellcheck,title:n.tooltip,value:a,disabled:r,onChange:this.handleOnChange}),n.label&&s().createElement("span",{className:I.label},n.label)))}}const{classes:U}=u({root:{},textarea:{padding:"4px",fontSize:"14px",lineHeight:"18px"}}).attach();class V extends s().PureComponent{handleOnChange=e=>{const t=e.target.value;this.props.onChange&&this.props.onChange(t)};render(){let e=this.props.className;e=[U.root,e].join(" ").trim();const t=this.props.style,{schema:n,value:a}=this.props;return s().createElement("div",{className:e,style:t},s().createElement("textarea",{className:U.textarea,rows:n.rows,cols:n.cols,placeholder:n.placeholder,spellCheck:n.spellcheck,value:a,onChange:this.handleOnChange}))}}const{classes:W}=u({root:{boxSizing:"border-box",display:"inline-block",fontSize:"14px",height:"28px",padding:"6px 4px",whiteSpace:"nowrap"},label:{display:"inline-block",verticalAlign:"middle",lineHeight:"1em"},input:{display:"inline-block",verticalAlign:"middle",width:"16px",height:"16px",margin:"0 4px 0 0","&:last-child":{marginRight:0}}}).attach();class J extends s().PureComponent{hanldeOnChange=e=>{const t=e.target.checked;this.props.onChange&&this.props.onChange(t)};render(){let e=this.props.className;e=[W.root,e].join(" ").trim();const t=this.props.style,n=this.props.schema,a=!0===this.props.value;return s().createElement("label",{className:e,style:t},s().createElement("input",{className:W.input,type:"checkbox",checked:a,onChange:this.hanldeOnChange}),n.label&&s().createElement("span",{className:W.label},n.label))}}const{classes:K}=u({root:{display:"inline-block"},label:{display:"inline-block",fontFamily:"var(--font-mono)",fontSize:"12px",lineHeight:"1em"},input:(e=>m?(e.border="1px solid #8f8f9d",e.borderRadius="2px",e):e)({boxSizing:"border-box",height:"28px",margin:"0 4px 0 0",verticalAlign:"middle",width:"28px"})}).attach();class Y extends s().PureComponent{handleChange=e=>{const t=e.target.value;this.props.onChange&&this.props.onChange(t)};render(){let e=this.props.className;e=[K.root,e].join(" ").trim();const t=this.props.style,n=this.props.value;return s().createElement("span",{className:e,style:t},s().createElement("input",{className:K.input,type:"color",value:n,onChange:this.handleChange}),s().createElement("span",{className:K.label},n))}}const{classes:Q}=u({root:(e=>g?(f?(e.height="28px",e.border="1px solid -apple-system-secondary-label",e.borderRadius="5px",e.color="#000"):(e.appearance="square-button",e.height="28px"),e):e)({margin:0,padding:0}),label:{fontSize:"14px",lineHeight:"16px",padding:"4px",userSelect:"none"},icon:{marginRight:"4px",verticalAlign:"top","&:last-child":{marginRight:0}}}).attach();class Z extends s().PureComponent{handleOnClick=()=>{const e=this.props.value;this.props.onClick&&this.props.onClick(e)};renderChildren(){const{label:e,icon:t}=this.props;return s().createElement("div",{className:Q.label},t&&s().createElement(y,{className:Q.icon,name:t,size:"16"}),e&&s().createElement("span",null,e))}render(){let e=this.props.className;e=[Q.root,e].join(" ").trim();const t=this.props.disabled;return s().createElement("button",{className:e,disabled:t,onClick:this.handleOnClick},this.renderChildren())}}const{classes:X}=u({root:{border:"1px solid #ccc",width:"max-content",display:"flex",flexDirection:"column"},ul:{margin:0,padding:0,overflow:"auto"},li:{display:"block"},label:{background:"#fff",cursor:"default",fontSize:"14px",lineHeight:"16px",padding:"6px 12px",textAlign:"left",userSelect:"none",display:"flex","& > span":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}},value:{color:"#fff",background:"#0075ff"},icon:{float:"left",marginRight:"12px"},toolbar:{borderBottom:"1px solid #ccc",padding:"4px",textAlign:"right"},button:{marginRight:"4px","&:last-child":{marginRight:0}}}).attach();class ee extends s().PureComponent{handleItemOnClick=e=>()=>{this.props.onChange&&this.props.onChange(e.value)};handleButtonOnClick=e=>()=>{this.props.onClick&&this.props.onClick(e)};renderChild=(e,t)=>{let n=X.label;return e.value===this.props.value&&(n=`${n} ${X.value}`),s().createElement("li",{className:X.li,key:t},s().createElement("div",{className:n,onClick:this.handleItemOnClick(e)},e.icon&&s().createElement(y,{className:X.icon,name:e.icon,size:"16"}),s().createElement("span",null,e.label)))};renderChildren=()=>{const e=this.props.schema.items;if(0!==e.length)return s().createElement("ul",{className:X.ul},e.map(this.renderChild))};renderToolbar=()=>{const e=this.props.schema.actions??[];if(0!==e.length)return s().createElement("div",{className:X.toolbar},e.includes("add")&&s().createElement(Z,{className:X.button,icon:"add",value:"add",onClick:this.handleButtonOnClick("add")}),e.includes("remove")&&s().createElement(Z,{className:X.button,icon:"remove",value:"remove",onClick:this.handleButtonOnClick("remove")}),e.includes("up")&&s().createElement(Z,{className:X.button,icon:"arrow_upward",value:"up",onClick:this.handleButtonOnClick("up")}),e.includes("down")&&s().createElement(Z,{className:X.button,icon:"arrow_downward",value:"down",onClick:this.handleButtonOnClick("down")}))};render(){let e=this.props.className;e=[X.root,e].join(" ").trim();const t=this.props.style;return s().createElement("div",{className:e,style:t},this.renderToolbar(),this.renderChildren())}}const{classes:te}=u({panel:{padding:"8px"},panel1:{padding:"8px",borderLeft:"4px solid #8bc34a"},panel2:{padding:"8px",borderLeft:"4px solid #ff9800"},toolbar:{"& > *":{marginRight:"8px","&:last-child":{marginRight:0}}},code:{margin:0,padding:"8px"}}).attach(),ne=e=>{let t=e.className;t=[te.code,t].join(" ").trim();const n=e.style,a=e.value;return s().createElement("pre",{className:t,style:n},a)},ae=(e,t)=>{for(const[n,a]of Object.entries(t)){const t=new RegExp("\\{"+n+"\\}","g");e=e.replace(t,a)}return e},{classes:se}=u({root:{display:"inline-block",position:"relative"},label:{display:"inline-block",fontFamily:"var(--font-mono)",fontSize:"12px",lineHeight:"1em",position:"absolute",top:0},input:{boxSizing:"border-box",height:"28px",margin:"0 4px 0 0",verticalAlign:"middle",width:"100%"}}).attach();class re extends s().PureComponent{handleChange=e=>{const t=e.target,n=parseInt(t.value);this.props.onChange&&this.props.onChange(n)};render(){let e=this.props.className;e=[se.root,e].join(" ").trim();const t=this.props.style,n=this.props.value,a=ae(this.props.label??"{value}",{value:n}),r={[n>50?"left":"right"]:0};return s().createElement("span",{className:e,style:t},s().createElement("input",{className:se.input,type:"range",value:n,onChange:this.handleChange}),s().createElement("span",{className:se.label,style:r},a))}}const ie=(...e)=>e.join(" ").trim(),{classes:oe}=u({root:{fontSize:"14px"},gridLayout:{display:"grid",gridColumnGap:"4px",gridRowGap:"4px",gridTemplateColumns:"repeat(5, max-content)"},gridText:{lineHeight:"28px"},gridEdit:{"& > *":{width:"100%"}},gridDisabled:{opacity:"0.5",pointerEvents:"none"},topLayout:{display:"grid",gridRowGap:"8px",gridTemplateRows:"auto 1fr"},topMenu:{marginBottom:"8px","& > select":{width:"100%"}},topHeader:{borderBottom:"1px solid #ccc",borderTop:"1px solid transparent",lineHeight:"16px",padding:"6px 0",fontWeight:"bold"},leftLayout:{display:"grid",gridColumnGap:"8px",gridTemplateColumns:"auto 1fr"},leftHeader:{borderRight:"1px solid #ccc",lineHeight:"16px",padding:"6px 8px 6px 0",fontWeight:"bold",textAlign:"right"},flatLayout:{display:"grid",gridRowGap:"8px"},flowLayout:{display:"grid",gridAutoFlow:"column",gridColumnGap:"4px",alignItems:"center"},pickLayout:{display:"grid",gridRowGap:"4px",gridColumnGap:"4px",alignItems:"center"},pickChecked:{color:"#000"},pickDeleted:{"& span":{opacity:"0.5"}}}).attach();class le extends s().PureComponent{handleOnChange=e=>t=>{this.props.onChange&&this.props.onChange(e,t)};handleOnActive=e=>t=>{this.props.onActive&&this.props.onActive(e,t)};handleOnPrepare=e=>t=>{this.props.onPrepare&&this.props.onPrepare(e,t)};handleOnRemove=(e,t)=>()=>{this.props.onRemove&&this.props.onRemove(e,t)};handleOnAdd=(e,t)=>n=>{this.props.onAdd&&this.props.onAdd(e,t,n)};handleOnClick=(e,t)=>n=>{const[a,s]=t;"add"===n&&this.props.onAdd?this.props.onAdd(e,a):"remove"===n&&this.props.onRemove?s>=0&&this.props.onRemove(e,s):"up"===n&&this.props.onMoveUp?s>0&&this.props.onMoveUp(e,s):"down"===n&&this.props.onMoveDown&&s<a-1&&this.props.onMoveDown(e,s)};extractEnumMappings=e=>{const t={},n=e.items.properties??{};for(const e of Object.keys(n)){const a=n[e],s=a.widget??{},r=a.enum??[],i=s.enumNames??[],o={};for(const[e,t]of r.entries())o[String(t)]=i[e];t[e]=o}return t};createFormatReplaces=(e,t)=>{const n={...e};for(const[a,s]of Object.entries(e)){const e=t[a];e&&(n[`:${a}`]=e[String(s)])}return n};renderEnumerate(e,t,n){t=G(e,t);const a=e.widget??{},r=a.enumNames??[],i=a.enumTitles??[],o={items:e.enum.map(((e,t)=>({label:r[t]??e,value:e,title:i[t]})))};return s().createElement(O,{className:a.className,style:a.style,schema:o,value:t,onChange:this.handleOnChange(n)})}renderTypeString(e,t,n){t=G(e,t);const a=e.widget??{};if("color"===a.type)return s().createElement(Y,{className:a.className,style:a.style,value:t,onChange:this.handleOnChange(n)});if("text"===a.type){const e={rows:a.rows,cols:a.cols,placeholder:a.placeholder,spellcheck:a.spellcheck};return s().createElement(V,{className:a.className,style:a.style,schema:e,value:t,onChange:this.handleOnChange(n)})}const r={type:"string",placeholder:a.placeholder,spellcheck:a.spellcheck,tooltip:a.tooltip};return s().createElement(_,{className:a.className,style:a.style,schema:r,value:t,onChange:this.handleOnChange(n)})}renderTypeNumber(e,t,n){t=G(e,t);const a=e.widget??{};if("slider"===a.type)return s().createElement(re,{className:a.className,style:a.style,value:t,onChange:this.handleOnChange(n)});const r={type:"number",tooltip:a.tooltip};return s().createElement(_,{className:a.className,style:a.style,schema:r,value:t,onChange:this.handleOnChange(n)})}renderTypeBoolean(e,t,n){t=G(e,t);const a=e.widget??{};return s().createElement(J,{className:a.className,style:a.style,schema:{},value:t,onChange:this.handleOnChange(n)})}renderTypeNull(e,t){t=G(e,t);const n=e.widget??{};return s().createElement(ne,{className:n.className,style:n.style,value:t})}renderTypeObjectTab(e,t,n){t=G(e,t);const a=e.properties??[],r=e.widget??{},i=[];for(const e of Object.keys(a))i.push({value:e,label:a[e].title??e});const o={items:i},l=r.active??i[0].value,c=a[l],p=t[l],d=[...n,l],h=r.position??"top",{topLayout:u,leftLayout:m}=oe;let g="top"===h?u:m;return g=ie(g,r.className),s().createElement("div",{className:g,style:r.style},s().createElement(E,{schema:o,value:l,position:r.position,onChange:this.handleOnActive(n)}),s().createElement("div",null,this.renderSchema(c,p,d)))}renderTypeObjectMenu(e,t,n){t=G(e,t);const a=e.properties??[],r=e.widget??{},i=[];for(const e of Object.keys(a))i.push({value:e,label:a[e].title??e});const o={items:i,groups:r.groups};let l=r.active;l&&void 0===t[l]&&(l=void 0),!l&&r.single&&(l=Object.keys(t)[0]),l||(l=i[0].value);const c=a[l],p=t[l],d=[...n,l],h=r.className;return s().createElement("div",{className:h,style:r.style},s().createElement("div",{className:oe.topMenu},s().createElement(O,{schema:o,value:l,onChange:this.handleOnActive(n)})),s().createElement("div",null,this.renderSchema(c,p,d)))}renderTypeObjectFlat(e,t,n){t=G(e,t);const a=e.properties??[],r=e.widget??{},{topLayout:i,leftLayout:o,topHeader:l,leftHeader:c}=oe,p=r.position??"top",d="top"===p?i:o,h="top"===p?l:c,u=[];for(const e of Object.keys(a)){const r=a[e],i=t[e],o=[...n,e];u.push(s().createElement("div",{className:d,key:e},s().createElement("div",{className:h},r.title??e),s().createElement("div",null,this.renderSchema(r,i,o))))}const m=ie(oe.flatLayout,r.className);return s().createElement("div",{className:m,style:r.style},u)}renderTypeObjectList(e,t,n){t=G(e,t);const a=e.properties??[],r=e.widget??{},i=[];for(const e of Object.keys(a))i.push({value:e,label:a[e].title??e,icon:r.icon});const o={items:i},l=r.active??i[0].value,c=a[l],p=t[l],d=[...n,l],h=ie(oe.leftLayout,r.className);return s().createElement("div",{className:h,style:r.style},s().createElement(ee,{style:{width:"100%"},schema:o,value:l,onChange:this.handleOnActive(n)}),s().createElement("div",null,this.renderSchema(c,p,d)))}renderTypeObjectFlow(e,t,n){t=G(e,t);const a=e.properties??[],r=e.widget??{},i=e.required??[],o=[];for(const[e,l]of i.entries()){const c=a[l],p=t[l],d=[...n,l],h=r.separator&&e+1<i.length;o.push(s().createElement(s().Fragment,{key:l},s().createElement("span",{className:oe.gridEdit},this.renderSchema(c,p,d)),h&&s().createElement("span",null,r.separator)))}const l=ie(oe.flowLayout,r.className);return s().createElement("div",{className:l,style:r.style},o)}renderTypeObjectGridInline(e,t,n){t=G(e,t);const a=e.properties??[],r=e.required??[],i=e.widget??{},o=[];for(const e of Object.keys(a)){const l=a[e],c=t[e],p=[...n,e],d=l.widget??{},h=r.includes(e);let u=l.title??e;i.title&&(u=ae(i.title,{title:l.title,key:e}));let m=oe.gridText,g=oe.gridEdit,f=oe.gridText,y=oe.gridText;h||void 0!==c||(m=ie(oe.gridDisabled,m),g=ie(oe.gridDisabled,g),f=ie(oe.gridDisabled,f),y=ie(oe.gridDisabled,y));let b=null;h||(b=void 0===c?s().createElement(Z,{icon:"add",onClick:this.handleOnAdd(n,e)}):s().createElement(Z,{icon:"remove",onClick:this.handleOnRemove(n,e)})),o.push(s().createElement(s().Fragment,{key:e},s().createElement("span",{className:m},u),s().createElement("span",{className:f},d.prefix),s().createElement("span",{className:g},this.renderSchema(l,c,p)),s().createElement("span",{className:y},d.suffix),s().createElement("span",null,b)))}const l=ie(oe.gridLayout,i.className);return s().createElement("div",{className:l,style:i.style},o)}renderTypeObjectGridNewline(e,t,n){t=G(e,t);const a=e.properties??[],r=e.required??[],i=e.widget??{},o={};for(const e of Object.keys(a))o[e]=r.includes(e);for(const e of Object.keys(t))a[e]&&(o[e]=!0);const l=[],c=[];for(const[e,t]of Object.entries(o))t?l.push(e):c.push(e);const p=[];for(const e of l){const o=a[e],l=t[e],c=[...n,e],d=o.widget??{},h=r.includes(e);let u=o.title??e;i.title&&(u=ae(i.title,{title:o.title,key:e})),p.push(s().createElement(s().Fragment,{key:e},s().createElement("span",{className:oe.gridText},u),s().createElement("span",{className:oe.gridText},d.prefix),s().createElement("span",{className:oe.gridEdit},this.renderSchema(o,l,c)),s().createElement("span",{className:oe.gridText},d.suffix),s().createElement("span",null,h??s().createElement(Z,{icon:"remove",onClick:this.handleOnRemove(n,e)}))))}if(c.length>0){const e=c.map((e=>({label:a[e].title??e,value:e}))),t=i.prepare??c[0],r=s().createElement(O,{schema:{items:e},value:t,onChange:this.handleOnPrepare(n)});p.push(s().createElement(s().Fragment,{key:"+"},s().createElement("span",{className:oe.gridEdit},r),s().createElement("span",null),s().createElement("span",null,s().createElement(Z,{icon:"add",onClick:this.handleOnAdd(n,t)}))))}const d=ie(oe.gridLayout,i.className);return s().createElement("div",{className:d,style:i.style},p)}renderTypeObject(e,t,n){const a=e.widget??{};return"tab"===a.type?this.renderTypeObjectTab(e,t,n):"menu"===a.type?this.renderTypeObjectMenu(e,t,n):"flat"===a.type?this.renderTypeObjectFlat(e,t,n):"list"===a.type?this.renderTypeObjectList(e,t,n):"flow"===a.type?this.renderTypeObjectFlow(e,t,n):"inline"===a.mode?this.renderTypeObjectGridInline(e,t,n):this.renderTypeObjectGridNewline(e,t,n)}renderTypeArrayList(e,t,n){t=G(e,t);const a=e.widget??{},r=[];for(const[e,n]of t.entries()){let s=a.label;"function"==typeof s&&(s=s(n,e,t));let i=a.icon;"function"==typeof i&&(i=i(n,e,t)),r.push({value:e,label:s,icon:i})}const i={items:r,actions:["add","remove","up","down"]};let o=a.active??0;o=o>=t.length?t.length-1:o;const l=e.items,c=t[o],p=[...n,o],d=-1!==o&&o<t.length,h=ie(oe.leftLayout,a.className);return s().createElement("div",{className:h,style:a.style},s().createElement(ee,{style:{width:"100%"},schema:i,value:o,onChange:this.handleOnActive(n),onClick:this.handleOnClick(n,[t.length,o])}),s().createElement("div",null,d&&this.renderSchema(l,c,p)))}renderTypeArrayPick(e,t,n){t=G(e,t);const a=e.widget??{},r={gridColumnStart:1},i=a.columns?[...a.columns]:[];for(let e=1;e<i.length;e++)i[e]+=i[e-1];let o,l;a.enum?(o=a.enum.codes??[],l=a.enum.names??[]):(o=e.items.enum??[],l=e.items.widget?.enumNames??[]);const c=[];for(const[e,a]of o.entries()){const o=l[e]??a,p=t.indexOf(a),d=-1!==p,h=d?oe.pickChecked:void 0,u=i.includes(e)?r:void 0;let m;m=d?this.handleOnRemove(n,p):()=>this.handleOnAdd(n,t.length)(a),c.push(s().createElement(s().Fragment,{key:c.length},s().createElement("span",{className:h,style:u},s().createElement(J,{schema:{label:o},value:d,onChange:m}))))}let p=!1;for(const[e,a]of t.entries()){if(o.includes(a))continue;let t;p||(t=r,p=!0),c.push(s().createElement(s().Fragment,{key:c.length},s().createElement("span",{className:oe.pickDeleted,style:t},s().createElement(J,{schema:{label:a},value:!0,onChange:this.handleOnRemove(n,e)}))))}const d=ie(oe.pickLayout,a.className);return s().createElement("div",{className:d,style:a.style},c)}renderTypeArrayGrid(e,t,n){t=G(e,t);const a=e.widget??{},r=[];for(const[a,i]of t.entries()){const t=e.items,o=[...n,a],l=t.widget??{};r.push(s().createElement(s().Fragment,{key:a},s().createElement("span",{className:oe.gridText},a+1),s().createElement("span",{className:oe.gridText},l.prefix),s().createElement("span",{className:oe.gridEdit},this.renderSchema(t,i,o)),s().createElement("span",{className:oe.gridText},l.suffix),s().createElement("span",null,s().createElement(Z,{icon:"remove",onClick:this.handleOnRemove(n,a)}))))}r.push(s().createElement(s().Fragment,{key:"+"},t.length>0&&s().createElement(s().Fragment,null,s().createElement("span",null),s().createElement("span",null)),s().createElement("span",null,s().createElement(Z,{icon:"add",onClick:this.handleOnAdd(n,t.length)}))));const i=ie(oe.gridLayout,a.className);return s().createElement("div",{className:i,style:a.style},r)}renderTypeArray(e,t,n){const a=e.widget??{};return"list"===a.type?this.renderTypeArrayList(e,t,n):"pick"===a.type?this.renderTypeArrayPick(e,t,n):this.renderTypeArrayGrid(e,t,n)}renderSchema(e,t,n){if(e.enum)return this.renderEnumerate(e,t,n);if("string"===e.type)return this.renderTypeString(e,t,n);if("number"===e.type)return this.renderTypeNumber(e,t,n);if("boolean"===e.type)return this.renderTypeBoolean(e,t,n);if("null"===e.type)return this.renderTypeNull(e,t);if("object"===e.type)return this.renderTypeObject(e,t,n);if("array"===e.type)return this.renderTypeArray(e,t,n);throw"Invalid schema type"}render(){let e=this.props.className;e=[oe.root,e].join(" ").trim();const t=this.props.schema,n=this.props.value;return s().createElement("div",{className:e},this.renderSchema(t,n,[]))}}class ce extends s().PureComponent{constructor(e){super(e);const t=F(e.defaultSchema),n=G(t,e.defaultValue);this.state={schema:t,value:n}}executeOnChange=(e,t,n)=>{this.props.onChange&&(void 0!==n&&(t=[...t,n]),this.props.onChange(e,t))};executeOnActive=(e,t,n)=>{this.props.onActive&&(void 0!==n&&(t=[...t,n]),this.props.onActive(e,t))};querySchemas=(e,t)=>{let n=e,a=null;for(const e of t)a=n,n="object"===n.type?n.properties[e]:n.items;return[n,a]};queryValues=(e,t)=>{let n=e;for(let e=0;e<t.length-1;e++){const a=t[e],s=t[e+1];void 0===n[a]&&(n[a]="string"==typeof s?{}:[]),n=n[a]}n=e;let a=null;for(const n of t)a=e,e=e[n];return[e,a]};handleOnChange=(e,t)=>{if(0===e.length)return this.executeOnChange(t,e),void this.setState({value:t});const n=e.pop(),a=D(this.state.value);this.queryValues(a,e)[0][n]=t,this.executeOnChange(a,e,n),this.setState({value:a})};handleOnRemove=(e,t)=>{const n=D(this.state.value),a=this.queryValues(n,e)[0];"string"==typeof t?delete a[t]:a.splice(t,1),this.executeOnChange(n,e,t),this.setState({value:n})};handleOnActive=(e,t)=>{const n=D(this.state.schema),[a,s]=this.querySchemas(n,[...e,t]);if(s.widget={...s.widget,active:t},!s.widget.single)return this.executeOnActive(this.state.value,e,t),void this.setState({schema:n});const r=D(this.state.value),i=this.queryValues(r,[...e,t])[1];for(const e of Object.keys(i))e!==t&&delete i[e];void 0===i[t]&&(i[t]=G(a)),this.executeOnChange(r,e,t),this.setState({schema:n,value:r})};handleOnPrepare=(e,t)=>{const n=D(this.state.schema),a=this.querySchemas(n,e)[0];a.widget={...a.widget,prepare:t},this.setState({schema:n})};handleOnAdd=(e,t,n)=>{const a=D(this.state.schema),[s,r]=this.querySchemas(a,[...e,t]);r.widget&&delete r.widget.prepare,r.widget={...r.widget,active:t};const i=D(this.state.value),o=this.queryValues(i,[...e,t])[1];n=void 0===n?G(s):n,"string"==typeof t?o[t]=n:o.push(n),this.executeOnChange(i,e,t),this.setState({schema:a,value:i})};handleOnMoveUp=(e,t)=>{const n=D(this.state.schema),a=this.querySchemas(n,e)[0];a.widget={...a.widget,active:t-1};const s=D(this.state.value),r=this.queryValues(s,e)[0];r.splice(t-1,2,r[t],r[t-1]),this.executeOnChange(s,e,t-1),this.setState({schema:n,value:s})};handleOnMoveDown=(e,t)=>{const n=D(this.state.schema),a=this.querySchemas(n,e)[0];a.widget={...a.widget,active:t+1};const s=D(this.state.value),r=this.queryValues(s,e)[0];r.splice(t,2,r[t+1],r[t]),this.executeOnChange(s,e,t+1),this.setState({schema:n,value:s})};render(){const e=this.props.className,t=this.state.schema,n=this.state.value;return s().createElement(le,{className:e,schema:t,onChange:this.handleOnChange,onActive:this.handleOnActive,onPrepare:this.handleOnPrepare,onRemove:this.handleOnRemove,onAdd:this.handleOnAdd,onMoveUp:this.handleOnMoveUp,onMoveDown:this.handleOnMoveDown,value:n})}}const pe=u({input:{width:"300px"},grid:{gridTemplateColumns:["max-content","32px","300px","32px","max-content"].join(" ")},gridAlt:{gridTemplateColumns:["160px","32px","300px","32px","max-content"].join(" ")},list:{gridColumnGap:"16px",gridTemplateColumns:"200px 1fr",minHeight:"400px"},flat:{gridRowGap:"16px"},menu:{"& > :first-child":{width:"300px"}},pick:{gridTemplateColumns:"repeat(1, max-content)"},pick2:{gridTemplateColumns:"repeat(2, max-content)"},pick3:{gridTemplateColumns:"repeat(3, max-content)"},pick4:{gridTemplateColumns:"repeat(4, max-content)"},pick5:{gridTemplateColumns:"repeat(5, max-content)"},code:{"& input":{fontFamily:"var(--font-mono)"},"& textarea":{width:"100%",boxSizing:"border-box"}}}).attach().classes,de={grid:{type:"grid",className:pe.grid},gridAlt:{type:"grid",className:pe.gridAlt},pick:{type:"pick",className:pe.pick},pick2:{type:"pick",className:pe.pick2},pick3:{type:"pick",className:pe.pick3},pick4:{type:"pick",className:pe.pick4},pick5:{type:"pick",className:pe.pick5},flat:{type:"flat",className:pe.flat},codeline:{className:pe.code,spellcheck:!1},codetext:{type:"text",className:pe.code,spellcheck:!1,rows:5}},he=(pe.list,e=>{const t=e.option,n={bottomMargin:{title:t.bottomMargin,type:"number",default:100,widget:{suffix:"px"}},baseStyle:{title:t.baseStyle,type:"string",default:"stroke",enum:["stroke","background","classic","none"],widget:{enumNames:[t.stroke,t.background,t.classic,t.none]}},mouseAction:{title:t.mouseAction,type:"string",default:"none",enum:["none","text"],widget:{enumNames:[t.none,t.selectText]}}};return{title:t.subtitleRendering,type:"object",properties:n,required:Object.keys(n),widget:de.gridAlt}});s().PureComponent;class ue extends s().PureComponent{render(){return s().createElement(ce,{defaultSchema:he(this.props.i18ns),defaultValue:this.props.defaultValue,onChange:this.props.onChange})}}class me extends s().PureComponent{constructor(e){super(e),this.state={config:null}}componentDidMount(){this.load()}async load(){const e=await this.props.agent.load();this.setState({config:e})}onChange=async e=>{await this.props.agent.save(e)};render(){return null===this.state.config?null:s().createElement(ue,{i18ns:this.props.i18ns,defaultValue:this.state.config,onChange:this.onChange})}}const{classes:ge}=u({root:{fontSize:"14px",display:"flex",flexDirection:"column",gap:"16px"},section:{display:"flex",flexDirection:"column",gap:"8px"},header:{borderBottom:"1px solid #ccc",borderTop:"1px solid transparent",lineHeight:"16px",padding:"6px 0",fontWeight:"bold"},content:{lineHeight:"16px"},links:{"& ul":{margin:"8px",paddingInlineStart:"16px"},"& li":{padding:"4px 0"}}}).attach();class fe extends s().PureComponent{renderLink(e,t){return s().createElement("a",{href:e,rel:"noreferrer",target:"_blank"},t)}renderSectionLinks(){const e=this.props.i18ns.option;return s().createElement("div",{className:ge.section},s().createElement("div",{className:ge.header,style:{display:"none"}}),s().createElement("div",{className:ge.content},s().createElement("div",{className:ge.links},s().createElement("ul",null,s().createElement("li",null,this.renderLink("https://www.dualsub.xyz/",e.homepage)),s().createElement("li",null,this.renderLink("https://www.dualsub.xyz/feedback.html",e.feedback)),s().createElement("li",null,this.renderLink("https://www.dualsub.xyz/changelog.html",e.changelog))))))}render(){return s().createElement("div",{className:ge.root},this.renderSectionLinks())}}const ye=e=>({items:[{label:e.standardMode,value:"standard"},{label:e.simpleMode,value:"simple"},{label:e.quickSettings,value:"quick"},{label:e.about,value:"about"}]}),{classes:be}=u({root:{padding:"8px",position:"relative",display:"flex",flexDirection:"column",gap:"8px"},content:{padding:"0 8px"}}).attach();class xe extends s().PureComponent{constructor(e){super(e),this.state={tab:e.defaultTab??"standard"}}onChangeTab=e=>{this.setState({tab:e}),this.props.onTab&&this.props.onTab(e)};renderHeader(){return s().createElement(w,{i18ns:this.props.i18ns,agent:this.props.agents.header})}renderTabbar(){const e=this.props.i18ns.popup,t=this.state.tab;return s().createElement(E,{schema:ye(e),value:t,onChange:this.onChangeTab})}renderPanel(){const e=this.state.tab;return"standard"===e?s().createElement(R,{i18ns:this.props.i18ns,agent:this.props.agents.standard}):"simple"===e?s().createElement(q,{i18ns:this.props.i18ns,agent:this.props.agents.simple}):"quick"===e?s().createElement(me,{i18ns:this.props.i18ns,agent:this.props.agents.quick}):"about"===e?s().createElement(fe,{i18ns:this.props.i18ns}):null}renderContent(){const e=this.state.tab,t={};return"standard"!==e&&"simple"!==e||(t.padding="0"),s().createElement("div",{className:be.content,style:t},this.renderPanel())}render(){return s().createElement("div",{className:be.root},this.renderHeader(),this.renderTabbar(),this.renderContent())}}const ve=JSON.parse('{"en":{"about":"About","background":"Background","baseStyle":"Base Style","bottomMargin":"Bottom Margin","changelog":"Changelog","classic":"Classic","close":"Close","feedback":"Feedback","homepage":"Homepage","machineTranslation":"Machine Translation","mouseAction":"Mouse Action","nodataLine0Tip":"Possible reasons:","nodataLine1ModeSimple":"1. This mode only supports YouTube video pages.","nodataLine1ModeStandard":"1. The current page is not a video page.","nodataLine2Loading":"2. The current page has not finished loading.","nodataLine3Permission":"3. No permission to access the current page.","nodataTitle":"Could not get the subtitle menu data of the current page.","none":"None","quickSettings":"Quick Settings","selectText":"Select Text","settings":"Settings","simpleMode":"Simple Mode","standardMode":"Standard Mode","stroke":"Stroke","subtitleLanguage":"Subtitle Language","themeStyle":"Theme Style","tutorial":"Tutorial"}}'),Ce=JSON.parse('{"zh-hans":{"about":"关于","background":"背景","baseStyle":"基础样式","bottomMargin":"底部边距","changelog":"更新日志","classic":"经典","close":"关闭","feedback":"问题反馈","homepage":"官方网站","machineTranslation":"机器翻译","mouseAction":"鼠标动作","nodataLine0Tip":"可能的原因：","nodataLine1ModeSimple":"1. 此模式仅支持 YouTube 视频页面。","nodataLine1ModeStandard":"1. 当前页面不是视频页面。","nodataLine2Loading":"2. 当前页面尚未完全加载完毕。","nodataLine3Permission":"3. 没有访问当前页面的权限。","nodataTitle":"未能获得当前页面的字幕菜单数据。","none":"无","quickSettings":"快速设置","selectText":"选择文本","settings":"设置","simpleMode":"简单模式","standardMode":"标准模式","stroke":"描边","subtitleLanguage":"字幕语言","themeStyle":"主题样式","tutorial":"教程"}}'),Ee=JSON.parse('{"zh-hant":{"about":"關於","background":"背景","baseStyle":"基礎樣式","bottomMargin":"底部邊距","changelog":"更新日誌","classic":"經典","close":"關閉","feedback":"問題反饋","homepage":"官方網站","machineTranslation":"機器翻譯","mouseAction":"鼠標動作","nodataLine0Tip":"可能的原因：","nodataLine1ModeSimple":"1. 此模式僅支持 YouTube 視頻頁面。","nodataLine1ModeStandard":"1. 當前頁面不是視頻頁面。","nodataLine2Loading":"2. 當前頁面尚未完全加載完畢。","nodataLine3Permission":"3. 沒有訪問當前頁面的權限。","nodataTitle":"未能獲得當前頁面的字幕菜單數據。","none":"無","quickSettings":"快速設置","selectText":"選擇文本","settings":"設置","simpleMode":"簡單模式","standardMode":"標準模式","stroke":"描邊","subtitleLanguage":"字幕語言","themeStyle":"主題樣式","tutorial":"教程"}}'),ke=JSON.parse('{"en":{"LANG_CODE":"en","LANG_NAME":"English","LANG_LOCAL":"English"},"zh-hans":{"LANG_CODE":"zh-hans","LANG_NAME":"Simplified Chinese","LANG_LOCAL":"简体中文"},"zh-hant":{"LANG_CODE":"zh-hant","LANG_NAME":"Traditional Chinese","LANG_LOCAL":"繁體中文"}}'),we=new class{constructor(e){this.dataset=(e=>{const t={};for(const n of e)for(const[e,a]of Object.entries(n))t[e]||(t[e]={}),Object.assign(t[e],a);return t})(e)}get(e){return e=function(e){return""===(e=e.toLowerCase().replace("_","-").trim())?"en":"zh-tw"===e||"zh-hk"===e||"zh-mo"===e||"zh-hant"===e?"zh-hant":e.match(/^zh\b/)?"zh-hans":e.split("-")[0]}(e),this.dataset[e]||(e="en"),this.dataset[e]}}([ve,Ce,Ee,ke]);var Ne;const Se=(e=>({popup:we.get(e)}))("zh-tw"===(Ne=(Ne=navigator.language).toLowerCase().replace("_","-").trim())||"zh-hk"===Ne||"zh-mo"===Ne||"zh-hant"===Ne?"zh-hant":Ne.match(/^zh\b/)?"zh-hans":"en"),Oe={get:e=>new Promise(((t,n)=>{chrome.storage.local.get(e,(e=>{const a=chrome.runtime.lastError;a?n(a):t(e)}))})),set:e=>new Promise(((t,n)=>{chrome.storage.local.set(e,(()=>{const e=chrome.runtime.lastError;e?n(e):t()}))}))},Te={query:e=>new Promise((t=>{chrome.tabs.query(e,(e=>{t(e)}))})),sendMessage:(e,t)=>new Promise(((n,a)=>{chrome.tabs.sendMessage(e,t,(e=>{const t=chrome.runtime.lastError;t?a(t):n(e)}))}))},je={type:"array",items:""},Le={fontSize:100,fontColor:"#ffffff",fontOpacity:100,fontEdgeEffect:["none","shadow","raised","depressed","outline","stroke"],fontEdgeColor:"#ffffff",fontEdgeSize:0,fontBold:!0,fontItalic:!0,backgroundColor:"#ffffff",backgroundOpacity:100,backgroundEdgeEffect:["none","shadow"],backgroundEdgeColor:"#ffffff",borderSize:0,borderColor:"#ffffff"},Ae={display1:["true","false"],display2:["true","false","preserve"],flexAlign:["center","left","right","evenly"]},Re={flexAlign:Ae.flexAlign,...Le},ze={...Le},qe={display:Ae.display2,...Le},Me={display:Ae.display2,flexAlign:Ae.flexAlign,...Le},Pe={display:Ae.display2,backgroundColor:Le.backgroundColor,backgroundEdgeEffect:Le.backgroundEdgeEffect,backgroundEdgeColor:Le.backgroundEdgeColor,borderSize:Le.borderSize,borderColor:Le.borderColor},$e={display:Ae.display1,match:"",...Le},He={display:Ae.display1,match:je,...Le},Ge=e=>({type:"object",properties:e,required:!1}),Fe=(e=>{const t=F(e);return B(t),t})({type:"object",properties:{general:{type:"object",properties:{rendering:{type:"object",properties:{bottomMargin:100,baseStyle:["stroke","background","classic","none"],mouseAction:["none","text"]},required:!0},dropdown:{type:"object",properties:{subtitleCount:[2,3,4,5,6,7,8],showOnlyLanguages:""},required:!0}},required:!0},language:{type:"object",properties:{translation:{type:"object",properties:{languageList:["popular","available"],translationEngine:["google","microsoft"],translationMode:["auto","enhance","normal"]},required:!0},chinese:{type:"object",properties:{pinyinScheme:["putonghua","guangzhouhua","jyutping"]},required:!0},japanese:{type:"object",properties:{furiganaCharacter:["kanji","kana"]},required:!0}},required:!0},style:{type:"object",properties:{genres:{type:"array",items:{type:"object",properties:{name:"",component:{type:"object",properties:{none:null,dialogue:Ge(Re),contents:Ge(ze),readings:Ge(qe),grammars:Ge(Me),dividers:Ge(Pe),pinyin:Ge($e),hiragana:Ge($e),katakana:Ge($e),romaji:Ge($e),loanword:Ge($e),pos:Ge(He),form:Ge(He),tag:Ge(He),base:Ge($e),sense:Ge(He),jlpt:Ge(He)},required:!1}},required:!0}},rulers:{type:"array",items:{type:"object",properties:{name:"",genres:je,tokens:{type:"object",properties:{text:"",hiragana:"",katakana:"",romaji:"",loanword:"",pos:je,form:je,tag:je,base:"",sense:je,jlpt:je},required:!1}},required:!0}},themes:{type:"array",items:{type:"object",properties:{name:"",genres:je,rulers:je,toolkit:"none"},required:!0}}},required:!0},plugin:{type:"object",properties:{items:{type:"array",items:{type:"object",properties:{name:"",type:["none","style","script","standard","simple"],code:"",urls:{type:"array",items:""}},required:!0}}},required:!0},file:{type:"object",properties:{items:{type:"array",items:{type:"object",properties:{name:"",lang:"",code:"",urls:{type:"array",items:""}},required:!0}}},required:!0},network:{type:"object",properties:{server:{type:"object",properties:{apiUrl:["https://api.dualsub.xyz/"],apiKey:""},required:!0}},required:!0}},required:!0}),De=e=>G(Fe,e),Be=async()=>{const{setting:e}=await Oe.get(["setting"]);return De(e)},Ie=async e=>{const t=De(e);await Oe.set({setting:t})},_e=async(e,t,n)=>{const{ok:a,data:s}=await Te.sendMessage(e,{name:t,args:n});if(!a)throw s;return s},Ue=async e=>await _e(e,"loadSimple"),Ve=async(e,t)=>await _e(e,"saveSimple",t),We=async e=>await _e(e,"loadStandard"),Je=async(e,t)=>await _e(e,"saveStandard",t),Ke=async()=>(await Te.query({currentWindow:!0,active:!0}))[0].id,Ye={header:{settings:async()=>{chrome.runtime.openOptionsPage()}},standard:{initial:async()=>{const e=await Ke();let t;try{t=await We(e)}catch(e){return{}}return{data:t}},change:async e=>{const t=await Ke();await Je(t,{value:e})}},simple:{initial:async()=>{const e=await Ke();let t;try{t=await Ue(e)}catch(e){return{}}return{data:t}},change:async e=>{const t=await Ke();await Ve(t,{value:e})}},quick:{load:async()=>(await Be()).general.rendering,save:async e=>{const t=await Be();t.general.rendering=e,await Ie(t)}}};Se.option=Se.popup,Se.option.subtitleRendering="";class Qe extends s().PureComponent{render(){return s().createElement("div",{style:{minWidth:"700px",minHeight:"138px",background:"#fff"}},s().createElement(xe,{i18ns:Se,agents:Ye}))}}const Ze=document.querySelector("#app");i().render(s().createElement(Qe,null),Ze)})(0,0,e)})();